module.exports=function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=32)}([function(e,t){e.exports=require("vscode")},function(e,t){e.exports=require("path")},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(18),o=s(12),a=s(1),c=s(0),u=s(5),l=s(4),h=s(9),d=s(3),p=s(24),g=s(34),f=s(19);function m(e){return!!(e&&w(e)&&b(d.fsPath(e.uri)))}function v(e){return!!(e&&w(e)&&y(d.fsPath(e.uri)))}function b(e){return g.referencesFlutterSdk(e)}function y(e){return g.referencesFlutterWeb(e)}function w(e){return!(!e||"file"!==e.uri.scheme)}function S(e){return new c.Position(e.startLine-1,e.startColumn-1)}function E(e){if(e.isUntitled||!d.fsPath(e.uri)||"file"!==e.uri.scheme)return!1;return["dart","html"].indexOf(e.languageId)>=0||[".analysis_options","analysis_options.yaml"].indexOf(a.basename(d.fsPath(e.uri)))>=0}function T(e){return!!c.workspace.getWorkspaceFolder(c.Uri.file(e))}function C(e){return!!e&&k(e)&&(_(e,"test")||e.toLowerCase().endsWith("_test.dart"))}function P(e){return!!e&&_(e,"test")&&i.existsSync(e)&&i.statSync(e).isDirectory()}function k(e){return!!e&&".dart"===a.extname(e.toLowerCase())&&i.existsSync(e)&&i.statSync(e).isFile()}function _(e,t){if(!e)return!1;const s=c.workspace.getWorkspaceFolder(c.Uri.file(e));if(!s)return!1;const r=a.relative(d.fsPath(s.uri),e).toLowerCase();return r===t||r.startsWith(`${t}${a.sep}`)}function R(e){return JSON.parse(i.readFileSync(e).toString())}function x(){return void 0!==c.extensions.getExtension(u.flutterExtensionIdentifier)}t.extensionPath=c.extensions.getExtension(u.dartCodeExtensionIdentifier).extensionPath,t.extensionVersion=R(a.join(t.extensionPath,"package.json")).version,t.vsCodeVersionConstraint=R(a.join(t.extensionPath,"package.json")).engines.vscode,t.isDevExtension=t.extensionVersion.endsWith("-dev"),t.hasFlutterExtension=x(),t.showLogAction="Show Log",t.resolvedPromise=Promise.resolve(!0),t.isFlutterWorkspaceFolder=m,t.isFlutterWebWorkspaceFolder=v,t.isInsideFlutterProject=function(e){if(!e)return!1;const t=p.locateBestProjectRoot(d.fsPath(e));return t?b(t):m(c.workspace.getWorkspaceFolder(e))},t.isInsideFlutterWebProject=function(e){if(!e)return!1;const t=p.locateBestProjectRoot(d.fsPath(e));return t?y(t):v(c.workspace.getWorkspaceFolder(e))},t.isFlutterProjectFolder=b,t.isFlutterWebProjectFolder=y,t.getDartWorkspaceFolders=function(){return c.workspace.workspaceFolders?c.workspace.workspaceFolders.filter(w):[]},t.isDartWorkspaceFolder=w,t.resolvePaths=function(e){if("string"==typeof e)return e.startsWith("~/")?a.join(o.homedir(),e.substr(2)):!a.isAbsolute(e)&&c.workspace.workspaceFolders&&c.workspace.workspaceFolders.length?a.join(d.fsPath(c.workspace.workspaceFolders[0].uri),e):e},t.homeRelativePath=function(e){if(!e)return;const t=o.homedir();return l.isWithinPath(e,t)?a.join("~",a.relative(t,e)):e},t.createFolderForFile=function(e){if(!e||!a.isAbsolute(e))return;const t=a.dirname(e);return i.existsSync(t)||h.mkDirRecursive(t),e},t.toRange=function(e,t,s){return new c.Range(e.positionAt(t),e.positionAt(t+s))},t.toPosition=S,t.toRangeOnLine=function(e){const t=S(e);return new c.Range(t,t.translate(0,e.length))},t.getSdkVersion=function(e,t){if(!t)return;const s=a.join(t,"version");if(i.existsSync(s))try{return i.readFileSync(s,"utf8").trim().split("\n").filter(e=>e).filter(e=>"#"!==e.trim().substr(0,1)).join("\n").trim()}catch(t){return void e.error(t)}},t.isAnalyzable=E,t.isAnalyzableAndInWorkspace=function(e){return E(e)&&T(d.fsPath(e.uri))},t.isWithinWorkspace=T,t.isTestFileOrFolder=function(e){return!!e&&(C(e)||P(e))},t.isTestFile=C,t.isPubRunnableTestFile=function(e){return!!e&&k(e)&&e.toLowerCase().endsWith("_test.dart")},t.isTestFolder=P,t.checkProjectSupportsPubRunTest=function(e){return h.hasPackagesFile(e)&&h.hasPubspec(e)},t.isDartFile=k,t.isInsideFolderNamed=_,t.readJson=R,t.checkHasFlutterExtension=x,t.getLatestSdkVersion=function(){return new Promise((e,t)=>{n.request({hostname:"storage.googleapis.com",method:"GET",path:"/dart-archive/channels/stable/release/latest/VERSION",port:443},s=>{!s||!s.statusCode||s.statusCode<200||s.statusCode>300?t({message:`Failed to get Dart SDK Version ${s&&s.statusCode}: ${s&&s.statusMessage}`}):s.on("data",t=>{e(JSON.parse(t.toString()).version)})}).end()})},t.escapeShell=function(e){const t=[];return e.forEach(e=>{/[^A-Za-z0-9_\/:=-]/.test(e)&&(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t.push(e)}),t.join(" ")},t.reloadExtension=function(e,s,i=!1){return r(this,void 0,void 0,function*(){const r=s||"Restart",n=i?[r,t.showLogAction]:[r],o=e&&(yield c.window.showInformationMessage(e,...n));o===t.showLogAction?F():e&&o!==r||c.commands.executeCommand("_dart.reloadExtension")})},t.unique=function(e){return Array.from(new Set(e))};process.hrtime();function F(){c.workspace.openTextDocument(f.getExtensionLogPath()).then(c.window.showTextDocument)}t.logTime=e=>{},t.openExtensionLogFile=F,t.notUndefined=function(e){return void 0!==e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(4);t.fsPath=function(e){return i.forceWindowsDriveLetterToUppercase(e instanceof r.Uri?e.fsPath:e)},t.openInBrowser=function(e){r.commands.executeCommand("vscode.open",r.Uri.parse(e))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(1),n=s(75),o=s(5);t.forceWindowsDriveLetterToUppercase=function(e){return e&&o.isWin&&i.isAbsolute(e)&&e.charAt(0)===e.charAt(0).toLowerCase()&&(e=e.substr(0,1).toUpperCase()+e.substr(1)),e},t.isWithinPath=function(e,t){const s=i.relative(t,e);return!!s&&!s.startsWith("..")&&!i.isAbsolute(s)},t.uniq=function(e){return e.filter((t,s)=>e.indexOf(t)===s)},t.flatMap=function(e,t){return e.reduce((e,s)=>e.concat(t(s)),[])},t.throttle=function(e,t){let s,r;return(...i)=>{const n=()=>{r=Date.now(),e(...i)},o=Date.now();r&&o<r+t?(clearTimeout(s),s=setTimeout(n,t-(o-r))):n()}},t.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};t.PromiseCompleter=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}},t.findFile=function(e,t){let s,n=t;for(;n&&n.length>1&&n!==s;){const t=i.join(n,e);if(r.existsSync(t))return t;s=n,n=i.dirname(n)}},t.uriToFilePath=function(e,t=o.isWin){let s=e;return e.startsWith("file://")?s=decodeURI(e.substring(7)):e.startsWith("file:")&&(s=decodeURI(e.substring(5))),t?"\\"===(s=s.replace(/\//g,"\\"))[0]&&(s=s.substring(1)):"/"!==s[0]&&(s=`/${s}`),s},t.isDartSdkFromFlutter=function(e){const t=i.join(i.dirname(i.dirname(i.dirname(e))),"bin");return r.existsSync(i.join(t,o.flutterExecutableName))},t.versionIsAtLeast=function(e,t){return n.gte(e,t)},t.isStableSdk=function(e){return!(!e||n.prerelease(e))},t.errorString=function(e){return e?e instanceof Error?e.message+(e.stack?`\n${e.stack}`:""):"string"==typeof e?e:e.message||"<empty error message>":"<empty error>"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6);t.dartCodeExtensionIdentifier="Dart-Code.dart-code",t.flutterExtensionIdentifier="Dart-Code.flutter",t.isWin=/^win/.test(process.platform),t.isMac="darwin"===process.platform,t.isLinux=!t.isWin&&!t.isMac,t.isChromeOS=t.isLinux&&r.existsSync("/dev/.cros_milestone"),t.dartPlatformName=t.isWin?"win":t.isMac?"mac":"linux",t.platformDisplayName=t.isWin?"win":t.isMac?"mac":t.isChromeOS?"chromeos":"linux",t.platformEol=t.isWin?"\r\n":"\n",t.dartExecutableName=t.isWin?"dart.exe":"dart",t.pubExecutableName=t.isWin?"pub.bat":"pub",t.flutterExecutableName=t.isWin?"flutter.bat":"flutter",t.androidStudioExecutableName=t.isWin?"studio64.exe":"studio.sh",t.dartVMPath="bin/"+t.dartExecutableName,t.pubPath="bin/"+t.pubExecutableName,t.pubSnapshotPath="bin/snapshots/pub.dart.snapshot",t.analyzerSnapshotPath="bin/snapshots/analysis_server.dart.snapshot",t.flutterPath="bin/"+t.flutterExecutableName,t.androidStudioPath="bin/"+t.androidStudioExecutableName,t.DART_DOWNLOAD_URL="https://dart.dev/get-dart",t.FLUTTER_DOWNLOAD_URL="https://flutter.io/setup/",t.DART_TEST_SUITE_NODE_CONTEXT="dart-code:testSuiteNode",t.DART_TEST_GROUP_NODE_CONTEXT="dart-code:testGroupNode",t.DART_TEST_TEST_NODE_CONTEXT="dart-code:testTestNode",t.DART_DEP_PROJECT_NODE_CONTEXT="dart-code:depProjectNode",t.DART_DEP_PACKAGE_NODE_CONTEXT="dart-code:depPackageNode",t.DART_DEP_FOLDER_NODE_CONTEXT="dart-code:depFolderNode",t.DART_DEP_FILE_NODE_CONTEXT="dart-code:depFileNode",t.stopLoggingAction="Stop Logging",t.restartReasonManual="manual",t.restartReasonSave="save",t.pubGlobalDocsUrl="https://www.dartlang.org/tools/pub/cmd/pub-global",t.stagehandInstallationInstructionsUrl="https://github.com/dart-lang/stagehand#installation",t.wantToTryDevToolsPrompt="Dart DevTools (preview) includes additional tools for debugging and profiling Flutter apps, including a Widget Inspector. Try it?",t.openDevToolsAction="Open DevTools",t.noThanksAction="No Thanks",t.doNotAskAgainAction="Don't Ask Again",t.flutterSurvey2019Q2PromptWithAnalytics="Help improve Flutter! Take our Q2 survey. By clicking on this link you agree to share feature usage along with the survey responses.",t.flutterSurvey2019Q2PromptWithoutAnalytics="Help improve Flutter! Take our Q2 survey.",t.takeSurveyAction="Take Flutter Q2 Survey",t.fiveMinutesInMs=3e5,t.tenMinutesInMs=6e5,t.twentyMinutesInMs=12e5,t.twoHoursInMs=72e5,t.twentyHoursInMs=72e6,t.fortyHoursInMs=144e6,t.noRepeatPromptThreshold=t.twentyHoursInMs,t.longRepeatPromptThreshold=t.fortyHoursInMs,t.pleaseReportBug="Please raise a bug against the Dart extension for VS Code.",t.CHROME_OS_DEVTOOLS_PORT=8080,t.CHROME_OS_VM_SERVICE_PORT=8085,t.DART_STAGEHAND_PROJECT_TRIGGER_FILE="dart.sh.create",t.FLUTTER_STAGEHAND_PROJECT_TRIGGER_FILE="flutter.sh.create",t.FLUTTER_CREATE_PROJECT_TRIGGER_FILE="flutter.create",t.REFACTOR_FAILED_DOC_MODIFIED="This refactor cannot be applied because the document has changed.",t.REFACTOR_ANYWAY="Refactor Anyway",t.TRACK_WIDGET_CREATION_ENABLED="dart-code:trackWidgetCreationEnabled",t.HAS_LAST_DEBUG_CONFIG="dart-code:hasLastDebugConfig",t.showErrorsAction="Show Errors",t.debugAnywayAction="Debug Anyway",t.userPromptContextPrefix="hasPrompted.",t.installFlutterExtensionPromptKey="install_flutter_extension_3",t.observatoryListeningBannerPattern=new RegExp("Observatory (?:listening on|.* is available at:) (http:.+)"),t.observatoryHttpLinkPattern=new RegExp("(http://[\\d\\.:]+/)")},function(e,t){e.exports=require("fs")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Waiting=0]="Waiting",e[e.Passed=1]="Passed",e[e.Skipped=2]="Skipped",e[e.Unknown=3]="Unknown",e[e.Failed=4]="Failed",e[e.Errored=5]="Errored",e[e.Running=6]="Running"}(t.TestStatus||(t.TestStatus={})),function(e){e.PlatformOverride="ext.flutter.platformOverride",e.DebugBanner="ext.flutter.debugAllowBanner",e.CheckElevations="ext.flutter.debugCheckElevationsEnabled",e.DebugPaint="ext.flutter.debugPaint",e.PaintBaselines="ext.flutter.debugPaintBaselinesEnabled",e.InspectorSelectMode="ext.flutter.inspector.show",e.InspectorSetPubRootDirectories="ext.flutter.inspector.setPubRootDirectories",e.RepaintRainbow="ext.flutter.repaintRainbow",e.PerformanceOverlay="ext.flutter.showPerformanceOverlay",e.SlowAnimations="ext.flutter.timeDilation"}(t.FlutterServiceExtension||(t.FlutterServiceExtension={})),function(e){e.HotReload="reloadSources",e.HotRestart="hotRestart",e.LaunchDevTools="launchDevTools"}(t.FlutterService||(t.FlutterService={})),function(e){e[e.NotInstalled=0]="NotInstalled",e[e.UpdateRequired=1]="UpdateRequired",e[e.UpdateAvailable=2]="UpdateAvailable",e[e.Valid=3]="Valid"}(t.VersionStatus||(t.VersionStatus={})),function(e){e[e.General=0]="General",e[e.CI=1]="CI",e[e.CommandProcesses=2]="CommandProcesses",e[e.Analyzer=3]="Analyzer",e[e.PubTest=4]="PubTest",e[e.FlutterDaemon=5]="FlutterDaemon",e[e.FlutterRun=6]="FlutterRun",e[e.FlutterTest=7]="FlutterTest",e[e.Observatory=8]="Observatory",e[e.WebDaemon=9]="WebDaemon"}(t.LogCategory||(t.LogCategory={})),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error"}(t.LogSeverity||(t.LogSeverity={}))},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(2),o=s(55),a=s(10);class c{constructor(e){this.uri=e,this.config=i.workspace.getConfiguration("dart",this.uri)}getConfig(e,t){return o.nullToUndefined(this.config.get(e,t))}get analysisExcludedFolders(){return this.getConfig("analysisExcludedFolders",[])}get debugExternalLibraries(){return this.getConfig("debugExternalLibraries",!1)}get debugSdkLibraries(){return this.getConfig("debugSdkLibraries",!1)}get doNotFormat(){return this.getConfig("doNotFormat",[])}get enableCompletionCommitCharacters(){return this.getConfig("enableCompletionCommitCharacters",!1)}get evaluateGettersInDebugViews(){return this.getConfig("evaluateGettersInDebugViews",!0)}get flutterRunLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("flutterRunLogFile",null)))}get flutterTestLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("flutterTestLogFile",null)))}get flutterTrackWidgetCreation(){return this.getConfig("flutterTrackWidgetCreation",!0)}get insertArgumentPlaceholders(){return this.getConfig("insertArgumentPlaceholders",!0)}get lineLength(){return this.getConfig("lineLength",80)}get observatoryLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("observatoryLogFile",null)))}get promptToGetPackages(){return this.getConfig("promptToGetPackages",!0)}get pubAdditionalArgs(){return this.getConfig("pubAdditionalArgs",[])}get pubTestLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("pubTestLogFile",null)))}get runPubGetOnPubspecChanges(){return this.getConfig("runPubGetOnPubspecChanges",!0)}get vmAdditionalArgs(){return this.getConfig("vmAdditionalArgs",[])}get webDaemonLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("webDaemonLogFile",null)))}get runPubGetOnPubspecChangesIsConfiguredExplicitly(){const e=this.config.inspect("runPubGetOnPubspecChanges");return e&&(void 0!==e.globalValue||void 0!==e.workspaceValue||void 0!==e.workspaceFolderValue)}}class u{constructor(e){this.version=e}}t.CodeCapabilities=u,t.config=new class{constructor(){i.workspace.onDidChangeConfiguration(e=>this.reloadConfig()),this.config=i.workspace.getConfiguration("dart"),a.setupToolEnv(this.env)}reloadConfig(){this.config=i.workspace.getConfiguration("dart"),a.setupToolEnv(this.env)}getConfig(e,t){return o.nullToUndefined(this.config.get(e,t))}setConfig(e,t,s){return r(this,void 0,void 0,function*(){yield this.config.update(e,t,s)})}get allowAnalytics(){return this.getConfig("allowAnalytics",!0)}get analysisServerFolding(){return this.getConfig("analysisServerFolding",!0)}get analyzeAngularTemplates(){return this.getConfig("analyzeAngularTemplates",!0)}get analyzerAdditionalArgs(){return this.getConfig("analyzerAdditionalArgs",[])}get analyzerDiagnosticsPort(){return this.getConfig("analyzerDiagnosticsPort",null)}get analyzerInstrumentationLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("analyzerInstrumentationLogFile",null)))}get analyzerLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("analyzerLogFile",null)))}get analyzerObservatoryPort(){return this.getConfig("analyzerObservatoryPort",null)}get analyzerPath(){return n.resolvePaths(this.getConfig("analyzerPath",null))}get analyzerSshHost(){return this.getConfig("analyzerSshHost",null)}get autoImportCompletions(){return this.getConfig("autoImportCompletions",!0)}get buildRunnerAdditionalArgs(){return this.getConfig("buildRunnerAdditionalArgs",[])}get checkForSdkUpdates(){return this.getConfig("checkForSdkUpdates",!0)}get closingLabels(){return this.getConfig("closingLabels",!0)}get devToolsLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("devToolsLogFile",null)))}get devToolsPort(){return this.getConfig("devToolsPort",null)}get devToolsTheme(){return this.getConfig("devToolsTheme","dark")}get enableSdkFormatter(){return this.getConfig("enableSdkFormatter",!0)}get env(){return this.getConfig("env",{})}get extensionLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("extensionLogFile",null)))}get flutterAdbConnectOnChromeOs(){return this.getConfig("flutterAdbConnectOnChromeOs",!1)}get flutterCreateAndroidLanguage(){return this.getConfig("flutterCreateAndroidLanguage","java")}get flutterCreateIOSLanguage(){return this.getConfig("flutterCreateIOSLanguage","objc")}get flutterCreateOrganization(){return this.getConfig("flutterCreateOrganization",null)}get flutterDaemonLogFile(){return n.createFolderForFile(n.resolvePaths(this.getConfig("flutterDaemonLogFile",null)))}get flutterHotReloadOnSave(){return this.getConfig("flutterHotReloadOnSave",!0)}get flutterHotRestartOnSave(){return this.getConfig("flutterHotRestartOnSave",!1)}get flutterScreenshotPath(){return n.resolvePaths(this.getConfig("flutterScreenshotPath",null))}get flutterSdkPath(){return n.resolvePaths(this.getConfig("flutterSdkPath",null))}get flutterSdkPaths(){return this.getConfig("flutterSdkPaths",[]).map(n.resolvePaths)}get flutterSelectDeviceWhenConnected(){return this.getConfig("flutterSelectDeviceWhenConnected",!0)}get maxLogLineLength(){return this.getConfig("maxLogLineLength",2e3)}get openTestView(){return this.getConfig("openTestView",["testRunStart"])}get previewBuildRunnerTasks(){return this.getConfig("previewBuildRunnerTasks",!1)}get previewFlutterUiGuides(){return this.getConfig("previewFlutterUiGuides",!1)}get previewFlutterUiGuidesCustomTracking(){return this.getConfig("previewFlutterUiGuidesCustomTracking",!1)}get previewToStringInDebugViews(){return this.getConfig("previewToStringInDebugViews",!1)}get promptToRunIfErrors(){return this.getConfig("promptToRunIfErrors",!0)}get reportAnalyzerErrors(){return this.getConfig("reportAnalyzerErrors",!0)}get sdkPath(){return n.resolvePaths(this.getConfig("sdkPath",null))}get sdkPaths(){return this.getConfig("sdkPaths",[]).map(n.resolvePaths)}get showIgnoreQuickFixes(){return this.getConfig("showIgnoreQuickFixes",!1)}get showTestCodeLens(){return this.getConfig("showTestCodeLens",!0)}get showTodos(){return this.getConfig("showTodos",!0)}get triggerSignatureHelpAutomatically(){return this.getConfig("triggerSignatureHelpAutomatically",!1)}get useKnownChromeOSPorts(){return this.getConfig("useKnownChromeOSPorts",!0)}get warnWhenEditingFilesOutsideWorkspace(){return this.getConfig("warnWhenEditingFilesOutsideWorkspace",!0)}get previewHotReloadCoverageMarkers(){return this.getConfig("previewHotReloadCoverageMarkers",!1)}get useDevToolsDarkTheme(){return"dark"===this.devToolsTheme}get openTestViewOnFailure(){return-1!==this.openTestView.indexOf("testFailure")}get openTestViewOnStart(){return-1!==this.openTestView.indexOf("testRunStart")}setCheckForSdkUpdates(e){return this.setConfig("checkForSdkUpdates",e,i.ConfigurationTarget.Global)}setFlutterSdkPath(e){return this.setConfig("flutterSdkPath",e,i.ConfigurationTarget.Workspace)}setGlobalDartSdkPath(e){return this.setConfig("sdkPath",e,i.ConfigurationTarget.Global)}setGlobalFlutterSdkPath(e){return this.setConfig("flutterSdkPath",e,i.ConfigurationTarget.Global)}setSdkPath(e){return this.setConfig("sdkPath",e,i.ConfigurationTarget.Workspace)}setWarnWhenEditingFilesOutsideWorkspace(e){return this.setConfig("warnWhenEditingFilesOutsideWorkspace",e,i.ConfigurationTarget.Global)}for(e){return new c(e)}},t.vsCodeVersion=new u(i.version)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(48),n=s(1),o=s(5),a=s(4),c=s(17);function u(e,t){return r.existsSync(e)?r.readdirSync(e).filter(e=>"bin"!==e||t&&t.allowBin).filter(e=>"cache"!==e||t&&t.allowCache).map(t=>n.join(e,t)).filter(e=>r.existsSync(e)&&r.statSync(e).isDirectory()):[]}function l(e){return r.existsSync(n.join(e,"pubspec.yaml"))}function h(e){return r.existsSync(n.join(e,o.FLUTTER_CREATE_PROJECT_TRIGGER_FILE))||r.existsSync(n.join(e,o.FLUTTER_STAGEHAND_PROJECT_TRIGGER_FILE))}function d(e){return r.existsSync(n.join(e,"bin/flutter"))&&r.existsSync(n.join(e,"bin/cache/dart-sdk"))}t.getChildFolders=u,t.hasPackagesFile=function(e){return r.existsSync(n.join(e,".packages"))},t.hasPubspec=l,t.hasCreateTriggerFile=h,t.isFlutterRepo=d,t.findProjectFolders=function(e,t={}){const s=a.flatMap(e,u),r=a.flatMap(s,u),i=e.concat(s).concat(r).filter(e=>t&&t.requirePubspec?l(e):l(e)||h(e)||d(e));return t&&t.sort?c.sortBy(i,e=>e.toLowerCase()):i},t.tryDeleteFile=function(e){if(r.existsSync(e))try{r.unlinkSync(e)}catch(e){console.warn("Failed to delete file $path.")}},t.trueCasePathSync=function(e){let t=n.normalize(e);"darwin"===process.platform&&(t=t.normalize("NFD"));const s=n.parse(t).root,r=t.slice(Math.max(s.length-1,0));return i.sync(r,{nocase:!0,cwd:s})[0]},t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},t.mkDirRecursive=function e(t){const s=n.dirname(t);r.existsSync(s)||e(s),r.existsSync(t)||r.mkdirSync(t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(89),i=s(7),n=s(11),o=s(55);function a(e){t.toolEnv=Object.create(process.env),t.globalFlutterArgs=[],t.toolEnv.FLUTTER_HOST="VSCode",t.toolEnv.PUB_ENVIRONMENT=(t.toolEnv.PUB_ENVIRONMENT?`${t.toolEnv.PUB_ENVIRONMENT}:`:"")+"vscode.dart-code",process.env.DART_CODE_IS_TEST_RUN&&(t.toolEnv.PUB_ENVIRONMENT+=".test.bot",t.globalFlutterArgs.push("--suppress-analytics")),e&&(t.toolEnv=Object.assign(Object.create(t.toolEnv),e))}function c(e,s,i,n){const o=n?Object.assign(Object.create(t.toolEnv),n):t.toolEnv;return r.spawn(`"${s}"`,i.map(e=>`"${e}"`),{cwd:e,env:o,shell:!0})}t.toolEnv={},t.globalFlutterArgs=[],t.setupToolEnv=a,a(),t.safeSpawn=c,t.runProcess=function(e,t,s,r,a){return new Promise(l=>{const h=c(t,s,r,a);n.logProcess(e,i.LogCategory.CommandProcesses,h);const d=[],p=[];h.stdout.on("data",e=>d.push(e.toString())),h.stderr.on("data",e=>p.push(e.toString())),h.on("exit",e=>{l(new u(o.nullToUndefined(e),d.join(""),p.join("")))})})};class u{constructor(e,t,s){this.exitCode=e,this.stdout=t,this.stderr=s}}t.RunProcessResult=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(16),i=s(6),n=s(12),o=s(1),a=s(7),c=s(4);class u extends r.EventEmitter{fire(e){this.emit("log",e)}onLog(e){return this.on("log",e),{dispose:()=>{this.removeListener("log",e)}}}}t.EmittingLogger=class{constructor(){this.onLogEmitter=new u,this.onLog=e=>this.onLogEmitter.onLog(e)}log(e,t,s=a.LogCategory.General){this.onLogEmitter.fire({message:e,severity:t,category:s})}info(e,t){this.log(e,a.LogSeverity.Info,t)}warn(e,t){this.log(c.errorString(e),a.LogSeverity.Warn,t)}error(e,t){this.log(c.errorString(e),a.LogSeverity.Error,t)}dispose(){this.onLogEmitter.removeAllListeners()}};t.CategoryLogger=class{constructor(e,t){this.base=e,this.defaultCategory=t}info(e,t=this.defaultCategory){this.base.info(e,t)}warn(e,t=this.defaultCategory){this.base.warn(e,t)}error(e,t=this.defaultCategory){this.base.error(e,t)}},t.logProcess=function(e,t,s){const r=`(PROC ${s.pid})`;s.stdout.on("data",s=>e.info(`${r} ${s}`,t)),s.stderr.on("data",s=>e.info(`${r} ${s}`,t)),s.on("close",s=>e.info(`${r} closed (${s})`,t)),s.on("exit",s=>e.info(`${r} exited (${s})`,t))},t.captureLogs=function(e,t,s,r,c){if(!t||!o.isAbsolute(t))throw new Error("Path passed to logTo must be an absolute path");const u=(e=!1)=>e?`[${(new Date).toTimeString()}] `:`[${(new Date).toLocaleTimeString()}] `;let l=i.createWriteStream(t);s&&l.write(s),l.write(`${(new Date).toDateString()} ${u(!0)}Log file started${n.EOL}`);let h=e.onLog(e=>{if(!l)return;if(c&&-1===c.indexOf(e.category)&&e.severity!==a.LogSeverity.Warn&&e.severity!==a.LogSeverity.Error)return;const t=e.message?e.message.trimRight():"<empty message>",s=r&&t.length>r?t.substring(0,r)+"…":t,i=`${u()}[${a.LogCategory[e.category]}] [${a.LogSeverity[e.severity]}] `;l.write(`${i}${s}${n.EOL}`)});return{dispose:()=>(h&&(h.dispose(),h=void 0),new Promise(e=>{l&&(l.write(`${(new Date).toDateString()} ${u(!0)}Log file ended${n.EOL}`),l.end(e),l=void 0)}))}}},function(e,t){e.exports=require("os")},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(24),a=s(2),c={},u={},l={},h={},d={};let p=[],g=[];class f{constructor(e,t,s){this.logger=e,this.analyzer=t,this.wsContext=s,this.disposables=[],p=[],g=[],this.disposables.push(i.workspace.onDidOpenTextDocument(e=>{this.updateSubscriptions()})),this.disposables.push(i.workspace.onDidCloseTextDocument(e=>{const t=n.fsPath(e.uri);delete c[t],delete u[t],delete l[t],delete h[t],delete d[t],this.updateSubscriptions()})),this.disposables.push(i.window.onDidChangeVisibleTextEditors(e=>this.updatePriorityFiles())),this.disposables.push(this.analyzer.registerForAnalysisOutline(e=>c[e.file]=e.outline)),this.disposables.push(this.analyzer.registerForFlutterOutline(e=>u[e.file]=e.outline)),this.disposables.push(this.analyzer.registerForAnalysisOccurrences(e=>l[e.file]=e.occurrences)),this.disposables.push(this.analyzer.registerForAnalysisFolding(e=>h[e.file]=e.regions)),this.updatePriorityFiles(),this.updateSubscriptions()}updatePriorityFiles(){return r(this,void 0,void 0,function*(){const e=this.validPathsFor(i.window.visibleTextEditors.map(e=>e.document));if(this.pathsHaveChanged(p,e)){p=e;try{yield this.analyzer.analysisSetPriorityFiles({files:e})}catch(e){this.logger.error(e)}}})}updateSubscriptions(){return r(this,void 0,void 0,function*(){const e=this.validPathsFor(i.workspace.textDocuments);if(this.pathsHaveChanged(g,e)){g=e;try{yield this.analyzer.analysisSetSubscriptions({subscriptions:{CLOSING_LABELS:this.analyzer.capabilities.supportsClosingLabels?e:void 0,FOLDING:e,OCCURRENCES:e,OUTLINE:e}})}catch(e){this.logger.error(e)}if(this.wsContext.hasAnyFlutterProjects&&this.analyzer.capabilities.supportsFlutterOutline)try{yield this.analyzer.flutterSetSubscriptions({subscriptions:{OUTLINE:e}})}catch(e){this.logger.error(e)}}})}pathsHaveChanged(e,t){return e.length!==t.length||e.some((e,s)=>e!==t[s])}validPathsFor(e){const t=this.analyzer.capabilities.supportsPriorityFilesOutsideAnalysisRoots?a.isAnalyzable:a.isAnalyzableAndInWorkspace;return e.filter(e=>!e.isClosed&&t(e)).map(e=>n.fsPath(e.uri)).sort((e,t)=>e.localeCompare(t))}dispose(){this.disposables.forEach(e=>e.dispose())}}t.openFileTracker={create:(e,t,s)=>new f(e,t,s),getOutlineFor:e=>c[n.fsPath(e)],getFlutterOutlineFor:e=>u[n.fsPath(e)],getOccurrencesFor:e=>l[n.fsPath(e)],supportsPubRunTest(e){const t=n.fsPath(e);if(!a.isPubRunnableTestFile(t))return!1;if(void 0===d[t]){const e=o.locateBestProjectRoot(t);d[t]=!(!e||!a.checkProjectSupportsPubRunTest(e))}return d[n.fsPath(e)]},getFoldingRegionsFor:e=>h[n.fsPath(e)],getLastPriorityFiles:()=>p.slice(),getLastSubscribedFiles:()=>g.slice()}},function(e,t,s){"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("events")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortBy=function(e,t){return e.sort((e,s)=>{const r=t(e),i=t(s);return r<i?-1:r>i?1:0})},t.not=function(e){return t=>!e(t)}},function(e,t){e.exports=require("https")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(12),i=s(1),n=s(5),o=s(7),a=s(9),c=s(8);let u;t.getExtensionLogPath=function(){return u=u||c.config.extensionLogFile||i.join(process.env.DC_TEST_LOGS||r.tmpdir(),`dart-code-startup-log-${a.getRandomInt(4096,65536).toString(16)}.txt`)},t.userSelectableLogCategories={"Analysis Server":o.LogCategory.Analyzer,"Command Processes":o.LogCategory.CommandProcesses,"Debugger (Observatory)":o.LogCategory.Observatory,"Flutter Device Daemon":o.LogCategory.FlutterDaemon,"Flutter Run":o.LogCategory.FlutterRun,"Flutter Test":o.LogCategory.FlutterTest,"Pub Run Test":o.LogCategory.PubTest,"Web Daemon":o.LogCategory.WebDaemon};const l=[];t.clearLogHeader=function(){l.length=0},t.getLogHeader=function(){return l.length?l.join(n.platformEol)+n.platformEol+n.platformEol:""},t.addToLogHeader=function(e){try{l.push(e().replace(/\r/g,"").replace(/\n/g,"\r\n"))}catch(e){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(19),n=s(10);t.StdIOService=class{constructor(e,t,s,r=!1,i=!1){this.getLogFile=e,this.logger=t,this.maxLogLineLength=s,this.messagesWrappedInBrackets=r,this.treatHandlingErrorsAsUnhandledMessages=i,this.disposables=[],this.additionalPidsToTerminate=[],this.nextRequestID=1,this.activeRequests={},this.messageBuffer=[],this.requestErrorSubscriptions=[],this.processExited=!1,this.currentLogFile=e()}createProcess(e,t,s,r){this.logTraffic(`Spawning ${t} with args ${JSON.stringify(s)}`),e&&this.logTraffic(`..  in ${e}`),r&&this.logTraffic(`..  with ${JSON.stringify(r)}`),this.process=n.safeSpawn(e,t,s,r),this.logTraffic(`    PID: ${process.pid}`),this.process.stdout.on("data",e=>{const t=e.toString();this.messageBuffer.push(t),t.indexOf("\n")>=0&&this.processMessageBuffer()}),this.process.stderr.on("data",e=>{this.logTraffic(`${e.toString()}`,!0)}),this.process.on("exit",(e,t)=>{this.logTraffic(`Process terminated! ${e}, ${t}`),this.processExited=!0}),this.process.on("error",e=>{this.logTraffic(`Process errored! ${e}`)})}buildRequest(e,t,s){return{id:e.toString(),method:t,params:s}}sendRequest(e,t){const s=this.nextRequestID++;return new Promise((r,i)=>{this.activeRequests[s.toString()]=[r,i,e];const n=this.buildRequest(s,e,t),o=this.messagesWrappedInBrackets?"["+JSON.stringify(n)+"]\r\n":JSON.stringify(n)+"\r\n";this.sendMessage(o)})}cancelAllRequests(){Object.keys(this.activeRequests).forEach(e=>this.activeRequests[e]="CANCELLED")}sendMessage(e){this.logTraffic(`==> ${e}`),this.process?this.process.stdin.write(e):this.logTraffic("  (not sent: no process)")}processMessageBuffer(){let e=this.messageBuffer.join("");if(this.messageBuffer=[],!e.endsWith("\n")){const t=e.lastIndexOf("\n"),s=e.substring(t+1);e=e.substring(0,t),this.messageBuffer.push(s)}e.split("\n").filter(e=>""!==e.trim()).forEach(e=>this.handleMessage(`${e}\n`))}processUnhandledMessage(e){}handleMessage(e){if(this.logTraffic(`<== ${e.trimRight()}\r\n`),!this.shouldHandleMessage(e.trim()))return void this.processUnhandledMessage(e);let t;try{t=JSON.parse(e),this.messagesWrappedInBrackets&&t&&1===t.length&&(t=t[0])}catch(t){if(this.treatHandlingErrorsAsUnhandledMessages)return this.logger.error(`Unexpected non-JSON message, assuming normal stdout (${t})\n\n${t.stack}\n\n${e}`),void this.processUnhandledMessage(e);throw t}try{t&&this.isNotification(t)?this.handleNotification(t):t&&this.isResponse(t)?this.handleResponse(t):(this.logger.error(`Unexpected JSON message, assuming normal stdout : ${e}`),this.processUnhandledMessage(e))}catch(t){if(!this.treatHandlingErrorsAsUnhandledMessages)throw t;this.logger.error(`Failed to handle JSON message, assuming normal stdout (${t})\n\n${t.stack}\n\n${e}`),this.processUnhandledMessage(e)}}isNotification(e){return!!e.event}isResponse(e){return!!e.id}handleResponse(e){const t=this.activeRequests[e.id];if(delete this.activeRequests[e.id],"CANCELLED"===t)return void this.logger.info(`Ignoring response to ${e.id} because it was cancelled:\n\n${JSON.stringify(e,void 0,4)}`);if(!t)return void this.logger.error(`Unable to handle response with ID ${e.id} because its handler is not available`);const s=t[2],r=e.error;r&&"SERVER_ERROR"===r.code&&(r.method=s,this.notify(this.requestErrorSubscriptions,r)),r?t[1](r):t[0](e.result)}notify(e,t){e.slice().forEach(e=>e(t))}subscribe(e,t){e.push(t);const s={dispose:()=>{let r=e.indexOf(t);r>=0&&e.splice(r,1),(r=this.disposables.indexOf(s))>=0&&this.disposables.splice(r,1)}};return this.disposables.push(s),s}registerForRequestError(e){return this.subscribe(this.requestErrorSubscriptions,e)}logTraffic(e,t=!1){t?this.logger.error(e):this.logger.info(e);const s=this.getLogFile();s!==this.currentLogFile&&this.logStream&&(this.logStream.end(),this.logStream=void 0),s&&(this.currentLogFile=s,this.logStream||(this.logStream=r.createWriteStream(this.currentLogFile),this.logStream.write(i.getLogHeader())),this.logStream.write(`[${(new Date).toLocaleTimeString()}]: `),this.maxLogLineLength&&e.length>this.maxLogLineLength?this.logStream.write(e.substring(0,this.maxLogLineLength)+"…\r\n"):this.logStream.write(e.trim()+"\r\n"))}dispose(){this.logStream&&(this.logStream.end(),this.logStream=void 0);for(const e of this.additionalPidsToTerminate)try{process.kill(e)}catch(e){this.logger.error({message:e.toString()})}this.additionalPidsToTerminate.length=0;try{this.processExited||!this.process||this.process.killed||this.process.kill()}catch(e){}this.process=void 0,this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(39);t.DebugSession=r.DebugSession,t.InitializedEvent=r.InitializedEvent,t.TerminatedEvent=r.TerminatedEvent,t.StoppedEvent=r.StoppedEvent,t.ContinuedEvent=r.ContinuedEvent,t.OutputEvent=r.OutputEvent,t.ThreadEvent=r.ThreadEvent,t.BreakpointEvent=r.BreakpointEvent,t.ModuleEvent=r.ModuleEvent,t.LoadedSourceEvent=r.LoadedSourceEvent,t.CapabilitiesEvent=r.CapabilitiesEvent,t.Thread=r.Thread,t.StackFrame=r.StackFrame,t.Scope=r.Scope,t.Variable=r.Variable,t.Breakpoint=r.Breakpoint,t.Source=r.Source,t.Module=r.Module,t.CompletionItem=r.CompletionItem,t.ErrorDestination=r.ErrorDestination;const i=s(100);t.LoggingDebugSession=i.LoggingDebugSession;const n=s(60);t.Logger=n;const o=s(40);t.Event=o.Event,t.Response=o.Response;const a=s(102);t.Handles=a.Handles;const c=n.logger;t.logger=c},function(e,t,s){e.exports=g,g.Minimatch=f;var r={sep:"/"};try{r=s(1)}catch(e){}var i=g.GLOBSTAR=f.GLOBSTAR={},n=s(78),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="[^/]",c=a+"*?",u="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",l="(?:(?!(?:\\/|^)\\.).)*?",h="().*{}+?[]^$\\!".split("").reduce(function(e,t){return e[t]=!0,e},{});var d=/\/+/;function p(e,t){e=e||{},t=t||{};var s={};return Object.keys(t).forEach(function(e){s[e]=t[e]}),Object.keys(e).forEach(function(t){s[t]=e[t]}),s}function g(e,t,s){if("string"!=typeof t)throw new TypeError("glob pattern string required");return s||(s={}),!(!s.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new f(t,s).match(e))}function f(e,t){if(!(this instanceof f))return new f(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==r.sep&&(e=e.split(r.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function m(e,t){if(t||(t=this instanceof f?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:n(e)}g.filter=function(e,t){return t=t||{},function(s,r,i){return g(s,e,t)}},g.defaults=function(e){if(!e||!Object.keys(e).length)return g;var t=g,s=function(s,r,i){return t.minimatch(s,r,p(e,i))};return s.Minimatch=function(s,r){return new t.Minimatch(s,p(e,r))},s},f.defaults=function(e){return e&&Object.keys(e).length?g.defaults(e).Minimatch:f},f.prototype.debug=function(){},f.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var s=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,s),s=this.globParts=s.map(function(e){return e.split(d)}),this.debug(this.pattern,s),s=s.map(function(e,t,s){return e.map(this.parse,this)},this),this.debug(this.pattern,s),s=s.filter(function(e){return-1===e.indexOf(!1)}),this.debug(this.pattern,s),this.set=s},f.prototype.parseNegate=function(){var e=this.pattern,t=!1,s=this.options,r=0;if(s.nonegate)return;for(var i=0,n=e.length;i<n&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.substr(r));this.negate=t},g.braceExpand=function(e,t){return m(e,t)},f.prototype.braceExpand=m,f.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var s=this.options;if(!s.noglobstar&&"**"===e)return i;if(""===e)return"";var r,n="",u=!!s.nocase,l=!1,d=[],p=[],g=!1,f=-1,m=-1,b="."===e.charAt(0)?"":s.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=this;function w(){if(r){switch(r){case"*":n+=c,u=!0;break;case"?":n+=a,u=!0;break;default:n+="\\"+r}y.debug("clearStateChar %j %j",r,n),r=!1}}for(var S,E=0,T=e.length;E<T&&(S=e.charAt(E));E++)if(this.debug("%s\t%s %s %j",e,E,n,S),l&&h[S])n+="\\"+S,l=!1;else switch(S){case"/":return!1;case"\\":w(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,E,n,S),g){this.debug("  in class"),"!"===S&&E===m+1&&(S="^"),n+=S;continue}y.debug("call clearStateChar %j",r),w(),r=S,s.noext&&w();continue;case"(":if(g){n+="(";continue}if(!r){n+="\\(";continue}d.push({type:r,start:E-1,reStart:n.length,open:o[r].open,close:o[r].close}),n+="!"===r?"(?:(?!(?:":"(?:",this.debug("plType %j %j",r,n),r=!1;continue;case")":if(g||!d.length){n+="\\)";continue}w(),u=!0;var C=d.pop();n+=C.close,"!"===C.type&&p.push(C),C.reEnd=n.length;continue;case"|":if(g||!d.length||l){n+="\\|",l=!1;continue}w(),n+="|";continue;case"[":if(w(),g){n+="\\"+S;continue}g=!0,m=E,f=n.length,n+=S;continue;case"]":if(E===m+1||!g){n+="\\"+S,l=!1;continue}if(g){var P=e.substring(m+1,E);try{RegExp("["+P+"]")}catch(e){var k=this.parse(P,v);n=n.substr(0,f)+"\\["+k[0]+"\\]",u=u||k[1],g=!1;continue}}u=!0,g=!1,n+=S;continue;default:w(),l?l=!1:!h[S]||"^"===S&&g||(n+="\\"),n+=S}g&&(P=e.substr(m+1),k=this.parse(P,v),n=n.substr(0,f)+"\\["+k[0],u=u||k[1]);for(C=d.pop();C;C=d.pop()){var _=n.slice(C.reStart+C.open.length);this.debug("setting tail",n,C),_=_.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,s){return s||(s="\\"),t+t+s+"|"}),this.debug("tail=%j\n   %s",_,_,C,n);var R="*"===C.type?c:"?"===C.type?a:"\\"+C.type;u=!0,n=n.slice(0,C.reStart)+R+"\\("+_}w(),l&&(n+="\\\\");var x=!1;switch(n.charAt(0)){case".":case"[":case"(":x=!0}for(var F=p.length-1;F>-1;F--){var D=p[F],A=n.slice(0,D.reStart),O=n.slice(D.reStart,D.reEnd-8),I=n.slice(D.reEnd-8,D.reEnd),L=n.slice(D.reEnd);I+=L;var M=A.split("(").length-1,N=L;for(E=0;E<M;E++)N=N.replace(/\)[+*?]?/,"");var $="";""===(L=N)&&t!==v&&($="$");var j=A+O+L+$+I;n=j}""!==n&&u&&(n="(?=.)"+n);x&&(n=b+n);if(t===v)return[n,u];if(!u)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var U=s.nocase?"i":"";try{var W=new RegExp("^"+n+"$",U)}catch(e){return new RegExp("$.")}return W._glob=e,W._src=n,W};var v={};g.makeRe=function(e,t){return new f(e,t||{}).makeRe()},f.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,s=t.noglobstar?c:t.dot?u:l,r=t.nocase?"i":"",n=e.map(function(e){return e.map(function(e){return e===i?s:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src}).join("\\/")}).join("|");n="^(?:"+n+")$",this.negate&&(n="^(?!"+n+").*$");try{this.regexp=new RegExp(n,r)}catch(e){this.regexp=!1}return this.regexp},g.match=function(e,t,s){var r=new f(t,s=s||{});return e=e.filter(function(e){return r.match(e)}),r.options.nonull&&!e.length&&e.push(t),e},f.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var s=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/"));e=e.split(d),this.debug(this.pattern,"split",e);var i,n,o=this.set;for(this.debug(this.pattern,"set",o),n=e.length-1;n>=0&&!(i=e[n]);n--);for(n=0;n<o.length;n++){var a=o[n],c=e;s.matchBase&&1===a.length&&(c=[i]);var u=this.matchOne(c,a,t);if(u)return!!s.flipNegate||!this.negate}return!s.flipNegate&&this.negate},f.prototype.matchOne=function(e,t,s){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var n=0,o=0,a=e.length,c=t.length;n<a&&o<c;n++,o++){this.debug("matchOne loop");var u,l=t[o],h=e[n];if(this.debug(t,l,h),!1===l)return!1;if(l===i){this.debug("GLOBSTAR",[t,l,h]);var d=n,p=o+1;if(p===c){for(this.debug("** at the end");n<a;n++)if("."===e[n]||".."===e[n]||!r.dot&&"."===e[n].charAt(0))return!1;return!0}for(;d<a;){var g=e[d];if(this.debug("\nglobstar while",e,d,t,p,g),this.matchOne(e.slice(d),t.slice(p),s))return this.debug("globstar found match!",d,a,g),!0;if("."===g||".."===g||!r.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,d,t,p);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!s||(this.debug("\n>>> no match, partial?",e,d,t,p),d!==a))}if("string"==typeof l?(u=r.nocase?h.toLowerCase()===l.toLowerCase():h===l,this.debug("string match",l,h,u)):(u=h.match(l),this.debug("pattern match",l,h,u)),!u)return!1}if(n===a&&o===c)return!0;if(n===a)return s;if(o===c)return n===a-1&&""===e[n];throw new Error("wtf?")}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(7),o=s(4),a=s(8),c=s(2),u=s(90);class l{static get empty(){return new l("0.0.0")}constructor(e){this.version=e}get hasCompleteStatementFix(){return o.versionIsAtLeast(this.version,"1.20.2")}get supportsAnalyzingHtmlFiles(){return o.versionIsAtLeast(this.version,"1.18.5")}get supportsPriorityFilesOutsideAnalysisRoots(){return o.versionIsAtLeast(this.version,"1.18.2")}get supportsDiagnostics(){return o.versionIsAtLeast(this.version,"1.18.1")}get supportsClosingLabels(){return o.versionIsAtLeast(this.version,"1.18.4")}get supportsCustomFolding(){return o.versionIsAtLeast(this.version,"1.20.3")}get supportsFlutterOutline(){return o.versionIsAtLeast(this.version,"1.26.0")}get supportsGetDeclerations(){return o.versionIsAtLeast(this.version,"1.18.7")}get supportsGetDeclerationsForFile(){return o.versionIsAtLeast(this.version,"1.19.0")}get supportsGetSignature(){return o.versionIsAtLeast(this.version,"1.20.5")}get isDart2(){return o.versionIsAtLeast(this.version,"1.19.0")}get hasNewSignatureFormat(){return o.versionIsAtLeast(this.version,"1.27.1")}get hasNewHoverLibraryFormat(){return o.versionIsAtLeast(this.version,"1.27.1")}get supportsAvailableSuggestions(){return o.versionIsAtLeast(this.version,"1.26.0")}get supportsIncludedImports(){return o.versionIsAtLeast(this.version,"1.27.1")}}t.AnalyzerCapabilities=l;t.Analyzer=class extends u.AnalyzerGen{constructor(e,t,s){super(e,()=>a.config.analyzerLogFile,a.config.maxLogLineLength),this.isAnalyzing=!1,this.capabilities=l.empty,this.resolvedPromise=Promise.resolve();let r=[];a.config.analyzerObservatoryPort&&r.push(`--enable-vm-service=${a.config.analyzerObservatoryPort}`),r.push(s),a.config.analyzerDiagnosticsPort&&r.push(`--port=${a.config.analyzerDiagnosticsPort}`),r.push("--client-id=Dart-Code.dart-code"),r.push(`--client-version=${c.extensionVersion}`),a.config.analyzerInstrumentationLogFile&&r.push(`--instrumentation-log-file=${a.config.analyzerInstrumentationLogFile}`),a.config.analyzerAdditionalArgs&&(r=r.concat(a.config.analyzerAdditionalArgs)),this.launchArgs=r,this.registerForServerError(e=>this.requestDiagnosticsUpdate()),this.registerForRequestError(e=>this.requestDiagnosticsUpdate()),this.registerForServerConnected(e=>{this.version=e.version,this.capabilities.version=this.version});let i=t,n=r.slice();a.config.analyzerSshHost&&(i="ssh",n.unshift(t),n=["-q",a.config.analyzerSshHost,c.escapeShell(n)]),this.createProcess(void 0,i,n),this.serverSetSubscriptions({subscriptions:["STATUS"]}),this.registerForServerStatus(e=>{e.analysis&&(e.analysis.isAnalyzing?this.isAnalyzing=!0:(this.isAnalyzing=!1,this.currentAnalysisCompleter&&(this.currentAnalysisCompleter.resolve(),this.currentAnalysisCompleter=void 0)))})}get currentAnalysis(){return this.isAnalyzing?(this.currentAnalysisCompleter||(this.currentAnalysisCompleter=new o.PromiseCompleter),this.currentAnalysisCompleter.promise):this.resolvedPromise}sendMessage(e){try{super.sendMessage(e)}catch(e){const t=this.version?"The Dart Analyzer has terminated.":"The Dart Analyzer could not be started.";throw c.reloadExtension(t,void 0,!0),e}}shouldHandleMessage(e){return!(e.startsWith("--- ")||e.startsWith("+++ ")||e.startsWith("Observatory listening on")||e.startsWith("Observatory server"))}requestDiagnosticsUpdate(){return r(this,void 0,void 0,function*(){this.lastDiagnostics=void 0,this.capabilities.supportsDiagnostics&&(this.lastDiagnostics=(yield this.diagnosticGetDiagnostics()).contexts)})}getLastDiagnostics(){return this.lastDiagnostics}getAnalyzerLaunchArgs(){return this.launchArgs}forceNotificationsFor(e){const t={};t[e]={edits:[{offset:0,length:0,replacement:"",id:""}],type:"change"},this.analysisUpdateContent({files:t})}completionGetSuggestionsResults(e){return this.requestWithStreamedResults(()=>this.completionGetSuggestions(e),this.registerForCompletionResults)}searchFindElementReferencesResults(e){return this.requestWithStreamedResults(()=>this.searchFindElementReferences(e),this.registerForSearchResults)}searchFindTopLevelDeclarationsResults(e){return this.requestWithStreamedResults(()=>this.searchFindTopLevelDeclarations(e),this.registerForSearchResults)}searchFindMemberDeclarationsResults(e){return this.requestWithStreamedResults(()=>this.searchFindMemberDeclarations(e),this.registerForSearchResults)}requestWithStreamedResults(e,t){return new Promise((s,r)=>{const i=[];let n;const o=t.bind(this)(e=>{n&&e.id===n&&e.isLast?(o.dispose(),s(e)):!n&&e.isLast&&i.push(e)});e.bind(this)().then(e=>{e.id||(o.dispose(),r()),n=e.id;const t=i.find(e=>e.id===n);t&&(o.dispose(),s(t))},()=>r())})}},t.getSymbolKindForElementKind=function(e,t){switch(t){case"CLASS":case"CLASS_TYPE_ALIAS":case"MIXIN":return i.SymbolKind.Class;case"COMPILATION_UNIT":return i.SymbolKind.Module;case"CONSTRUCTOR":case"CONSTRUCTOR_INVOCATION":return i.SymbolKind.Constructor;case"ENUM":return i.SymbolKind.Enum;case"ENUM_CONSTANT":return i.SymbolKind.EnumMember;case"FIELD":return i.SymbolKind.Field;case"FILE":return i.SymbolKind.File;case"FUNCTION":case"FUNCTION_INVOCATION":case"FUNCTION_TYPE_ALIAS":return i.SymbolKind.Function;case"GETTER":return i.SymbolKind.Property;case"LABEL":return i.SymbolKind.Module;case"LIBRARY":return i.SymbolKind.Namespace;case"LOCAL_VARIABLE":return i.SymbolKind.Variable;case"METHOD":return i.SymbolKind.Method;case"PARAMETER":case"PREFIX":return i.SymbolKind.Variable;case"SETTER":return i.SymbolKind.Property;case"TOP_LEVEL_VARIABLE":case"TYPE_PARAMETER":return i.SymbolKind.Variable;case"UNIT_TEST_GROUP":return i.SymbolKind.Module;case"UNIT_TEST_TEST":return i.SymbolKind.Method;case"UNKNOWN":return i.SymbolKind.Object;default:return e.error(`Unknown kind: ${t}`,n.LogCategory.Analyzer),i.SymbolKind.Object}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(9),n=s(2);t.UPGRADE_TO_WORKSPACE_FOLDERS="Mark Projects as Workspace Folders",t.locateBestProjectRoot=function(e){if(!e||!n.isWithinWorkspace(e))return;let t=e;for(;t!==r.dirname(t);){if(i.hasPubspec(t)||i.hasPackagesFile(t))return t;t=r.dirname(t)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(1),n=s(5),o=s(4);t.PackageMap=class{constructor(e){if(this.map={},!e)return;this.localPackageRoot=i.dirname(e);const t=r.readFileSync(e,{encoding:"utf8"}).split("\n");for(let e of t){if(0===(e=e.trim()).length||e.startsWith("#"))continue;const t=e.indexOf(":");if(-1!==t){const s=e.substr(0,t),r=e.substring(t+1);r.startsWith("file:")?this.map[s]=o.uriToFilePath(r):(this.map[s]=i.join(this.localPackageRoot,r),"lib"!==r&&"lib\\"!==r&&"lib/"!==r||(this.localPackageName=s))}}}static findPackagesFile(e){if("string"==typeof e)return o.findFile(".packages",e)}get packages(){return Object.assign({},this.map)}getPackagePath(e){return this.map[e]}resolvePackageUri(e){if(!e)return;let t=e;t.startsWith("package:")&&(t=t.substring(8));const s=t.indexOf("/");if(-1===s)return;const r=t.substring(s+1);t=t.substring(0,s);const n=this.getPackagePath(t);return n?i.join(n,r):void 0}convertFileToPackageUri(e,t=!0){if(e)for(const s of Object.keys(this.map)){const r=this.map[s];if(o.isWithinPath(e,r)){if(!t&&s===this.localPackageName)return;let i=e.substring(r.length);return n.isWin&&(i=i.replace(/\\/g,"/")),i.startsWith("/")&&(i=i.substr(1)),`package:${s}/${i}`}}}}},function(e,t,s){"use strict";const r=s(108),i=s(109),n=s(27),{kStatusCode:o,NOOP:a}=s(14),c=Buffer.from([0,0,255,255]),u=Buffer.from([0]),l=Symbol("permessage-deflate"),h=Symbol("total-length"),d=Symbol("callback"),p=Symbol("buffers"),g=Symbol("error");let f;function m(e){this[p].push(e),this[h]+=e.length}function v(e){this[h]+=e.length,this[l]._maxPayload<1||this[h]<=this[l]._maxPayload?this[p].push(e):(this[g]=new RangeError("Max payload size exceeded"),this[g][o]=1009,this.removeListener("data",v),this.reset())}function b(e){this[l]._inflate=null,e[o]=1007,this[d](e)}e.exports=class{constructor(e,t,s){if(this._maxPayload=0|s,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!f){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;f=new r({concurrency:e})}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate&&(this._deflate.close(),this._deflate=null)}acceptAsServer(e){const t=this._options,s=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(s.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?s.client_max_window_bits=t.clientMaxWindowBits:!0!==s.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete s.client_max_window_bits,s}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let s=e[t];if(s.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(s=s[0],"client_max_window_bits"===t){if(!0!==s){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}else if("server_max_window_bits"===t){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==s)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}e[t]=s})}),e}decompress(e,t,s){f.push(r=>{this._decompress(e,t,(e,t)=>{r(),s(e,t)})})}compress(e,t,s){f.push(r=>{this._compress(e,t,(e,t)=>{r(),s(e,t)})})}_decompress(e,t,s){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[h]=0,this._inflate[p]=[],this._inflate.on("error",b),this._inflate.on("data",v)}this._inflate[d]=s,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{const e=this._inflate[g];if(e)return this._inflate.close(),this._inflate=null,void s(e);const i=n.concat(this._inflate[p],this._inflate[h]);t&&this.params[`${r}_no_context_takeover`]?(this._inflate.close(),this._inflate=null):(this._inflate[h]=0,this._inflate[p]=[]),s(null,i)})}_compress(e,t,s){if(!e||0===e.length)return void process.nextTick(s,null,u);const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[h]=0,this._deflate[p]=[],this._deflate.on("error",a),this._deflate.on("data",m)}this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=n.concat(this._deflate[p],this._deflate[h]);t&&(e=e.slice(0,e.length-4)),t&&this.params[`${r}_no_context_takeover`]?(this._deflate.close(),this._deflate=null):(this._deflate[h]=0,this._deflate[p]=[]),s(null,e)})}}},function(e,t,s){"use strict";const{EMPTY_BUFFER:r}=s(14);function i(e,t){if(0===e.length)return r;if(1===e.length)return e[0];const s=Buffer.allocUnsafe(t);let i=0;for(let t=0;t<e.length;t++){const r=e[t];r.copy(s,i),i+=r.length}return s}function n(e,t,s,r,i){for(let n=0;n<i;n++)s[r+n]=e[n]^t[3&n]}function o(e,t){const s=e.length;for(let r=0;r<s;r++)e[r]^=t[3&r]}function a(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function c(e){if(c.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=function(e){const t=Buffer.from(e.buffer);if(e.byteLength!==e.buffer.byteLength)return t.slice(e.byteOffset,e.byteOffset+e.byteLength);return t}(e):(t=Buffer.from(e),c.readOnly=!1),t}try{const t=s(!function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()),r=t.BufferUtil||t;e.exports={concat:i,mask(e,t,s,i,o){o<48?n(e,t,s,i,o):r.mask(e,t,s,i,o)},toArrayBuffer:a,toBuffer:c,unmask(e,t){e.length<32?o(e,t):r.unmask(e,t)}}}catch(t){e.exports={concat:i,mask:n,toArrayBuffer:a,toBuffer:c,unmask:o}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(21),i=s(7),n=s(4);t.DebugAdapterLogger=class{constructor(e,t){this.debugClient=e,this.category=t}log(e,t,s=this.category){this.debugClient.sendEvent(new r.Event("dart.log",{message:e,severity:t,category:s}))}info(e,t){this.log(e,i.LogSeverity.Info,t)}warn(e,t){this.log(n.errorString(e),i.LogSeverity.Warn,t)}error(e,t){this.log(n.errorString(e),i.LogSeverity.Error,t)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(20);t.FlutterRunBase=class extends r.StdIOService{constructor(e,t,s,r,i=!1,n=!1){super(t,s,r,i,n),this.mode=e,this.unhandledMessageSubscriptions=[],this.daemonConnectedSubscriptions=[],this.appStartSubscriptions=[],this.appDebugPortSubscriptions=[],this.appStartedSubscriptions=[],this.appStopSubscriptions=[],this.appProgressSubscriptions=[],this.appLogSubscriptions=[],this.errorSubscriptions=[],this.daemonLogMessageSubscriptions=[],this.daemonLogSubscriptions=[]}shouldHandleMessage(e){return e.startsWith("[{")&&e.endsWith("}]")}processUnhandledMessage(e){this.notify(this.unhandledMessageSubscriptions,e)}registerForUnhandledMessages(e){return this.subscribe(this.unhandledMessageSubscriptions,e)}handleNotification(e){switch(e.params.error&&this.notify(this.errorSubscriptions,e.params.error),e.event){case"daemon.connected":this.notify(this.daemonConnectedSubscriptions,e.params);break;case"app.start":this.notify(this.appStartSubscriptions,e.params);break;case"app.debugPort":this.notify(this.appDebugPortSubscriptions,e.params);break;case"app.started":this.notify(this.appStartedSubscriptions,e.params);break;case"app.stop":this.notify(this.appStopSubscriptions,e.params);break;case"app.progress":this.notify(this.appProgressSubscriptions,e.params);break;case"app.log":this.notify(this.appLogSubscriptions,e.params);break;case"daemon.logMessage":this.notify(this.daemonLogMessageSubscriptions,e.params);break;case"daemon.log":this.notify(this.daemonLogSubscriptions,e.params)}}restart(e,t,s,r){return this.sendRequest("app.restart",{appId:e,fullRestart:!0===s,pause:t,reason:r})}detach(e){return this.sendRequest("app.detach",{appId:e})}stop(e){return this.sendRequest("app.stop",{appId:e})}callServiceExtension(e,t,s){return this.sendRequest("app.callServiceExtension",{appId:e,methodName:t,params:s})}registerForDaemonConnect(e){return this.subscribe(this.daemonConnectedSubscriptions,e)}registerForAppStart(e){return this.subscribe(this.appStartSubscriptions,e)}registerForAppDebugPort(e){return this.subscribe(this.appDebugPortSubscriptions,e)}registerForAppStarted(e){return this.subscribe(this.appStartedSubscriptions,e)}registerForAppStop(e){return this.subscribe(this.appStopSubscriptions,e)}registerForAppProgress(e){return this.subscribe(this.appProgressSubscriptions,e)}registerForAppLog(e){return this.subscribe(this.appLogSubscriptions,e)}registerForError(e){return this.subscribe(this.errorSubscriptions,e)}registerForDaemonLogMessage(e){return this.subscribe(this.daemonLogMessageSubscriptions,e)}registerForDaemonLog(e){return this.subscribe(this.daemonLogSubscriptions,e)}},function(e){e[e.Run=0]="Run",e[e.Attach=1]="Attach"}(t.RunMode||(t.RunMode={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i={};function n(e){return i[e]||(i[e]=r.window.createOutputChannel(e)),i[e]}t.createChannel=n,t.getChannel=function(e){return i[e]?i[e]:n(e)},t.runProcessInChannel=function(e,t){e.stdout.on("data",e=>t.append(e.toString())),e.stderr.on("data",e=>t.append(e.toString())),e.on("close",e=>t.appendLine(`exit code ${e}`))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),i="https://raw.githubusercontent.com/Dart-Code/Icons/master/material/$1%402x.png",n=new RegExp(`(?:${r.escapeRegExp("<p>")})?`+r.escapeRegExp('<i class="material-icons md-36">')+"([\\w\\s_]+)"+r.escapeRegExp('</i> &#x2014; material icon named "')+"([\\w\\s_]+)"+r.escapeRegExp('".')+`(?:${r.escapeRegExp("</p>")})?`,"gi"),o=new RegExp("(\\n\\s*{@.*?}$)|(^{@.*?}\\s*\\n)|(^{@.*?}$)","gim"),a=new RegExp("(```\\w+) +\\w+","gi");t.cleanDartdoc=function(e){if(!e)return"";const t=e.indexOf("## Other resources");return-1!==t&&(e=e.substring(0,t)),e=(e=(e=(e=e.replace(/\[:\S+:\]/g,e=>`[${e.substring(2,e.length-2)}]`)).replace(n,`![$1](${i}|width=32,height=32)`)).replace(o,"")).replace(a,"$1")},t.stripMarkdown=function(e){return e?e=(e=e.replace(/\[(.+?)\]\(.+?\)/g,"$1")).replace(/\[(.+?)\]/g,"$1"):""}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(15),a=s(0),c=s(74),u=s(5),l=s(7),h=s(11),d=s(76),p=s(4),g=s(9),f=s(85),m=s(3),v=s(87),b=s(23),y=s(91),w=s(92),S=s(13),E=s(93),T=s(95),C=s(96),P=s(97),k=s(35),_=s(70),R=s(124),x=s(59),F=s(125),D=s(126),A=s(72),O=s(131),I=s(132),L=s(8),M=s(133),N=s(134),$=s(136),j=s(137),U=s(138),W=s(140),q=s(141),B=s(142),G=s(47),V=s(143),z=s(144),H=s(145),K=s(146),Q=s(73),J=s(147),X=s(148),Y=s(149),Z=s(150),ee=s(151),te=s(152),se=s(36),re=s(153),ie=s(154),ne=s(155),oe=s(156),ae=s(157),ce=s(158),ue=s(159),le=s(160),he=s(161),de=s(163),pe=s(164),ge=s(165),fe=s(34),me=s(166),ve=s(2),be=s(19),ye=s(10),we=s(167),Se=s(68),Ee={language:"dart",scheme:"file"},Te={language:"html",scheme:"file"},Ce="dart-code:dartProjectLoaded",Pe="dart-code:anyFlutterProjectLoaded",ke="dart-code:flutterMobileProjectLoaded",_e="dart-code:flutterWebProjectLoaded";t.FLUTTER_SUPPORTS_ATTACH="dart-code:flutterSupportsAttach";const Re="dart-code:dartPlatformName";let xe,Fe;t.SERVICE_EXTENSION_CONTEXT_PREFIX="dart-code:serviceExtension.",t.SERVICE_CONTEXT_PREFIX="dart-code:service.";const De=de.DartCapabilities.empty,Ae=c.FlutterCapabilities.empty;let Oe,Ie,Le,Me,Ne=[];const $e=new h.EmittingLogger;function je(){Ne=ve.getDartWorkspaceFolders().map(e=>m.fsPath(e.uri));const e=[];if(u.isWin){const t=t=>{if(!t||!n.isAbsolute(t))return;const s=Ne.find(e=>p.isWithinPath(t,e));s&&($e.info(`Excluding folder ${t} from analysis roots as it is a child of analysis root ${s} and may cause performance issues.`),e.push(t))};t(process.env.PUB_CACHE),t(process.env.APPDATA),t(process.env.LOCALAPPDATA)}ve.getDartWorkspaceFolders().forEach(t=>{const s=L.config.for(t.uri).analysisExcludedFolders,r=m.fsPath(t.uri);s&&o.isArray(s)&&s.forEach(t=>{n.isAbsolute(t)||(t=n.join(r,t)),e.push(t)})}),xe.analysisSetAnalysisRoots({excluded:e,included:Ne})}function Ue(e){const t=L.config.showTodos,s=Ie!==t;Ie=t;const r=qe(),i=Le!==r;Le=r,s&&We(),i&&ve.reloadExtension()}function We(){xe.analysisReanalyze()}function qe(){return"CONF-"+L.config.sdkPath+L.config.analyzerPath+L.config.analyzerDiagnosticsPort+L.config.analyzerObservatoryPort+L.config.analyzerInstrumentationLogFile+L.config.extensionLogFile+L.config.analyzerAdditionalArgs+L.config.flutterSdkPath+L.config.closingLabels+L.config.analyzeAngularTemplates+L.config.analysisServerFolding+L.config.showTestCodeLens+L.config.previewHotReloadCoverageMarkers+L.config.previewBuildRunnerTasks+L.config.triggerSignatureHelpAutomatically+L.config.flutterAdbConnectOnChromeOs}function Be(e=!1){return r(this,void 0,void 0,function*(){Ge(!1),a.commands.executeCommand("setContext",t.FLUTTER_SUPPORTS_ATTACH,!1),e||(a.commands.executeCommand("setContext",u.HAS_LAST_DEBUG_CONFIG,!1),yield Oe.logExtensionShutdown(),Me&&(yield Me.dispose()))})}function Ge(e,t){a.commands.executeCommand("setContext",Ce,e),a.commands.executeCommand("setContext",Pe,e&&t.hasAnyFlutterProjects),a.commands.executeCommand("setContext",ke,e&&t.hasAnyFlutterMobileProjects),a.commands.executeCommand("setContext",_e,e&&t.hasAnyFlutterWebProjects)}t.activate=function e(t,s=!1){Me||(Me=h.captureLogs($e,be.getExtensionLogPath(),void 0,4e3,[l.LogCategory.General]));const r=v.Context.for(t);ve.logTime("Code called activate"),t.subscriptions.push(a.commands.registerCommand("_dart.reloadExtension",s=>{$e.info("Performing silent extension reload..."),Be(!0);const r=t.subscriptions.slice();t.subscriptions.length=0;for(const e of r)try{e.dispose()}catch(e){$e.error(e)}e(t,!0),$e.info("Done!")})),Ie=L.config.showTodos,Le=qe();const o=new Date;ve.logTime();const c=new fe.SdkUtils($e),de=c.initWorkspace();ve.logTime("initWorkspace");const Ce=de.sdks;if(function(e){be.clearLogHeader(),be.addToLogHeader(()=>"!! PLEASE REVIEW THIS LOG FOR SENSITIVE INFORMATION BEFORE SHARING !!"),be.addToLogHeader(()=>""),be.addToLogHeader(()=>`Dart Code extension: ${ve.extensionVersion}`),be.addToLogHeader(()=>{const e=a.extensions.getExtension(u.flutterExtensionIdentifier);return`Flutter extension: ${e.packageJSON.version} (${e.isActive?"":"not "}activated)`}),be.addToLogHeader(()=>`VS Code: ${a.version}`),be.addToLogHeader(()=>`Platform: ${u.platformDisplayName}`),be.addToLogHeader(()=>`Workspace type: ${e.workspaceTypeDescription}`),be.addToLogHeader(()=>`Multi-root?: ${a.workspace.workspaceFolders&&a.workspace.workspaceFolders.length>1}`);const t=e.sdks;be.addToLogHeader(()=>`Dart SDK:\n    Loc: ${t.dart}\n    Ver: ${ve.getSdkVersion($e,t.dart)}`),be.addToLogHeader(()=>`Flutter SDK:\n    Loc: ${t.flutter}\n    Ver: ${ve.getSdkVersion($e,t.flutter)}`),be.addToLogHeader(()=>`HTTP_PROXY: ${process.env.HTTP_PROXY}`),be.addToLogHeader(()=>`NO_PROXY: ${process.env.NO_PROXY}`)}(de),Oe=new E.Analytics($e,de),!Ce.dart||de.hasAnyFlutterProjects&&!Ce.flutter)return c.handleMissingSdks(t,Oe,de);Ce.flutterVersion&&(Ae.version=Ce.flutterVersion,Oe.flutterSdkVersion=Ce.flutterVersion),Ce.dartVersion&&(De.version=Ce.dartVersion,Oe.sdkVersion=Ce.dartVersion,ge.checkForStandardDartSdkUpdates($e,de),t.subscriptions.push(new pe.StatusBarVersionTracker(de)));const Pe=new Date,ke=L.config.analyzerPath||n.join(Ce.dart,u.analyzerSnapshotPath);if(!L.config.analyzerSshHost&&!i.existsSync(ke))return void a.window.showErrorMessage("Could not find a Dart Analysis Server at "+ke);xe=new b.Analyzer($e,n.join(Ce.dart,u.dartVMPath),ke),t.subscriptions.push(xe);const _e=xe.registerForServerConnected(e=>{Oe.analysisServerVersion=e.version;const t=new Date;Oe.logAnalyzerStartupTime(t.getTime()-Pe.getTime()),_e.dispose()}),Ne=()=>new Promise((e,t)=>{const s=xe.registerForServerStatus(t=>{t.analysis&&!t.analysis.isAnalyzing&&(e(),s.dispose())})});let Ve;const ze=Ne(),He=xe.registerForServerStatus(e=>{if(e.analysis&&e.analysis.isAnalyzing&&!Ve&&(Ve=new Date),e.analysis&&!e.analysis.isAnalyzing&&Ve){const e=new Date;Oe.logAnalyzerFirstAnalysisTime(e.getTime()-Ve.getTime()),He.dispose()}}),Ke=new Q.DartHoverProvider($e,xe),Qe=new H.DartFormattingEditProvider($e,xe,r);t.subscriptions.push(Qe);const Je=new B.DartCompletionItemProvider($e,xe),Xe=new Y.DartReferenceProvider(xe),Ye=new K.DartDocumentHighlightProvider(xe),Ze=new ue.SourceCodeActionProvider,et=new Z.DartRenameProvider(xe),tt=new J.DartImplementationProvider(xe),st=[Ee];L.config.analyzeAngularTemplates&&xe.capabilities.supportsAnalyzingHtmlFiles&&st.push(Te);const rt=new oe.RankingCodeActionProvider,it=".(${'\"/\\".split("");if(t.subscriptions.push(a.languages.registerHoverProvider(st,Ke)),Qe.registerDocumentFormatter(st),t.subscriptions.push(a.languages.registerCompletionItemProvider(st,Je,...it)),t.subscriptions.push(a.languages.registerDefinitionProvider(st,Xe)),t.subscriptions.push(a.languages.registerReferenceProvider(st,Xe)),t.subscriptions.push(a.languages.registerDocumentHighlightProvider(st,Ye)),rt.registerProvider(new q.AssistCodeActionProvider($e,st,xe)),rt.registerProvider(new re.FixCodeActionProvider($e,st,xe)),rt.registerProvider(new ae.RefactorCodeActionProvider(st,xe)),t.subscriptions.push(a.languages.registerRenameProvider(st,et)),Qe.registerTypingFormatter(Ee,"}",";"),t.subscriptions.push(a.languages.registerCodeActionsProvider(Ee,Ze,Ze.metadata)),rt.registerProvider(new ie.IgnoreLintCodeActionProvider(st)),t.subscriptions.push(a.languages.registerImplementationProvider(Ee,tt)),L.config.showTestCodeLens){const e=new C.TestCodeLensProvider($e,xe);t.subscriptions.push(e),t.subscriptions.push(a.languages.registerCodeLensProvider(Ee,e))}t.subscriptions.push(a.languages.registerCodeActionsProvider(st,rt,rt.metadata)),L.config.previewBuildRunnerTasks&&t.subscriptions.push(a.tasks.registerTaskProvider("pub",new le.PubBuildRunnerTaskProvider(Ce))),t.subscriptions.push(a.languages.registerCompletionItemProvider(Ee,new ce.SnippetCompletionItemProvider("snippets/dart.json",e=>!0))),t.subscriptions.push(a.languages.registerCompletionItemProvider(Ee,new ce.SnippetCompletionItemProvider("snippets/flutter.json",e=>ve.isInsideFlutterProject(e)||ve.isInsideFlutterWebProject(e)))),t.subscriptions.push(a.languages.setLanguageConfiguration(Ee.language,new X.DartLanguageConfiguration));new y.AnalyzerStatusReporter($e,xe,de,Oe);const nt=a.languages.createDiagnosticCollection("dart");t.subscriptions.push(nt);new G.DartDiagnosticProvider(xe,nt);t.subscriptions.push(a.workspace.onDidChangeWorkspaceFolders(e=>je()));const ot=xe.registerForServerConnected(e=>{ot.dispose(),a.workspace.workspaceFolders&&je()});t.subscriptions.push(new w.FileChangeHandler(xe)),de.hasAnyFlutterMobileProjects&&(Fe=new U.FlutterDaemon($e,n.join(Ce.flutter,u.flutterPath),Ce.flutter),t.subscriptions.push(Fe),j.setUpDaemonMessageHandler($e,t,Fe)),ve.logTime("All other stuff before debugger..");const at=new he.PubGlobal($e,r,Ce),ct=new se.DebugConfigProvider($e,Ce,Oe,at,Fe&&Fe.deviceManager,Ae);t.subscriptions.push(a.debug.registerDebugConfigurationProvider("dart",ct)),t.subscriptions.push(ct),L.config.previewFlutterUiGuides&&t.subscriptions.push(new N.FlutterUiGuideDecorations(xe));const ut=xe.registerForServerConnected(e=>{ut.dispose(),xe.capabilities.supportsClosingLabels&&L.config.closingLabels&&t.subscriptions.push(new M.ClosingLabelsDecorations(xe)),xe.capabilities.supportsGetDeclerations?t.subscriptions.push(a.languages.registerWorkspaceSymbolProvider(new te.DartWorkspaceSymbolProvider($e,xe))):t.subscriptions.push(a.languages.registerWorkspaceSymbolProvider(new ne.LegacyDartWorkspaceSymbolProvider($e,xe))),xe.capabilities.supportsCustomFolding&&L.config.analysisServerFolding&&t.subscriptions.push(a.languages.registerFoldingRangeProvider(Ee,new z.DartFoldingProvider(xe))),xe.capabilities.supportsGetSignature&&t.subscriptions.push(a.languages.registerSignatureHelpProvider(Ee,new ee.DartSignatureHelpProvider(xe),...L.config.triggerSignatureHelpAutomatically?["(",","]:[]));const s=new V.DartDocumentSymbolProvider($e,xe);st.forEach(e=>{t.subscriptions.push(a.languages.registerDocumentSymbolProvider(e,s))}),t.subscriptions.push(S.openFileTracker.create($e,xe,de)),xe.capabilities.supportsAvailableSuggestions&&L.config.autoImportCompletions&&xe.completionSetSubscriptions({subscriptions:["AVAILABLE_SUGGESTION_SETS"]})});t.subscriptions.push(a.workspace.onDidChangeConfiguration(()=>Ue(Ce))),t.subscriptions.push(a.workspace.onDidSaveTextDocument(e=>{"pubspec.yaml"===n.basename(m.fsPath(e.uri)).toLowerCase()&&Ue(Ce)})),t.subscriptions.push(a.workspace.onDidChangeWorkspaceFolders(e=>{Ue(Ce)}));new P.AnalyzerCommands(t,xe);const lt=new A.SdkCommands($e,t,de,c,at,Ae,Fe&&Fe.deviceManager),ht=new k.DebugCommands($e,r,de,Oe,at);de.hasAnyFlutterProjects&&W.setUpHotReloadOnSave(t,nt,ht),t.subscriptions.push(a.window.registerUriHandler(new f.DartUriHandler(Ae))),t.subscriptions.push(new _.EditCommands($e,t,xe)),t.subscriptions.push(new D.RefactorCommands($e,t,xe)),t.subscriptions.push(new I.TypeHierarchyCommand($e,xe)),t.subscriptions.push(new R.GoToSuperCommand(xe)),t.subscriptions.push(new x.LoggingCommands($e,t.logPath)),t.subscriptions.push(new F.OpenInOtherEditorCommands($e,Ce)),t.subscriptions.push(new O.TestCommands($e));const dt=new we.DartPackagesProvider($e),pt=a.window.createTreeView("dartPackages",{treeDataProvider:dt});t.subscriptions.push(dt,pt),t.subscriptions.push(a.workspace.onDidChangeWorkspaceFolders(e=>{dt.refresh()}));const gt=new Se.TestResultsProvider,ft=a.window.createTreeView("dartTestTree",{treeDataProvider:gt});if(t.subscriptions.push(gt,ft,gt.onDidStartTests(e=>{L.config.openTestViewOnStart&&ft.reveal(e)}),gt.onFirstFailure(e=>{L.config.openTestViewOnFailure&&ft.reveal(e)}),ft.onDidChangeSelection(e=>{gt.setSelectedNodes(e.selection&&1===e.selection.length?e.selection[0]:void 0)})),de.hasAnyFlutterProjects&&L.config.previewHotReloadCoverageMarkers&&t.subscriptions.push(new $.HotReloadCoverageDecorations($e,ht)),t.subscriptions.push(a.commands.registerCommand("dart.package.openFile",e=>{e&&a.workspace.openTextDocument(e).then(e=>{a.window.showTextDocument(e,{preview:!0})},e=>$e.error(e))})),a.workspace.workspaceFolders&&a.workspace.workspaceFolders.length)for(const e of a.workspace.workspaceFolders){const t=p.forceWindowsDriveLetterToUppercase(m.fsPath(e.uri)),s=p.forceWindowsDriveLetterToUppercase(g.trueCasePathSync(t));if(t&&s&&t!==s){a.window.showWarningMessage("The casing of the open workspace folder does not match the casing on the underlying disk; please re-open the folder using the File Open dialog. "+`Expected ${s} but got ${t}`);break}}function mt(){de.hasProjectsInFuchsiaTree||lt.fetchPackagesOrPrompt(void 0,{alwaysPrompt:!0})}if(s||me.showUserPrompts($e,r,de),Ge(!0,de),a.commands.executeCommand("setContext",Re,u.dartPlatformName),t.subscriptions.push(a.workspace.onDidChangeWorkspaceFolders(e=>mt())),s||mt(),de.shouldLoadFlutterExtension){const e=a.extensions.getExtension(u.flutterExtensionIdentifier);e&&($e.info(`Activating Flutter extension for ${de.workspaceTypeDescription} project...`),e.activate())}const vt=new Date;return s?Oe.logExtensionRestart(vt.getTime()-o.getTime()):Oe.logExtensionStartup(vt.getTime()-o.getTime()),Object.assign({},new T.DartExtensionApi,{[d.internalApiSymbol]:{analyzerCapabilities:xe.capabilities,cancelAllAnalysisRequests:()=>xe.cancelAllRequests(),completionItemProvider:Je,context:r,currentAnalysis:()=>xe.currentAnalysis,get cursorIsInTest(){return O.cursorIsInTest},daemonCapabilities:Fe?Fe.capabilities:U.DaemonCapabilities.empty,dartCapabilities:De,debugCommands:ht,debugProvider:ct,fileTracker:S.openFileTracker,flutterCapabilities:Ae,getLogHeader:be.getLogHeader,initialAnalysis:ze,logger:$e,nextAnalysis:Ne,packagesTreeProvider:dt,pubGlobal:at,reanalyze:We,renameProvider:et,safeSpawn:ye.safeSpawn,testTreeProvider:gt,workspaceContext:de}})},t.deactivate=Be},function(e,t,s){"use strict";function r(e){return"/"===e.charAt(0)}function i(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),s=t[1]||"",r=Boolean(s&&":"!==s.charAt(1));return Boolean(t[2]||r)}e.exports="win32"===process.platform?i:r,e.exports.posix=r,e.exports.win32=i},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(0),a=s(5),c=s(4),u=s(9),l=s(3),h=s(88),d=s(8),p=s(25),g=s(2);function f(e){if(e&&u.hasPubspec(e)){return new RegExp("sdk\\s*:\\s*flutter","i").test(i.readFileSync(n.join(e,"pubspec.yaml")).toString())}return!1}function m(e){if(e&&u.hasPubspec(e)){return new RegExp("\\s*flutter_web\\s*:","i").test(i.readFileSync(n.join(e,"pubspec.yaml")).toString())}return!1}function v(e){if(!i.existsSync(e))return;let t=new p.PackageMap(e).getPackagePath("flutter");if(!t)return;a.isWin&&(t=t.replace(/\\/g,"/"));return t.endsWith("/packages/flutter/lib/")&&(t=t.substr(0,t.length-"/packages/flutter/lib/".length)),t.endsWith("/")||(t+="/"),t.endsWith("/bin/")||(t+="bin/"),a.isWin&&"\\"===(t=t.replace(/\//g,"\\"))[0]&&(t=t.substring(1)),t}t.SdkUtils=class{constructor(e){this.logger=e,this.hasShownActivationFailure=!1}handleMissingSdks(e,t,s){e.subscriptions.push(o.commands.registerCommand("flutter.createProject",e=>{this.showRelevantActivationFailureMessage(t,s,!0,"flutter.createProject")})),e.subscriptions.push(o.commands.registerCommand("flutter.createWebProject",e=>{this.showRelevantActivationFailureMessage(t,s,!0,"flutter.createWebProject")})),e.subscriptions.push(o.commands.registerCommand("dart.createProject",e=>{this.showRelevantActivationFailureMessage(t,s,!1,"dart.createProject")})),e.subscriptions.push(o.commands.registerCommand("_dart.flutter.createSampleProject",e=>{this.showRelevantActivationFailureMessage(t,s,!0,"_dart.flutter.createSampleProject")})),e.subscriptions.push(o.commands.registerCommand("flutter.doctor",e=>{this.showRelevantActivationFailureMessage(t,s,!0,"flutter.doctor")})),e.subscriptions.push(o.commands.registerCommand("flutter.upgrade",e=>{this.showRelevantActivationFailureMessage(t,s,!0,"flutter.upgrade")})),setTimeout(()=>{this.hasShownActivationFailure||(s.hasAnyFlutterProjects?this.showRelevantActivationFailureMessage(t,s,!0):s.hasAnyStandardDartProjects?this.showRelevantActivationFailureMessage(t,s,!1):this.logger.error("No Dart or Flutter SDK was found. Suppressing prompt because it doesn't appear that a Dart/Flutter project is open."))},500)}showRelevantActivationFailureMessage(e,t,s,r){s&&t.sdks.flutter&&!t.sdks.dart?this.showFluttersDartSdkActivationFailure():s?this.showFlutterActivationFailure(r):this.showDartActivationFailure(r),this.hasShownActivationFailure||(e.logSdkDetectionFailure(),this.hasShownActivationFailure=!0)}showFluttersDartSdkActivationFailure(){g.reloadExtension("Could not find Dart in your Flutter SDK. Please run 'flutter doctor' in the terminal then reload the project once all issues are resolved.","Reload",!0)}showFlutterActivationFailure(e){this.showSdkActivationFailure("Flutter",this.findFlutterSdk,a.FLUTTER_DOWNLOAD_URL,e=>d.config.setGlobalFlutterSdkPath(e),e)}showDartActivationFailure(e){this.showSdkActivationFailure("Dart",this.findDartSdk,a.DART_DOWNLOAD_URL,e=>d.config.setGlobalDartSdkPath(e),e)}showSdkActivationFailure(e,t,s,i,n){return r(this,void 0,void 0,function*(){let r=`Could not find a ${e} SDK. `+`Please ensure ${e.toLowerCase()} is installed and in your PATH (you may need to restart).`;for(;;){const a=yield o.window.showErrorMessage(r,"Locate SDK","Download SDK",g.showLogAction);if("Locate SDK"!==a){if("Download SDK"===a){l.openInBrowser(s);break}if(a===g.showLogAction){g.openExtensionLogFile();break}break}{const s=yield o.window.showOpenDialog({canSelectFolders:!0,openLabel:`Set ${e} SDK folder`});if(s&&s.length>0){const a=t(s.map(l.fsPath));if(a){yield i(a),yield g.reloadExtension(),n&&o.commands.executeCommand(n);break}r=`That folder does not appear to be a ${e} SDK.`}}}})}initWorkspace(){this.logger.info("Searching for SDKs...");const e=g.getDartWorkspaceFolders().map(e=>l.fsPath(e.uri)),t=process.env.DART_PATH_OVERRIDE||"",s=process.env.PATH||"",r=(t+n.delimiter+s).split(n.delimiter).filter(e=>e);this.logger.info("Environment PATH:");for(const e of r)this.logger.info(`    ${e}`);if(d.config.analyzerSshHost)return new h.WorkspaceContext({dart:d.config.sdkPath,dartSdkIsFromFlutter:!1,flutter:void 0},!1,!1,!1,!1);let o,p;e.forEach(e=>o=o||function(e){if(e){let t=e;for(;t;){try{if(i.statSync(n.join(t,".jiri_root")).isDirectory())return t}catch(e){}const e=n.dirname(t);if(t===e)break;t=e}}}(e));let b=!1,y=!1,w=!1,S=!1;u.findProjectFolders(e).forEach(e=>{const t=u.hasPubspec(e),s=t&&f(e),r=t&&m(e),o=i.existsSync(n.join(e,a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE)),c=i.existsSync(n.join(e,a.FLUTTER_STAGEHAND_PROJECT_TRIGGER_FILE)),l=i.existsSync(n.join(e,"bin/flutter"))&&i.existsSync(n.join(e,"bin/cache/dart-sdk")),h=s||r||o||c||l;h&&this.logger.info(`Found Flutter project at ${e}:\n\t\t\tMobile? ${s}\n\t\t\tWeb? ${r}\n\t\t\tCreate Trigger? ${o}\n\t\t\tStagehand Trigger? ${c}\n\t\t\tFlutter Repo? ${l}`),p=p||(h?e:void 0),b=b||h,y=y||s&&!r||o,w=w||r||c,S=S||!h&&t}),o&&(this.logger.info(`Found Fuchsia root at ${o}`),S&&this.logger.info("Found Fuchsia project that is not vanilla Flutter"));const E=[d.config.flutterSdkPath,o&&n.join(o,"lib/flutter"),o&&n.join(o,"third_party/dart-pkg/git/flutter"),p,p&&v(n.join(p,".packages")),process.env.FLUTTER_ROOT].concat(r).filter(g.notUndefined),T=this.findFlutterSdk(E),C=[o&&n.join(o,"topaz/tools/prebuilt-dart-sdk",`${a.dartPlatformName}-x64`),o&&n.join(o,"third_party/dart/tools/sdks/dart-sdk"),o&&n.join(o,"third_party/dart/tools/sdks",a.dartPlatformName,"dart-sdk"),o&&n.join(o,"dart/tools/sdks",a.dartPlatformName,"dart-sdk"),p&&T&&n.join(T,"bin/cache/dart-sdk"),d.config.sdkPath].concat(r).concat([T&&n.join(T,"bin/cache/dart-sdk")]).filter(g.notUndefined),P=this.findDartSdk(C);return new h.WorkspaceContext({dart:P,dartSdkIsFromFlutter:!!P&&c.isDartSdkFromFlutter(P),dartVersion:g.getSdkVersion(this.logger,P),flutter:T,flutterVersion:g.getSdkVersion(this.logger,T)},y,w,S,!!o&&S)}findDartSdk(e){return this.searchPaths(e,a.dartExecutableName,e=>this.hasExecutable(e,a.dartVMPath)&&t.hasDartAnalysisServer(e))}findFlutterSdk(e){return this.searchPaths(e,a.flutterExecutableName,e=>this.hasExecutable(e,a.flutterPath))}hasExecutable(e,t){const s=n.join(e,t);return i.existsSync(s)&&i.statSync(s).isFile()}searchPaths(e,t,s){this.logger.info(`Searching for ${t}`);let r=e.filter(e=>e).map(g.resolvePaths).filter(g.notUndefined);r=c.flatMap(r,e=>(e=>-1!==["bin","sbin"].indexOf(n.basename(e)))(e)?[e]:[e,n.join(e,"bin")]),this.logger.info(`    Looking for ${t} in:`);for(const e of r)this.logger.info(`        ${e}`);r=r.filter(e=>i.existsSync(n.join(e,t))),this.logger.info("    Found at:");for(const e of r)this.logger.info(`        ${e}`);r=r.map(e=>{const s=n.join(e,t),r=e&&i.realpathSync(s);return r.toLowerCase()!==s.toLowerCase()&&this.logger.info(`Following symlink: ${s} ==> ${r}`),n.dirname(n.dirname(r))}),this.logger.info("    Candidate paths to be post-filtered:");for(const e of r)this.logger.info(`        ${e}`);const o=r.find(s||(e=>!0));return o&&this.logger.info(`    Found at ${o}`),this.logger.info(`    Returning SDK path ${o} for ${t}`),o}},t.referencesFlutterSdk=f,t.referencesFlutterWeb=m,t.referencesBuildRunner=function(e){if(e&&u.hasPubspec(e))return new RegExp("build_runner\\s*:","i").test(i.readFileSync(n.join(e,"pubspec.yaml")).toString());return!1},t.hasDartAnalysisServer=e=>i.existsSync(n.join(e,a.analyzerSnapshotPath))},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(0),a=s(7),c=s(4),u=s(9),l=s(58),h=s(3),d=s(98),p=s(36),g=s(123),f=s(2),m=s(67);t.debugSessions=[];let v=[];class b{}t.LastDebugSession=b;t.DebugCommands=class{constructor(e,s,c,l,p){this.logger=e,this.context=s,this.analytics=l,this.debugMetrics=o.window.createStatusBarItem(o.StatusBarAlignment.Right,0),this.onWillHotReloadEmitter=new o.EventEmitter,this.onWillHotReload=this.onWillHotReloadEmitter.event,this.onWillHotRestartEmitter=new o.EventEmitter,this.onWillHotRestart=this.onWillHotRestartEmitter.event,this.onReceiveCoverageEmitter=new o.EventEmitter,this.onReceiveCoverage=this.onReceiveCoverageEmitter.event,this.onFirstFrameEmitter=new o.EventEmitter,this.onFirstFrame=this.onFirstFrameEmitter.event,this.onDebugSessionVmServiceAvailableEmitter=new o.EventEmitter,this.onDebugSessionVmServiceAvailable=this.onDebugSessionVmServiceAvailableEmitter.event,this.flutterExtensions=new d.FlutterVmServiceExtensions(this.sendServiceSetting),this.devTools=new g.DevToolsManager(e,c.sdks,this,l,p),s.subscriptions.push(this.devTools),s.subscriptions.push(this.debugMetrics),s.subscriptions.push(o.debug.onDidStartDebugSession(e=>this.handleDebugSessionStart(e))),s.subscriptions.push(o.debug.onDidReceiveDebugSessionCustomEvent(e=>this.handleDebugSessionCustomEvent(e))),s.subscriptions.push(o.debug.onDidTerminateDebugSession(e=>this.handleDebugSessionEnd(e))),s.subscriptions.push(o.commands.registerCommand("flutter.togglePlatform",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.PlatformOverride,"iOS","android"))),s.subscriptions.push(o.commands.registerCommand("flutter.toggleDebugPainting",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.DebugPaint))),s.subscriptions.push(o.commands.registerCommand("flutter.togglePerformanceOverlay",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.PerformanceOverlay))),s.subscriptions.push(o.commands.registerCommand("flutter.toggleRepaintRainbow",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.RepaintRainbow))),s.subscriptions.push(o.commands.registerCommand("flutter.toggleDebugModeBanner",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.DebugBanner))),s.subscriptions.push(o.commands.registerCommand("flutter.toggleCheckElevations",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.CheckElevations))),s.subscriptions.push(o.commands.registerCommand("flutter.togglePaintBaselines",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.PaintBaselines))),s.subscriptions.push(o.commands.registerCommand("flutter.toggleSlowAnimations",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.SlowAnimations,d.timeDilationNormal,d.timeDilationSlow))),s.subscriptions.push(o.commands.registerCommand("flutter.inspectWidget",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.InspectorSelectMode,!0,!0))),s.subscriptions.push(o.commands.registerCommand("flutter.cancelInspectWidget",()=>this.flutterExtensions.toggle(a.FlutterServiceExtension.InspectorSelectMode,!1,!1))),s.subscriptions.push(o.commands.registerCommand("dart.openObservatory",()=>r(this,void 0,void 0,function*(){if(!t.debugSessions.length)return;const s=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();s&&!s.session.configuration.noDebug&&s.observatoryUri?(h.openInBrowser(s.observatoryUri),l.logDebuggerOpenObservatory()):s&&e.warn("Cannot start Observatory for session without debug/observatoryUri")}))),s.subscriptions.push(o.commands.registerCommand("flutter.openTimeline",()=>r(this,void 0,void 0,function*(){if(!t.debugSessions.length)return;const s=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();s&&!s.session.configuration.noDebug&&s.observatoryUri?(h.openInBrowser(s.observatoryUri+"/#/timeline-dashboard"),l.logDebuggerOpenTimeline()):s&&e.warn("Cannot start Observatory for session without debug/observatoryUri")}))),s.subscriptions.push(o.commands.registerCommand("_dart.openDevTools.touchBar",e=>o.commands.executeCommand("dart.openDevTools",e))),s.subscriptions.push(o.commands.registerCommand("dart.openDevTools",()=>r(this,void 0,void 0,function*(){if(!t.debugSessions.length)return void o.window.showInformationMessage("Dart DevTools requires an active debug session.");const e=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();return e?e.vmServiceUri?this.devTools.spawnForSession(e):void(e.session.configuration.noDebug?o.window.showInformationMessage("You must start your app with debugging in order to use DevTools."):o.window.showInformationMessage("This debug session is not ready yet.")):void 0}))),s.subscriptions.push(o.commands.registerCommand("_flutter.hotReload.touchBar",e=>o.commands.executeCommand("flutter.hotReload",e))),s.subscriptions.push(o.commands.registerCommand("flutter.hotReload",e=>{t.debugSessions.length&&(this.onWillHotReloadEmitter.fire(),t.debugSessions.forEach(t=>t.session.customRequest("hotReload",e)),l.logDebuggerHotReload())})),s.subscriptions.push(o.commands.registerCommand("flutter.hotRestart",e=>{t.debugSessions.length&&(this.onWillHotRestartEmitter.fire(),t.debugSessions.forEach(t=>t.session.customRequest("hotRestart",e)),l.logDebuggerRestart())})),s.subscriptions.push(o.commands.registerCommand("_dart.requestCoverageUpdate",e=>{t.debugSessions.forEach(t=>t.session.customRequest("requestCoverageUpdate",{scriptUris:e}))})),s.subscriptions.push(o.commands.registerCommand("_dart.coverageFilesUpdate",e=>{t.debugSessions.forEach(t=>t.session.customRequest("coverageFilesUpdate",{scriptUris:e}))})),s.subscriptions.push(o.commands.registerCommand("dart.startDebugging",e=>{o.debug.startDebugging(o.workspace.getWorkspaceFolder(e),{name:"Dart",program:h.fsPath(e),request:"launch",type:"dart"})})),s.subscriptions.push(o.commands.registerCommand("dart.startWithoutDebugging",e=>{o.debug.startDebugging(o.workspace.getWorkspaceFolder(e),{name:"Dart",noDebug:!0,program:h.fsPath(e),request:"launch",type:"dart"})})),s.subscriptions.push(o.commands.registerCommand("dart.runAllTestsWithoutDebugging",()=>{const e=f.getDartWorkspaceFolders().map(e=>h.fsPath(e.uri)),t=u.findProjectFolders(e,{requirePubspec:!0}).map(e=>n.join(e,"test")).filter(e=>i.existsSync(e));if(0!==t.length)for(const e of t){const t=o.workspace.getWorkspaceFolder(o.Uri.file(e)),s=n.basename(n.dirname(e));o.debug.startDebugging(t,{name:`Dart ${s}`,noDebug:!0,program:e,request:"launch",type:"dart"})}else o.window.showErrorMessage("Unable to find any test folders")})),s.subscriptions.push(o.commands.registerCommand("dart.rerunLastDebugSession",()=>{b.debugConfig?o.debug.startDebugging(b.workspaceFolder,b.debugConfig):o.window.showErrorMessage("There is no previous debug session to run.")})),s.subscriptions.push(o.commands.registerCommand("dart.attach",()=>{o.debug.startDebugging(void 0,{name:"Dart: Attach to Process",request:"attach",type:"dart"})})),s.subscriptions.push(o.commands.registerCommand("flutter.attachProcess",()=>{o.debug.startDebugging(void 0,{name:"Flutter: Attach to Process",observatoryUri:"${command:dart.promptForVmService}",request:"attach",type:"dart"})})),s.subscriptions.push(o.commands.registerCommand("flutter.attach",()=>{o.debug.startDebugging(void 0,{name:"Flutter: Attach to Device",request:"attach",type:"dart"})})),s.subscriptions.push(o.commands.registerCommand("dart.promptForVmService",e=>r(this,void 0,void 0,function*(){const t="string"==typeof e?e:void 0;return o.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Paste an Observatory URI",prompt:"Enter Observatory URI",validateInput:e=>{if(e&&(e=e.trim(),!Number.isInteger(parseFloat(e))))return e.startsWith("http://")||e.startsWith("https://")?void 0:"Please enter a valid Observatory URI"},value:t})})))}handleDebugSessionStart(e){if("dart"===e.type){const s=new m.DartDebugSessionInformation(e);0===t.debugSessions.length&&this.flutterExtensions.resetToDefaults(),t.debugSessions.push(s);const r=v.filter(t=>t.session.id===e.id);v=v.filter(t=>t.session.id!==e.id),r.forEach(e=>{this.logger.info(`Processing delayed event ${e.event} for session ${e.session.id}`),this.handleCustomEventWithSession(s,e)})}}handleDebugSessionCustomEvent(e){if(this.flutterExtensions.handleDebugEvent(e),this.handleCustomEvent(e))return;const s=t.debugSessions.find(t=>t.session.id===e.session.id);if(!s)return this.logger.warn(`Did not find session ${e.session.id} to handle ${e.event}. There were ${t.debugSessions.length} sessions:\n${t.debugSessions.map(e=>`  ${e.session.id}`).join("\n")}`),this.logger.warn("Event will be queued and processed when the session start event fires"),void v.push(e);this.handleCustomEventWithSession(s,e)}handleDebugSessionEnd(e){const s=t.debugSessions.findIndex(t=>t.session.id===e.id);if(-1===s)return;const r=t.debugSessions[s];t.debugSessions.splice(s,1),this.clearProgressIndicators(r),this.debugMetrics.hide();const i=new Date;this.analytics.logDebugSessionDuration(i.getTime()-r.sessionStart.getTime()),0===t.debugSessions.length&&this.flutterExtensions.markAllServicesUnloaded()}handleCustomEvent(e){if("dart.log"===e.event){const t=e.body;switch(t.severity){case a.LogSeverity.Info:this.logger.info(t.message,t.category);break;case a.LogSeverity.Warn:this.logger.warn(t.message,t.category);break;case a.LogSeverity.Error:this.logger.error(t.message,t.category);break;default:this.logger.warn(`Failed to handle log event ${JSON.stringify(t)}`)}}else if("dart.hotRestartRequest"===e.event)this.analytics.logDebuggerRestart(),this.onWillHotRestartEmitter.fire();else if("dart.hotReloadRequest"===e.event)this.analytics.logDebuggerHotReload(),this.onWillHotReloadEmitter.fire();else if("dart.flutter.firstFrame"===e.event)this.onFirstFrameEmitter.fire();else if("dart.debugMetrics"===e.event){const t=e.body.memory,s=`${Math.ceil(t.current/1024/1024)}MB of ${Math.ceil(t.total/1024/1024)}MB`;this.debugMetrics.text=s,this.debugMetrics.tooltip="This is the amount of memory being consumed by your applications heaps (out of what has been allocated).\n\nNote: memory usage shown in debug builds may not be indicative of usage in release builds. Use profile builds for more accurate figures when testing memory usage.",this.debugMetrics.show()}else if("dart.coverage"===e.event)this.onReceiveCoverageEmitter.fire(e.body);else{if("dart.navigate"!==e.event)return!1;e.body.file&&e.body.line&&e.body.column&&o.commands.executeCommand("_dart.jumpToLineColInUri",o.Uri.parse(e.body.file),e.body.line,e.body.column)}return!0}handleCustomEventWithSession(e,t){if("dart.launching"===t.event)o.window.withProgress({location:o.ProgressLocation.Notification},s=>(s.report({message:t.body.message}),e.launchProgressReporter=s,e.launchProgressPromise.promise));else if("dart.launched"===t.event)this.clearProgressIndicators(e);else if("dart.progress"===t.event)t.body.message&&(e.launchProgressReporter?e.launchProgressReporter.report({message:t.body.message}):e.progressReporter?e.progressReporter.report({message:t.body.message}):(e.progressID=t.body.progressID,o.window.withProgress({location:o.ProgressLocation.Notification},s=>(s.report({message:t.body.message}),e.progressReporter=s,e.progressPromise||(e.progressPromise=new c.PromiseCompleter),e.progressPromise.promise)))),t.body.finished&&(e.launchProgressReporter||e.progressID===t.body.progressID&&(e.progressPromise&&e.progressPromise.resolve(),e.progressPromise=void 0,e.progressReporter=void 0));else if("dart.debuggerUris"===t.event){e.observatoryUri=t.body.observatoryUri,e.vmServiceUri=t.body.vmServiceUri;const s=e.session.configuration.debuggerType;s!==p.DebuggerType.Flutter&&s!==p.DebuggerType.FlutterWeb||l.showDevToolsNotificationIfAppropriate(this.context),this.onDebugSessionVmServiceAvailableEmitter.fire(e)}}clearProgressIndicators(e){e.launchProgressPromise&&e.launchProgressPromise.resolve(),e.launchProgressReporter=void 0,e.progressPromise&&e.progressPromise.resolve(),e.progressPromise=void 0,e.progressReporter=void 0}promptForDebugSession(){return r(this,void 0,void 0,function*(){const e=yield o.window.showQuickPick(t.debugSessions.map(e=>({description:e.session.workspaceFolder?e.session.workspaceFolder.name:void 0,detail:e.session.configuration.deviceName||`Started ${e.sessionStart.toLocaleTimeString()}`,label:e.session.name,session:e})),{placeHolder:"Which debug session?"});return e&&e.session})}sendServiceSetting(e,s){t.debugSessions.forEach(e=>{e.session.customRequest("serviceExtension",s)})}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(37),o=s(1),a=s(0),c=s(0),u=s(5),l=s(4),h=s(3),d=s(35),p=s(59),g=s(8),f=s(38),m=s(44),v=s(66),b=s(118),y=s(119),w=s(121),S=s(24),E=s(122),T=s(2),C=s(68),P=!!process.env.CI;let k=!1;var _;t.DebugConfigProvider=class{constructor(e,t,s,r,i,n){this.logger=e,this.sdks=t,this.analytics=s,this.pubGlobal=r,this.deviceManager=i,this.flutterCapabilities=n,this.debugServers={}}provideDebugConfigurations(e,t){const s=T.isFlutterWorkspaceFolder(e);return[{name:s?"Flutter":"Dart",program:s?void 0:"bin/main.dart",request:"launch",type:"dart"}]}resolveDebugConfiguration(e,t,s){return r(this,void 0,void 0,function*(){const r=this.logger,i=c.window.activeTextEditor&&c.window.activeTextEditor.document&&"file"===c.window.activeTextEditor.document.uri.scheme?h.fsPath(c.window.activeTextEditor.document.uri):void 0;function n(t){if(!t)return t;if(t=t.replace(/\${file}/gi,i),e){const s=h.fsPath(e.uri);t=t.replace(/\${(workspaceFolder|workspaceRoot)}/gi,s)}return t}function p(e,t){if(!t)return!1;const s=function(e){if(!e)return;const t=/\${\w+}/.exec(e);return t?t[0]:void 0}(t);return!!s&&(r.error(`Launch config property '${e}' has unresolvable variable ${s}`),c.window.showErrorMessage(`Launch config property '${e}' has unresolvable variable ${s}`),!0)}if(r.info("Starting debug session..."),e&&r.info(`    workspace: ${h.fsPath(e.uri)}`),t.program&&r.info(`    program  : ${t.program}`),t.cwd&&r.info(`    cwd      : ${t.cwd}`),t.program=n(t.program),t.cwd=n(t.cwd),p("program",t.program)||p("cwd",t.cwd))return null;i&&!e?(e=c.workspace.getWorkspaceFolder(c.Uri.file(i)))&&r.info(`Setting workspace based on open file: ${h.fsPath(e.uri)}`):!e&&a.workspace.workspaceFolders&&1===a.workspace.workspaceFolders.length&&(e=a.workspace.workspaceFolders[0])&&r.info(`Setting workspace based on single open workspace: ${h.fsPath(e.uri)}`),t.cwd&&!o.isAbsolute(t.cwd)&&e&&(t.cwd=o.join(h.fsPath(e.uri),t.cwd),r.info(`Converted cwd to absolute path: ${t.cwd}`)),t.program&&!o.isAbsolute(t.program)&&(t.cwd||e)&&(t.program=o.join(t.cwd||h.fsPath(e.uri),t.program),r.info(`Converted program to absolute path: ${t.program}`));const f="attach"===t.request;if(!f){if(!t.program){const s=t.cwd?t.cwd:e?h.fsPath(e.uri):void 0,r=!s||i&&l.isWithinPath(i,s)?i:void 0;t.program=t.program||this.guessBestEntryPoint(r,s)}if(!t.program)return r.warn("No program was set in launch config"),c.window.showInformationMessage("Set the 'program' value in your launch config (eg 'bin/main.dart') then launch again"),null}if(!t.cwd&&e&&(t.cwd=h.fsPath(e.uri),r.info(`Using workspace as cwd: ${t.cwd}`),t.program)){const s=S.locateBestProjectRoot(t.program);s&&l.isWithinPath(s,h.fsPath(e.uri))&&(t.cwd=s,r.info(`Found better project root to use as cwd: ${t.cwd}`))}t.program&&t.cwd&&!o.isAbsolute(t.program)&&(t.program=o.join(t.cwd,t.program));let m=_.Dart;!t.cwd||T.isInsideFolderNamed(t.program,"bin")||T.isInsideFolderNamed(t.program,"tool")||(T.isFlutterWebProjectFolder(t.cwd)?(m=_.FlutterWeb,T.isFlutterProjectFolder(t.cwd)&&(r.error("Flutter web project references sdk:flutter and may fail to launch"),c.window.showWarningMessage("Flutter web projects may fail to launch if they reference the Flutter SDK in pubspec.yaml"))):T.isFlutterProjectFolder(t.cwd)?m=_.Flutter:r.info(`Non-Dart Project (${t.program}) not recognised as Flutter or FlutterWeb, will use Dart debugger`)),r.info(`Detected launch project as ${_[m]}`);const v=m===_.Flutter||m===_.FlutterWeb,b=m===_.Flutter,y=t.program&&T.isTestFileOrFolder(t.program);y&&r.info("Detected launch project as a Test project");const w=y&&t.cwd&&T.checkProjectSupportsPubRunTest(t.cwd);if(y&&!w&&r.info("Project does not appear to support 'pub run test', will use VM directly"),y)switch(m){case _.Dart:w&&(m=_.PubTest);break;case _.Flutter:m=_.FlutterTest;break;case _.FlutterWeb:m=_.FlutterWebTest;break;default:r.info("Unknown debugType, unable to switch to test debugger")}if(r.info(`Using ${_[m]} debug adapter for this session`),m===_.FlutterWebTest)return r.error("Tests in Flutter web projects are not currently supported"),void c.window.showErrorMessage("Tests in Flutter web projects are not currently supported");if(f&&(b||(t.observatoryUri=yield this.getFullVmServiceUri(t.observatoryUri)),!t.observatoryUri&&!b))return r.warn("No Observatory URI/port was provided"),void c.window.showInformationMessage("You must provide an Observatory URI/port to attach a debugger");if(s&&s.isCancellationRequested)return;let E=this.deviceManager&&this.deviceManager.currentDevice;if(b&&!y&&!E&&this.deviceManager&&"flutter-tester"!==t.deviceId){if(!(yield this.deviceManager.promptForAndLaunchEmulator(!0)))return r.warn("Unable to launch due to no active device"),void c.window.showInformationMessage("Cannot launch without an active device");E=this.deviceManager&&this.deviceManager.currentDevice}if(s&&s.isCancellationRequested)return;if(!(yield this.installDependencies(m,this.pubGlobal)))return;if(s&&s.isCancellationRequested)return;if(this.setupDebugConfig(e,t,v,E),t.program=l.forceWindowsDriveLetterToUppercase(t.program),t.cwd=l.forceWindowsDriveLetterToUppercase(t.cwd),!f&&t.cwd&&g.config.promptToRunIfErrors){r.info("Checking for errors before launching");const e=e=>"dart"===e.source&&e.severity===a.DiagnosticSeverity.Error,s=a.languages.getDiagnostics().filter(t=>t[1].find(e)).find(e=>{const s=h.fsPath(e[0]);return l.isWithinPath(s,t.cwd)&&(!T.isTestFile(s)||s===t.program)});if(s){r.warn("Project has errors, prompting user"),r.warn(`    ${h.fsPath(s[0])}`),r.warn(`    ${s[1][0].range}: ${s[1][0].message}`);const e=yield c.window.showErrorMessage("Build errors exist in your project.",{modal:!0},u.debugAnywayAction,u.showErrorsAction);if(e!==u.debugAnywayAction)return r.info("Aborting!"),void(e===u.showErrorsAction&&a.commands.executeCommand("workbench.action.showErrorsWarnings"));r.info("Debugging anyway!")}}if(s&&s.isCancellationRequested)return;const P=this.getDebugServer(m,t.debugServer).address();if("string"==typeof P)return r.info("Debug server does not have a valid address"),void c.window.showErrorMessage("Debug server does not have a valid address");if(t.debugServer=P.port,m!==_.FlutterWeb||t.noDebug||this.flutterCapabilities.webSupportsDebugging||(t.noDebug=!0,k||(c.window.showInformationMessage("Breakpoints and stepping are not currently supported in VS Code for Flutter web projects, please use your browsers developer tools if you need to break or step through code."),k=!0)),this.analytics.logDebuggerStart(e&&e.uri,_[m],t.noDebug?"Run":"Debug"),m===_.FlutterTest||m===_.PubTest){const e=t.args&&(-1!==t.args.indexOf("--name")||-1!==t.args.indexOf("--pname"));C.TestResultsProvider.flagSuiteStart(t.program,!e)}return t.debuggerType=m,r.info(`Debug session starting...\n    ${JSON.stringify(t,void 0,4).replace(/\n/g,"\n    ")}`),d.LastDebugSession.workspaceFolder=e,d.LastDebugSession.debugConfig=Object.assign({},t),a.commands.executeCommand("setContext",u.HAS_LAST_DEBUG_CONFIG,!0),t})}installDependencies(e,t){return e!==_.FlutterWeb||new E.WebDev(t).promptToInstallIfRequired()}guessBestEntryPoint(e,t){if(T.isDartFile(e)&&(T.isTestFile(e)||T.isInsideFolderNamed(e,"bin")||T.isInsideFolderNamed(e,"tool")))return this.logger.info(`Using open file as entry point: ${e}`),e;const s=S.locateBestProjectRoot(e)||t;if(!s)return;const r=[o.join(s,"lib","main.dart"),o.join(s,"bin","main.dart")];for(const e of r)if(i.existsSync(e))return this.logger.info(`Using found common entry point: ${e}`),e}getFullVmServiceUri(e,t){return r(this,void 0,void 0,function*(){return(e=(e=e||(yield a.commands.executeCommand("dart.promptForVmService",t)))&&e.trim())&&/^[0-9]+$/.exec(e)&&(e=`http://127.0.0.1:${e}`),e})}getDebugServer(e,t){switch(e){case _.Flutter:return this.spawnOrGetServer("flutter",t,()=>new v.FlutterDebugSession);case _.FlutterTest:return this.spawnOrGetServer("flutterTest",t,()=>new b.FlutterTestDebugSession);case _.FlutterWeb:return this.spawnOrGetServer("flutterWeb",t,()=>new y.FlutterWebDebugSession);case _.FlutterWebTest:return this.spawnOrGetServer("pubTest",t,()=>new w.FlutterWebTestDebugSession);case _.Dart:return this.spawnOrGetServer("dart",t,()=>new f.DartDebugSession);case _.PubTest:return this.spawnOrGetServer("pubTest",t,()=>new m.DartTestDebugSession);default:throw new Error("Unknown debugger type")}}spawnOrGetServer(e,t=0,s){return this.debugServers[e]||(this.logger.info(`Spawning a new ${e} debugger`),this.debugServers[e]=n.createServer(e=>{const t=s();t.setRunAsServer(!0),t.start(e,e)}).listen(t)),this.debugServers[e]}setupDebugConfig(e,t,s,r){const i=g.config.for(e&&e.uri);t.name=t.name||"Dart & Flutter",t.type=t.type||"dart",t.request=t.request||"launch",t.cwd=t.cwd||e&&h.fsPath(e.uri),t.args=t.args||[],t.vmAdditionalArgs=t.vmAdditionalArgs||i.vmAdditionalArgs,t.vmServicePort=t.vmServicePort||(u.isChromeOS&&g.config.useKnownChromeOSPorts?u.CHROME_OS_VM_SERVICE_PORT:0),t.dartPath=t.dartPath||o.join(this.sdks.dart,u.dartVMPath),t.observatoryLogFile=t.observatoryLogFile||i.observatoryLogFile,t.webDaemonLogFile=t.webDaemonLogFile||i.webDaemonLogFile,t.maxLogLineLength=t.maxLogLineLength||g.config.maxLogLineLength,t.pubPath=t.pubPath||o.join(this.sdks.dart,u.pubPath),t.pubSnapshotPath=t.pubSnapshotPath||o.join(this.sdks.dart,u.pubSnapshotPath),t.pubTestLogFile=t.pubTestLogFile||i.pubTestLogFile,t.debugSdkLibraries=void 0!==t.debugSdkLibraries&&null!==t.debugSdkLibraries?t.debugSdkLibraries:!!i.debugSdkLibraries,t.debugExternalLibraries=void 0!==t.debugExternalLibraries&&null!==t.debugExternalLibraries?t.debugExternalLibraries:i.debugExternalLibraries,t.evaluateGettersInDebugViews=t.evaluateGettersInDebugViews||i.evaluateGettersInDebugViews,s&&(t.forceFlutterVerboseMode=p.isLogging||P,t.flutterAttachSupportsUris=this.flutterCapabilities.supportsUrisForFlutterAttach,t.flutterTrackWidgetCreation=void 0!==t.flutterTrackWidgetCreation&&null!==t.flutterTrackWidgetCreation?t.flutterTrackWidgetCreation:i.flutterTrackWidgetCreation,t.flutterMode=t.flutterMode||"debug",t.flutterPlatform=t.flutterPlatform||"default",t.flutterPath=t.flutterPath||(this.sdks.flutter?o.join(this.sdks.flutter,u.flutterPath):void 0),t.flutterRunLogFile=t.flutterRunLogFile||i.flutterRunLogFile,t.flutterTestLogFile=t.flutterTestLogFile||i.flutterTestLogFile,!t.deviceId&&r&&(t.deviceId=r.id,t.deviceName=`${r.name} (${r.platform})`),t.showMemoryUsage=t.showMemoryUsage||!1===t.showMemoryUsage?t.showMemoryUsage:"profile"===t.flutterMode)}dispose(){if(this.debugServers)for(const e of Object.keys(this.debugServers))this.debugServers[e].close(),delete this.debugServers[e]}},function(e){e[e.Dart=0]="Dart",e[e.PubTest=1]="PubTest",e[e.Flutter=2]="Flutter",e[e.FlutterTest=3]="FlutterTest",e[e.FlutterWeb=4]="FlutterWeb",e[e.FlutterWebTest=5]="FlutterWebTest"}(_=t.DebuggerType||(t.DebuggerType={}))},function(e,t){e.exports=require("net")},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(21),a=s(103),c=s(5),u=s(7),l=s(4),h=s(104),d=s(8),p=s(19),g=s(10),f=s(105),m=s(28),v=s(25),b=s(113),y=s(115),w=15,S="[Unoptimized] ",E=new RegExp("(.*#\\d+)(.*)\\(((?:package|dart|file):.*\\.dart):(\\d+):(\\d+)\\)\\s*$"),T=new RegExp("((?:package|dart|file):.*\\.dart) (\\d+):(\\d+)\\s*(\\S+)\\s*$");t.DartDebugSession=class extends o.DebugSession{constructor(){super(),this.additionalPidsToTerminate=[],this.allowTerminatingObservatoryVmPid=!0,this.connectVmEvenForNoDebug=!1,this.processExited=!1,this.sendStdOutToConsole=!0,this.supportsObservatory=!0,this.parseObservatoryUriFromStdOut=!0,this.requiresProgram=!0,this.processExit=Promise.resolve(),this.shouldKillProcessOnTerminate=!0,this.logCategory=u.LogCategory.General,this.logger=new m.DebugAdapterLogger(this,u.LogCategory.Observatory),this.capabilities=a.VmServiceCapabilities.empty,this.knownOpenFiles=[],this.requestCoverageUpdate=l.throttle(e=>r(this,void 0,void 0,function*(){if(!this.knownOpenFiles||!this.knownOpenFiles.length)return;const e=(yield this.getCoverageReport(this.knownOpenFiles)).map(e=>{const t=[e.startPos,e.endPos,...e.hits,...e.misses],s=[];return e.hits.forEach(r=>{const i=t.indexOf(r),n=i<t.length-1?i+1:i,o=this.resolveFileLocation(e.script,t[i]),a=this.resolveFileLocation(e.script,t[n]);for(let e=o.line;e<=a.line;e++)s.push(e)}),{hitLines:s,scriptPath:e.hostScriptPath}});this.sendEvent(new o.Event("dart.coverage",e))}),2e3),this.threadManager=new b.ThreadManager(this.logger,this)}get shouldConnectDebugger(){return!this.noDebug||this.connectVmEvenForNoDebug}initializeRequest(e,t){e.body=e.body||{},e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!0,e.body.supportsDelayedStackTraceLoading=!0,e.body.supportsConditionalBreakpoints=!0,e.body.supportsLogPoints=!0,e.body.supportsTerminateRequest=!0,e.body.exceptionBreakpointFilters=[{filter:"All",label:"All Exceptions",default:!1},{filter:"Unhandled",label:"Uncaught Exceptions",default:!0}],this.sendResponse(e)}launchRequest(e,t){if(!t||!t.dartPath||this.requiresProgram&&!t.program)return this.logToUser("Unable to restart debugging. Please try ending the debug session and starting again.\n"),void this.sendEvent(new o.TerminatedEvent);t.program&&!n.isAbsolute(t.program)&&(t.program=n.join(t.cwd,t.program)),this.shouldKillProcessOnTerminate=!0,this.cwd=t.cwd,this.noDebug=t.noDebug,this.threadManager.setExceptionPauseMode(this.noDebug?"None":"Unhandled"),this.packageMap=new v.PackageMap(v.PackageMap.findPackagesFile(t.program||t.cwd)),this.debugSdkLibraries=t.debugSdkLibraries,this.debugExternalLibraries=t.debugExternalLibraries,this.evaluateGettersInDebugViews=t.evaluateGettersInDebugViews,this.logFile=t.observatoryLogFile,this.maxLogLineLength=t.maxLogLineLength,this.sendResponse(e),this.childProcess=this.spawnProcess(t);const s=this.childProcess;this.processExited=!1,this.processExit=new Promise(e=>s.on("exit",e)),s.stdout.setEncoding("utf8"),s.stdout.on("data",e=>{let t=null;this.shouldConnectDebugger&&this.parseObservatoryUriFromStdOut&&!this.observatory&&(t=c.observatoryListeningBannerPattern.exec(e.toString())),t?this.initDebugger(this.websocketUriForObservatoryUri(t[1])):this.sendStdOutToConsole&&this.logToUser(e.toString(),"stdout")}),s.stderr.setEncoding("utf8"),s.stderr.on("data",e=>{this.logToUser(e.toString(),"stderr")}),s.on("error",e=>{this.logToUser(`${e}\n`,"stderr")}),s.on("exit",(e,t)=>{this.processExited=!0,this.log(`Process exited (${t?`${t}`.toLowerCase():e})`),e||t?this.logToUser(`Exited (${t?`${t}`.toLowerCase():e})\n`):this.logToUser("Exited\n"),this.sendEvent(new o.TerminatedEvent)}),this.shouldConnectDebugger||this.sendEvent(new o.InitializedEvent)}attachRequest(e,t){return r(this,void 0,void 0,function*(){if(!t||!t.observatoryUri)return this.errorResponse(e,"Unable to attach; no Observatory address provided.");if(this.shouldKillProcessOnTerminate=!1,this.cwd=t.cwd,this.debugSdkLibraries=t.debugSdkLibraries,this.debugExternalLibraries=t.debugExternalLibraries,this.logFile=t.observatoryLogFile,this.log(`Attaching to process via ${t.observatoryUri}`),t.packages){t.packages&&!n.isAbsolute(t.packages)&&(t.packages=n.join(t.cwd,t.packages));try{this.packageMap=new v.PackageMap(v.PackageMap.findPackagesFile(t.packages))}catch(t){this.errorResponse(e,`Unable to load packages file: ${t}`)}}try{yield this.initDebugger(this.websocketUriForObservatoryUri(t.observatoryUri)),this.sendResponse(e)}catch(t){this.errorResponse(e,`Unable to connect to Observatory: ${t}`)}})}sourceFileForArgs(e){return n.relative(e.cwd,e.program)}spawnProcess(e){let t=[];this.shouldConnectDebugger&&(t.push(`--enable-vm-service=${e.vmServicePort}`),t.push("--pause_isolates_on_start=true")),!1!==e.enableAsserts&&t.push("--enable-asserts"),e.vmAdditionalArgs&&(t=t.concat(e.vmAdditionalArgs)),t.push(this.sourceFileForArgs(e)),e.args&&(t=t.concat(e.args)),this.log(`Spawning ${e.dartPath} with args ${JSON.stringify(t)}`),e.cwd&&this.log(`..  in ${e.cwd}`);const s=g.safeSpawn(e.cwd,e.dartPath,t,e.env);return this.log(`    PID: ${s.pid}`),s}websocketUriForObservatoryUri(e){const t=e.trim();return t.endsWith("/ws")?t:t.endsWith("/ws/")?t.substr(0,t.length-1):t.endsWith("/")?`${t}ws`:`${t}/ws`}log(e,t=u.LogSeverity.Info){this.logFile&&(this.logStream||(this.logStream=i.createWriteStream(this.logFile),this.logStream.write(p.getLogHeader())),this.logStream.write(`[${(new Date).toLocaleTimeString()}]: `),this.maxLogLineLength&&e.length>this.maxLogLineLength?this.logStream.write(e.substring(0,this.maxLogLineLength)+"…\r\n"):this.logStream.write(e.trim()+"\r\n")),this.sendEvent(new o.Event("dart.log",{message:e,severity:t,category:u.LogCategory.Observatory}))}initDebugger(e){let t;if(e.endsWith("/ws")?(t=e.substring(0,e.length-2)).startsWith("ws:")&&(t="http:"+t.substring(3)):t=e,this.sendEvent(new o.Event("dart.debuggerUris",{observatoryUri:this.supportsObservatory?t.toString():void 0,vmServiceUri:t.toString()})),this.shouldConnectDebugger)return new Promise((t,s)=>{this.log(`Connecting to VM Service at ${e}`),this.observatory=new f.ObservatoryConnection(e),this.observatory.onLogging(e=>this.log(e)),this.observatory.onOpen(()=>{this.observatory&&(this.observatory.getVersion().then(e=>{const t=e.result;this.capabilities.version=`${t.major}.${t.minor}.0`,this.observatory.getVM().then(e=>r(this,void 0,void 0,function*(){if(!this.observatory)return;const t=e.result;this.subscribeToStreams(),this.allowTerminatingObservatoryVmPid&&this.childProcess&&this.childProcess.pid!==t.pid&&this.additionalPidsToTerminate.push(t.pid);const s=yield Promise.all(t.isolates.map(e=>this.observatory.getIsolate(e.id))),i=s.find(e=>!!e.result.rootLib),n=i&&i.result;n&&n.extensionRPCs&&n.extensionRPCs.forEach(e=>this.notifyServiceExtensionAvailable(e,n.id)),this.packageMap||n&&(this.packageMap=new v.PackageMap(v.PackageMap.findPackagesFile(this.convertVMUriToSourcePath(n.rootLib.uri)))),yield Promise.all(s.map(e=>r(this,void 0,void 0,function*(){const t=e.result;this.threadManager.registerThread(t,t.runnable?"IsolateRunnable":"IsolateStart"),t.pauseEvent.kind.startsWith("Pause")&&(yield this.handlePauseEvent(t.pauseEvent))}))),this.pollforMemoryMs&&setTimeout(()=>this.pollForMemoryUsage(),this.pollforMemoryMs),this.sendEvent(new o.InitializedEvent)}))}),t())}),this.observatory.onClose((e,t)=>{this.log(`Observatory connection closed: ${e} (${t})`),this.logStream&&(this.logStream.end(),this.logStream=void 0,this.logFile=void 0),this.childProcess?setTimeout(()=>{this.processExited||this.sendEvent(new o.TerminatedEvent)},500):this.sendEvent(new o.TerminatedEvent)}),this.observatory.onError(e=>{s(e)})})}subscribeToStreams(){this.observatory.on("Isolate",e=>this.handleIsolateEvent(e)),this.observatory.on("Extension",e=>this.handleExtensionEvent(e)),this.observatory.on("Debug",e=>this.handleDebugEvent(e));const e=this.capabilities.serviceStreamIsPublic?"Service":"_Service";this.observatory.on(e,e=>this.handleServiceEvent(e))}terminate(e){return r(this,void 0,void 0,function*(){const t=e?"SIGKILL":"SIGINT",s=e?"DISC":"TERM";if(this.log(`${s}: Going to terminate with ${t}...`),this.shouldKillProcessOnTerminate&&this.childProcess&&!this.processExited){for(const e of this.additionalPidsToTerminate)try{this.log(`${s}: Terminating related process ${e} with ${t}...`),process.kill(e,t)}catch(e){}try{this.log(`${s}: Terminating main process with ${t}...`),this.childProcess.kill(t)}catch(e){}}else if(!this.shouldKillProcessOnTerminate&&this.observatory){try{this.log(`${s}: Disconnecting from process...`),yield yield Promise.race([Promise.all(this.threadManager.threads.map(e=>e.removeAllBreakpoints())),new Promise(e=>setTimeout(e,500))]),this.log(`${s}: Unpausing all threads...`),yield Promise.race([Promise.all(this.threadManager.threads.map(e=>e.resume())),new Promise(e=>setTimeout(e,500))])}catch(e){}try{this.log(`${s}: Closing observatory...`),this.observatory.close()}catch(e){}finally{this.observatory=void 0}}this.log(`${s}: Removing all stored data...`),this.threadManager.removeAllStoredData(),this.log(`${s}: Waiting for process to finish...`),yield this.processExit,this.log(`${s}: Disconnecting...`)})}terminateRequest(e,t){const s=Object.create(null,{terminateRequest:{get:()=>super.terminateRequest}});return r(this,void 0,void 0,function*(){this.log("Termination requested!");try{yield this.terminate(!1)}catch(t){return this.errorResponse(e,`${t}`)}s.terminateRequest.call(this,e,t)})}disconnectRequest(e,t){const s=Object.create(null,{disconnectRequest:{get:()=>super.disconnectRequest}});return r(this,void 0,void 0,function*(){this.log("Disconnect requested!");try{(yield Promise.race([this.terminate(!1).then(e=>!1),new Promise(e=>setTimeout(()=>e(!0),2e3))]))&&(yield this.terminate(!0))}catch(t){return this.errorResponse(e,`${t}`)}s.disconnectRequest.call(this,e,t)})}setBreakPointsRequest(e,t){return r(this,void 0,void 0,function*(){if(this.noDebug)return e.body={breakpoints:t.breakpoints.map(e=>({verified:!1}))},void this.sendResponse(e);const s=t.source;let r=t.breakpoints;r||(r=[]);const i=this.packageMap&&this.packageMap.convertFileToPackageUri(s.path)||y.formatPathForVm(s.path||s.name);try{const t=yield this.threadManager.setBreakpoints(i,r),s=[];for(const e of t)s.push({verified:!!e});e.body={breakpoints:s},this.sendResponse(e)}catch(t){this.errorResponse(e,`${t}`)}})}setExceptionBreakPointsRequest(e,t){const s=t.filters;let r="None";this.noDebug||(-1!==s.indexOf("Unhandled")&&(r="Unhandled"),-1!==s.indexOf("All")&&(r="All")),this.threadManager.setExceptionPauseMode(r),this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e),this.threadManager.receivedConfigurationDone()}pauseRequest(e,t){const s=this.threadManager.getThreadInfoFromNumber(t.threadId);s?this.observatory.pause(s.ref.id).then(t=>this.sendResponse(e)).catch(t=>this.errorResponse(e,`${t}`)):this.errorResponse(e,`No thread with id ${t.threadId}`)}sourceRequest(e,t){const s=t.sourceReference,r=this.threadManager.getStoredData(s),i=r.data;r.thread.getScript(i).then(t=>{t.source?e.body={content:t.source}:(e.success=!1,e.message="<source not available>"),this.sendResponse(e)}).catch(t=>this.errorResponse(e,`${t}`))}threadsRequest(e){e.body={threads:this.threadManager.getThreads()},this.sendResponse(e)}stackTraceRequest(e,t){const s=this.threadManager.getThreadInfoFromNumber(t.threadId);let r=t.startFrame,n=t.levels;s?this.observatory.getStack(s.ref.id).then(t=>{const a=t.result;let c=a.asyncCausalFrames;c||(c=a.frames);const u=c.length;r||(r=0),n||(n=u),r+n>u&&(n=u-r),c=c.slice(r,r+n);const l=[],h=[];c.forEach(e=>{const t=s.storeData(e);if("AsyncSuspensionMarker"===e.kind){const e=new o.StackFrame(t,"<asynchronous gap>");return e.presentationHint="label",void l.push(e)}const r=e&&e.code&&e.code.name?e.code.name.startsWith(S)?e.code.name.substring(S.length):e.code.name:"<unknown>",n=e.location;if(!n){const e=new o.StackFrame(t,r);return e.presentationHint="subtle",void l.push(e)}const a=n.script.uri;let c,u=this.convertVMUriToSourcePath(a),d=u&&i.existsSync(u);a.startsWith("dart:")&&(u=void 0,c=s.storeData(n.script),d=!0);const p=this.formatUriForShortDisplay(a),g=new o.StackFrame(t,r,d?new o.Source(p,u,c,void 0,n.script):void 0,0,0),f=0===l.length,m=0!==s.exceptionReference,v=!f||m;g.source&&v&&(!this.isValidToDebug(a)||this.isSdkLibrary(a)&&!this.debugSdkLibraries?(g.source.origin="from the Dart SDK",g.source.presentationHint="deemphasize"):this.isExternalLibrary(a)&&!this.debugExternalLibraries&&(g.source.origin=a.startsWith("package:flutter/")?"from the Flutter framework":"from Pub packages",g.source.presentationHint="deemphasize")),l.push(g);const b=s.getScript(n.script).then(e=>{const t=this.resolveFileLocation(e,n.tokenPos);t&&(g.line=t.line,g.column=t.column)});h.push(b)}),e.body={stackFrames:l,totalFrames:u},Promise.all(h).then(t=>{this.sendResponse(e)}).catch(t=>{this.sendResponse(e)})}).catch(t=>this.errorResponse(e,`${t}`)):this.errorResponse(e,`No thread with id ${t.threadId}`)}scopesRequest(e,t){const s=t.frameId,r=this.threadManager.getStoredData(s),i=r.data,n=r.thread.storeData(i),a=[];r.thread.exceptionReference&&a.push(new o.Scope("Exception",r.thread.exceptionReference)),a.push(new o.Scope("Locals",n)),e.body={scopes:a},this.sendResponse(e)}variablesRequest(e,t){return r(this,void 0,void 0,function*(){const s=t.variablesReference;let r=t.start;const i=t.count,n=this.threadManager.getStoredData(s),o=n.thread;if("Frame"===n.data.type){const t=n.data,s=[];if(t.vars)for(const e of t.vars)e.value&&"@TypeArguments"===e.value.type||s.push(yield this.instanceRefToVariable(o,!0,e.name,e.name,e.value,t.vars.length<=w));e.body={variables:s},this.sendResponse(e)}else if("MapEntry"===n.data.type){const t=n.data,s=yield Promise.all([this.observatory.getObject(o.ref.id,t.keyId),this.observatory.getObject(o.ref.id,t.valueId)]),r=[],[i,a]=s,c=i.result,u=a.result;r.push(yield this.instanceRefToVariable(o,!1,"key","key",c,!0));let l=!1,h="value";this.isSimpleKind(c.kind)&&(l=!0,h=`${t.mapEvaluateName}[${this.valueAsString(c)}]`),r.push(yield this.instanceRefToVariable(o,l,h,"value",u,!0)),e.body={variables:r},this.sendResponse(e)}else{const t=n.data;try{const s=yield this.observatory.getObject(o.ref.id,t.id,r,i),n=[],a=void 0!==t.evaluateName;if("Sentinel"===s.result.type)n.push({name:"<evalError>",value:s.result.valueAsString,variablesReference:0});else{const e=s.result;if("Instance"===e.type){const s=e;if(this.isSimpleKind(s.kind))n.push(yield this.instanceRefToVariable(o,a,`${t.evaluateName}`,s.kind,t,!0));else if(s.elements){const e=s.elements.length;r||(r=0);for(let i=0;i<e;i++){const c=s.elements[i];n.push(yield this.instanceRefToVariable(o,a,`${t.evaluateName}[${i+r}]`,`[${i+r}]`,c,e<=w))}}else if(s.associations){const e=s.associations.length;r||(r=0);for(let i=0;i<e;i++){const e=s.associations[i],a=this.valueAsString(e.key,!0),c=this.valueAsString(e.value,!0);let u=0;if("Sentinel"!==e.key.type&&"Sentinel"!==e.value.type){const s={keyId:e.key.id,mapEvaluateName:t.evaluateName,type:"MapEntry",valueId:e.value.id};u=o.storeData(s)}n.push({name:`${i+r}`,type:`${a} -> ${c}`,value:`${a} -> ${c}`,variablesReference:u})}}else if(s.fields){let e=s.fields.length;if(this.evaluateGettersInDebugViews&&s.class){let r=yield this.getGetterNamesForHierarchy(o.ref,s.class);e+=(r=r.sort()).length;for(const s of r){const r=s,i=yield this.observatory.evaluate(o.ref.id,t.id,s,!0);if("@Error"===i.result.type)n.push({name:r,value:i.result.message,variablesReference:0});else if("Sentinel"===i.result.type)n.push({name:r,value:i.result.valueAsString,variablesReference:0});else{const c=i.result;n.push(yield this.instanceRefToVariable(o,a,`${t.evaluateName}.${s}`,r,c,e<=w))}}}for(const r of s.fields)n.push(yield this.instanceRefToVariable(o,a,`${t.evaluateName}.${r.decl.name}`,r.decl.name,r.value,e<=w))}else this.logToUser(`Unknown instance kind: ${s.kind}. ${c.pleaseReportBug}\n`)}else this.logToUser(`Unknown object type: ${e.type}. ${c.pleaseReportBug}\n`)}e.body={variables:n},this.sendResponse(e)}catch(t){this.errorResponse(e,`${t}`)}}})}getGetterNamesForHierarchy(e,t){return r(this,void 0,void 0,function*(){let s=[];for(;t;){const r=yield this.observatory.getObject(e.id,t.id);if("Class"!==r.result.type)break;const i=r.result;s=s.concat(s,i.functions.filter(e=>"GetterFunction"===e._kind&&!e.static&&!e.const).map(e=>e.name)),t=i.super}return(s=l.uniq(s)).filter(e=>"_identityHashCode"!==e)})}isSimpleKind(e){return"String"===e||"Bool"===e||"Int"===e||"Num"===e||"Double"===e||"Null"===e}callToString(e,t,s=!1){return r(this,void 0,void 0,function*(){try{const r=yield this.observatory.evaluate(e.id,t.id,"toString()",!0);if("@Error"===r.result.type)return;{let t=r.result;return t.valueAsStringIsTruncated&&s&&(t=(yield this.observatory.getObject(e.id,t.id)).result),this.valueAsString(t,void 0,!0)}}catch(e){return void this.logger.error(e,u.LogCategory.Observatory)}})}setVariableRequest(e,t){this.errorResponse(e,"not supported")}continueRequest(e,t){const s=this.threadManager.getThreadInfoFromNumber(t.threadId);s?s.resume().then(t=>{e.body={allThreadsContinued:!1},this.sendResponse(e),this.requestCoverageUpdate("resume")}).catch(t=>this.errorResponse(e,`${t}`)):this.errorResponse(e,`No thread with id ${t.threadId}`)}nextRequest(e,t){const s=this.threadManager.getThreadInfoFromNumber(t.threadId);if(!s)return void this.errorResponse(e,`No thread with id ${t.threadId}`);const r=s.atAsyncSuspension?"OverAsyncSuspension":"Over";s.resume(r).then(t=>{this.sendResponse(e),this.requestCoverageUpdate("step-over")}).catch(t=>this.errorResponse(e,`${t}`))}stepInRequest(e,t){const s=this.threadManager.getThreadInfoFromNumber(t.threadId);s?s.resume("Into").then(t=>{this.sendResponse(e),this.requestCoverageUpdate("step-in")}).catch(t=>this.errorResponse(e,`${t}`)):this.errorResponse(e,`No thread with id ${t.threadId}`)}stepOutRequest(e,t){const s=this.threadManager.getThreadInfoFromNumber(t.threadId);s?s.resume("Out").then(t=>{this.sendResponse(e),this.requestCoverageUpdate("step-out")}).catch(t=>this.errorResponse(e,`${t}`)):this.errorResponse(e,`No thread with id ${t.threadId}`)}stepBackRequest(e,t){}evaluateRequest(e,t){return r(this,void 0,void 0,function*(){const s=t.expression,r=t.frameId;if(!r)return void this.errorResponse(e,"global evaluation not supported");const i=this.threadManager.getStoredData(r),n=i.thread,o=i.data;try{let t;if(("$e"===s||s.startsWith("$e."))&&n.exceptionReference){const r=this.threadManager.getStoredData(n.exceptionReference),i=r&&r.data;if("$e"===s)return e.body={result:yield this.fullValueAsString(n.ref,i),variablesReference:n.exceptionReference},void this.sendResponse(e);const o=i&&i.id;o&&(t=yield this.observatory.evaluate(n.ref.id,o,s.substr(3),!0))}if(t||(t=yield Promise.race([this.observatory.evaluateInFrame(n.ref.id,o.index,s,!0),new Promise((e,t)=>setTimeout(()=>t(new Error("<timed out>")),500))])),"@Error"===t.result.type){let s=t.result.message;s&&(s=s.split("\n").slice(0,6).join("\n")),this.errorResponse(e,s)}else{const r=t.result;r.evaluateName=s;const i=yield this.fullValueAsString(n.ref,r);e.body={result:i,variablesReference:this.isSimpleKind(r.kind)?0:n.storeData(r)},this.sendResponse(e)}}catch(t){this.errorResponse(e,`${t}`)}})}customRequest(e,t,s){const i=Object.create(null,{customRequest:{get:()=>super.customRequest}});return r(this,void 0,void 0,function*(){switch(e){case"coverageFilesUpdate":this.knownOpenFiles=s.scriptUris,this.sendResponse(t);break;case"requestCoverageUpdate":this.requestCoverageUpdate("editor"),this.sendResponse(t);break;case"service":try{yield this.callService(s.type,s.params),this.sendResponse(t)}catch(e){this.errorResponse(t,e&&e.message)}break;case"serviceExtension":case"checkPlatformOverride":case"checkIsWidgetCreationTracked":case"hotReload":case"hotRestart":this.log(`Ignoring Flutter customRequest ${e} for non-Flutter-run app`,u.LogSeverity.Warn),this.sendResponse(t);break;default:this.log(`Unknown customRequest ${e}`,u.LogSeverity.Warn),i.customRequest.call(this,e,t,s)}})}handleIsolateEvent(e){const t=e.kind;"IsolateStart"===t||"IsolateRunnable"===t?this.threadManager.registerThread(e.isolate,t):"IsolateExit"===t?this.threadManager.handleIsolateExit(e.isolate):"ServiceExtensionAdded"===t&&this.handleServiceExtensionAdded(e)}handleExtensionEvent(e){}handleServiceEvent(e){"ServiceRegistered"===e.kind&&this.handleServiceRegistered(e)}handleDebugEvent(e){return r(this,void 0,void 0,function*(){try{const t=e.kind;t.startsWith("Pause")?yield this.handlePauseEvent(e):"Inspect"===t&&(yield this.handleInspectEvent(e))}catch(e){this.logger.error(e,u.LogCategory.Observatory)}})}handlePauseEvent(e){return r(this,void 0,void 0,function*(){const t=e.kind,s=e.isolate?this.threadManager.getThreadInfoFromRef(e.isolate):void 0;if(e.isolate&&s)if(this.observatory)if("PausePostRequest"===t){try{yield this.threadManager.resetBreakpoints()}catch(e){this.logger.error(e,u.LogCategory.Observatory)}try{yield this.observatory.resume(e.isolate.id)}catch(e){if(106!==e.code)throw e}}else if("PauseStart"===t)this.childProcess?s.receivedPauseStart():(s.handlePaused(e.atAsyncSuspension,e.exception),yield s.resume("Into"));else{let r,i="pause",n=!0;if("PauseBreakpoint"===t&&e.pauseBreakpoints&&e.pauseBreakpoints.length){i="breakpoint";const t=e.pauseBreakpoints.map(e=>s.breakpoints[e.id]);if(-1===t.indexOf(void 0)){const e=!!t.find(e=>!e.condition&&!e.logMessage),r=t.filter(e=>e.condition),i=t.filter(e=>e.logMessage);n=e||(yield this.anyBreakpointConditionReturnsTrue(r,s));for(const e of i){const t=`print("""${e.logMessage.replace(/(^|[^\\\$]){/g,"$1${").replace(/\\({)/g,"$1").replace(/"""/g,'\\"\\"\\"')}""")`;yield this.evaluateAndSendErrors(s,t)}}}else"PauseBreakpoint"===t?i="step":"PauseException"===t&&(i="exception",r=yield this.fullValueAsString(e.isolate,e.exception));s.handlePaused(e.atAsyncSuspension,e.exception),n?this.sendEvent(new o.StoppedEvent(i,s.num,r)):s.resume()}else this.logger.warn("No observatory connection");else this.logger.warn("No thread for pause event")})}handleInspectEvent(e){return r(this,void 0,void 0,function*(){})}fullValueAsString(e,t){return r(this,void 0,void 0,function*(){let s;return t.valueAsStringIsTruncated||(s=this.valueAsString(t,!1)),s||(s=yield this.callToString(e,t,!0)),"PlainInstance"===t.kind&&t.class&&t.class.name&&(s=s===`Instance of '${t.class.name}'`?t.class.name:`${t.class.name} (${s})`),s})}anyBreakpointConditionReturnsTrue(e,t){return r(this,void 0,void 0,function*(){for(const s of e){const e=yield this.evaluateAndSendErrors(t,s.condition);if(e&&("Bool"===e.kind&&"true"===e.valueAsString||"Int"===e.kind&&"0"!==e.valueAsString))return!0}return!1})}callService(e,t){return this.observatory.callMethod(e,t)}evaluateAndSendErrors(e,t){return r(this,void 0,void 0,function*(){try{const s=yield this.observatory.evaluateInFrame(e.ref.id,0,t,!0);if("@Error"!==s.result.type)return s.result;this.logToUser(`Debugger failed to evaluate expression \`${t}\`\n`)}catch(e){this.logToUser(`Debugger failed to evaluate expression \`${t}\`\n`)}})}handleServiceExtensionAdded(e){e&&e.extensionRPC&&this.notifyServiceExtensionAvailable(e.extensionRPC,e.isolate?e.isolate.id:void 0)}handleServiceRegistered(e){e&&e.service&&this.notifyServiceRegistered(e.service,e.method)}notifyServiceExtensionAvailable(e,t){this.sendEvent(new o.Event("dart.serviceExtensionAdded",{id:e,isolateId:t}))}notifyServiceRegistered(e,t){this.sendEvent(new o.Event("dart.serviceRegistered",{service:e,method:t}))}getCoverageReport(e){return r(this,void 0,void 0,function*(){if(!e||!e.length)return[];const t=(yield this.observatory.getVM()).result.isolates.map(e=>this.observatory.getIsolate(e.id)),s=(yield Promise.all(t)).map(e=>e.result),r={};e.forEach(e=>r[e]=!0);const i=[];for(const e of s){const t=e.libraries.map(t=>this.observatory.getObject(e.id,t.id)),s=(yield Promise.all(t)).map(e=>e.result),n=l.flatMap(s,e=>e.scripts).filter(e=>r[e.uri]);for(const t of n){const s=(yield this.observatory.getObject(e.id,t.id)).result;try{const r=(yield this.observatory.getSourceReport(e,[f.SourceReportKind.Coverage],t)).result.ranges.filter(e=>e.coverage&&e.coverage.hits&&e.coverage.hits.length);for(const e of r)i.push({endPos:e.endPos,hits:e.coverage.hits,hostScriptPath:l.uriToFilePath(s.uri),misses:e.coverage.misses,script:s,startPos:e.startPos,tokenPosTable:s.tokenPosTable})}catch(e){this.logger.error(e,u.LogCategory.Observatory)}}}return i})}errorResponse(e,t){e.success=!1,e.message=t,this.sendResponse(e)}formatUriForShortDisplay(e){e.startsWith("file:")&&(e=l.uriToFilePath(e),this.cwd&&(e=n.relative(this.cwd,e)));const t=-1===e.indexOf("/")&&-1!==e.indexOf("\\")?"\\":"/",s=e.split(t);return s.length>3?[s[0],"…",s[s.length-2],s[s.length-1]].join(t):e}convertVMUriToSourcePath(e,t){return e.startsWith("file:")?l.uriToFilePath(e,t):e.startsWith("package:")&&this.packageMap?this.packageMap.resolvePackageUri(e):e}valueAsString(e,t=!0,s=!1){if("Sentinel"===e.type)return e.valueAsString;const r=e;if("String"===e.kind||e.valueAsString){let e=r.valueAsString;return r.valueAsStringIsTruncated&&(e+="…"),"String"!==r.kind||s||(e=`"${e}"`),e}return"List"===e.kind?`List (${r.length} ${1===r.length?"item":"items"})`:"Map"===e.kind?`Map (${r.length} ${1===r.length?"item":"items"})`:"Type"===e.kind?`Type (${e.name})`:t?this.getFriendlyTypeName(r):void 0}getFriendlyTypeName(e){return"PlainInstance"!==e.kind?e.kind:e.class.name}instanceRefToVariable(e,t,s,i,n,o){return r(this,void 0,void 0,function*(){if("Sentinel"===n.type)return{name:i,value:n.valueAsString,variablesReference:0};{const r=n;r.evaluateName=t?s:void 0;const a=d.config.previewToStringInDebugViews&&o&&!r.valueAsString?yield this.fullValueAsString(e.ref,r):this.valueAsString(r);return{evaluateName:t?s:void 0,indexedVariables:r&&r.kind&&r.kind.endsWith("List")?r.length:void 0,name:i,type:`${r.kind} (${r.class.name})`,value:a||"",variablesReference:r.valueAsString?0:e.storeData(r)}}})}isValidToDebug(e){return!e.startsWith("dart:_")}isSdkLibrary(e){return e.startsWith("dart:")}isExternalLibrary(e){if(!e.startsWith("package:")||!this.packageMap)return!1;if(e.startsWith("package:flutter/"))return!0;const t=this.packageMap.resolvePackageUri(e);return!!t&&(-1!==t.indexOf("/hosted/pub.dartlang.org/")||-1!==t.indexOf("\\hosted\\pub.dartlang.org\\"))}resolveFileLocation(e,t){const s=e.tokenPosTable;for(const e of s)for(let s=1;s<e.length;s+=2)if(e[s]===t)return{line:e[0],column:e[s+1]}}pollForMemoryUsage(){return r(this,void 0,void 0,function*(){if(!this.childProcess||this.childProcess.killed)return;const e=(yield this.observatory.getVM()).result.isolates.map(e=>this.observatory.getIsolate(e.id)),t=(yield Promise.all(e)).map(e=>e.result);let s=0,r=0;for(const e of t)for(const t of[e._heaps.old,e._heaps.new])s+=t.used+t.external,r+=t.capacity+t.external;this.sendEvent(new o.Event("dart.debugMetrics",{memory:{current:s,total:r}})),setTimeout(()=>this.pollForMemoryUsage(),this.pollforMemoryMs)})}getStackFrameData(e){const t=e&&E.exec(e);if(t)return{col:parseInt(t[5],10),functionName:t[2],line:parseInt(t[4],10),prefix:t[1],sourceUri:t[3]}}getWebStackFrameData(e){const t=e&&T.exec(e);if(t)return{col:parseInt(t[3],10),functionName:t[4],line:parseInt(t[2],10),sourceUri:t[1]}}logToUser(e,t){const s=this.getStackFrameData(e)||this.getWebStackFrameData(e),r=-1!==e.trimRight().indexOf("\n");if(s&&r)return void e.split("\n").forEach(e=>this.logToUser(`${e}\n`,t));const n=new o.OutputEvent(`${e}`,t);if(s){const e=this.convertVMUriToSourcePath(s.sourceUri),t=e&&e!==s.sourceUri&&i.existsSync(e),r=this.formatUriForShortDisplay(s.sourceUri),a=t?new o.Source(r,e,void 0,void 0,void 0):void 0;let c=`${s.functionName} (${s.sourceUri}:${s.line}:${s.col})`;a&&(n.body.source=a,n.body.line=s.line,n.body.column=s.col,c=s.functionName);const u=this.isSdkLibrary(s.sourceUri)||this.isExternalLibrary(s.sourceUri)&&s.sourceUri.startsWith("package:flutter/")||this.isExternalLibrary(s.sourceUri)&&s.sourceUri.startsWith("package:flutter_web/")?h.white(c):c;n.body.output=`${s.prefix||""}${u}\n`}this.sendEvent(n)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(99),i=s(40),n=s(37),o=s(41);t.Source=class{constructor(e,t,s=0,r,i){this.name=e,this.path=t,this.sourceReference=s,r&&(this.origin=r),i&&(this.adapterData=i)}};t.Scope=class{constructor(e,t,s=!1){this.name=e,this.variablesReference=t,this.expensive=s}};t.StackFrame=class{constructor(e,t,s,r=0,i=0){this.id=e,this.source=s,this.line=r,this.column=i,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,s=0,r,i){this.name=e,this.value=t,this.variablesReference=s,"number"==typeof i&&(this.namedVariables=i),"number"==typeof r&&(this.indexedVariables=r)}};t.Breakpoint=class{constructor(e,t,s,r){this.verified=e;const i=this;"number"==typeof t&&(i.line=t),"number"==typeof s&&(i.column=s),r&&(i.source=r)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,s=0){this.label=e,this.start=t,this.length=s}};t.StoppedEvent=class extends i.Event{constructor(e,t,s){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof s&&(this.body.text=s)}};t.ContinuedEvent=class extends i.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}};t.InitializedEvent=class extends i.Event{constructor(){super("initialized")}};t.TerminatedEvent=class extends i.Event{constructor(e){super("terminated"),("boolean"==typeof e||e)&&(this.body={restart:e})}};t.OutputEvent=class extends i.Event{constructor(e,t="console",s){super("output"),this.body={category:t,output:e},void 0!==s&&(this.body.data=s)}};t.ThreadEvent=class extends i.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}};t.BreakpointEvent=class extends i.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}};t.ModuleEvent=class extends i.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}};t.LoadedSourceEvent=class extends i.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}};var a;t.CapabilitiesEvent=class extends i.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}},function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(a=t.ErrorDestination||(t.ErrorDestination={}));class c extends r.ProtocolServer{constructor(e,t){super();const s="boolean"==typeof e&&e;this._debuggerLinesStartAt1=s,this._debuggerColumnsStartAt1=s,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",()=>{this.shutdown()}),this.on("error",e=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){let t=0;if(process.argv.slice(2).forEach(function(e,s,r){const i=/^--server=(\d{4,5})$/.exec(e);i&&(t=parseInt(i[1],10))}),t>0)console.error(`waiting for debug protocol on port ${t}`),n.createServer(t=>{console.error(">> accepted connection from client"),t.on("end",()=>{console.error(">> client connection closed\n")});const s=new e(!1,!0);s.setRunAsServer(!0),s.start(t,t)}).listen(t);else{const t=new e(!1);process.on("SIGTERM",()=>{t.shutdown()}),t.start(process.stdin,process.stdout)}}shutdown(){this._isServer||setTimeout(()=>{process.exit(0)},100)}sendErrorResponse(e,t,s,r,i=a.User){let n;"number"==typeof t?(n={id:t,format:s},r&&(n.variables=r),i&a.User&&(n.showUser=!0),i&a.Telemetry&&(n.sendTelemetry=!0)):n=t,e.success=!1,e.message=c.formatPII(n.format,!0,n.variables),e.body||(e.body={}),e.body.error=n,this.sendResponse(e)}runInTerminalRequest(e,t,s){this.sendRequest("runInTerminal",e,t,s)}dispatchRequest(e){const t=new i.Response(e);try{if("initialize"===e.command){var s=e.arguments;if("boolean"==typeof s.linesStartAt1&&(this._clientLinesStartAt1=s.linesStartAt1),"boolean"==typeof s.columnsStartAt1&&(this._clientColumnsStartAt1=s.columnsStartAt1),"path"!==s.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,a.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,s)}}else"launch"===e.command?this.launchRequest(t,e.arguments):"attach"===e.command?this.attachRequest(t,e.arguments):"disconnect"===e.command?this.disconnectRequest(t,e.arguments):"terminate"===e.command?this.terminateRequest(t,e.arguments):"restart"===e.command?this.restartRequest(t,e.arguments):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments):"continue"===e.command?this.continueRequest(t,e.arguments):"next"===e.command?this.nextRequest(t,e.arguments):"stepIn"===e.command?this.stepInRequest(t,e.arguments):"stepOut"===e.command?this.stepOutRequest(t,e.arguments):"stepBack"===e.command?this.stepBackRequest(t,e.arguments):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments):"goto"===e.command?this.gotoRequest(t,e.arguments):"pause"===e.command?this.pauseRequest(t,e.arguments):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments):"scopes"===e.command?this.scopesRequest(t,e.arguments):"variables"===e.command?this.variablesRequest(t,e.arguments):"setVariable"===e.command?this.setVariableRequest(t,e.arguments):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments):"source"===e.command?this.sourceRequest(t,e.arguments):"threads"===e.command?this.threadsRequest(t):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments):"evaluate"===e.command?this.evaluateRequest(t,e.arguments):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments):"completions"===e.command?this.completionsRequest(t,e.arguments):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments):this.customRequest(e.command,t,e.arguments)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},a.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}terminateRequest(e,t){this.sendResponse(e)}restartRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}reverseContinueRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}terminateThreadsRequest(e,t){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}setExpressionRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}exceptionInfoRequest(e,t){this.sendResponse(e)}loadedSourcesRequest(e,t){this.sendResponse(e)}dataBreakpointInfoRequest(e,t){this.sendResponse(e)}setDataBreakpointsRequest(e,t){this.sendResponse(e)}customRequest(e,t,s){this.sendErrorResponse(t,1014,"unrecognized request",null,a.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?c.uri2path(e):c.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?c.uri2path(e):c.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new o.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new o.URL(e),s=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(s)&&(s=s[1].toLowerCase()+s.substr(2)),s=s.replace(/\//g,"\\")),s}static formatPII(e,t,s){return e.replace(c._formatPIIRegexp,function(e,r){return t&&r.length>0&&"_"!==r[0]?e:s[r]&&s.hasOwnProperty(r)?s[r]:e})}}c._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.seq=0,this.type=e}}t.Message=r;t.Response=class extends r{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};t.Event=class extends r{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("crypto")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(21),n=s(5),o=s(7),a=s(38),c=s(28),u=s(116),l="✓",h="✖";t.DartTestDebugSession=class extends a.DartDebugSession{constructor(){super(),this.suitePaths=[],this.tests=[],this.sendStdOutToConsole=!1,this.requiresProgram=!1}spawnProcess(e){let t=[];this.shouldConnectDebugger&&(t.push("--enable-vm-service=0"),t.push("--pause_isolates_on_start=true")),e.vmAdditionalArgs&&(t=t.concat(e.vmAdditionalArgs)),t.push(e.pubSnapshotPath),(t=t.concat(["run","test","-r","json"])).push("-j1"),e.program&&t.push(this.sourceFileForArgs(e)),e.args&&(t=t.concat(e.args));const s=new c.DebugAdapterLogger(this,o.LogCategory.PubTest);return this.createRunner(e.dartPath,e.cwd,e.program,t,e.env,e.pubTestLogFile,s,e.maxLogLineLength)}createRunner(e,t,s,r,i,n,o,a){const c=new u.TestRunner(e,t,r,i,n,o,a);return c.registerForUnhandledMessages(e=>this.logToUserIfAppropriate(e,"stdout")),c.registerForTestStartedProcess(e=>this.initDebugger(`${e.observatoryUri}ws`)),c.registerForAllTestNotifications(e=>{try{this.handleTestEvent(e)}catch(e){this.log(e),this.logToUser(`${e}\n`)}try{this.sendTestEventToEditor(e)}catch(e){this.log(e),this.logToUser(`${e}\n`)}}),c.process}logToUserIfAppropriate(e,t){e&&e.startsWith("Observatory listening on")||e&&e.startsWith("Press Control-C again")||this.logToUser(e,t)}handleTestEvent(e){switch(e.type){case"start":const t=e.pid;t&&this.additionalPidsToTerminate.push(t);break;case"debug":const s=e.observatory;if(s){const e=n.observatoryHttpLinkPattern.exec(s);e&&this.initDebugger(this.websocketUriForObservatoryUri(e[1]))}break;case"suite":const o=e;!r.isAbsolute(o.suite.path)&&this.cwd&&(o.suite.path=r.join(this.cwd,o.suite.path)),this.suitePaths[o.suite.id]=o.suite.path;break;case"testStart":const a=e;this.tests[a.test.id]=a.test;break;case"testDone":const c=e;if(c.hidden)return;const u="success"===c.result?l:h;this.sendEvent(new i.OutputEvent(`${u} ${this.tests[c.testID].name}\n`,"stdout"));break;case"print":const d=e;this.sendEvent(new i.OutputEvent(`${d.message}\n`,"stdout"));break;case"error":const p=e;this.sendEvent(new i.OutputEvent(`${p.error}\n`,"stderr")),this.sendEvent(new i.OutputEvent(`${p.stackTrace}\n`,"stderr"))}}sendTestEventToEditor(e){let t;switch(e.type){case"suite":t=e.suite.id;break;case"group":t=e.group.suiteID;break;case"testStart":t=e.test.suiteID;break;case"testDone":const s=e;t=this.tests[s.testID].suiteID;break;case"print":const r=e;t=this.tests[r.testID].suiteID;break;case"error":const i=e;t=this.tests[i.testID].suiteID}const s=this.suitePaths[t];s&&this.sendEvent(new i.Event("dart.testRunNotification",{suitePath:s,notification:e}))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.isDartDocument=function(e){return e&&"dart"===e.languageId},t.getActiveDartEditor=function(){const e=r.window.activeTextEditor;if(e&&"dart"===e.document.languageId)return e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.showCode=function(e,t,s,i){i&&(e.selection=new r.Selection(i.start,i.end)),e.revealRange(t,r.TextEditorRevealType.InCenterIfOutsideViewport),e.revealRange(new r.Range(t.start,t.start),r.TextEditorRevealType.Default)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(8),n=s(2);class o{constructor(e,t){this.analyzer=e,this.diagnostics=t,this.analyzer.registerForAnalysisErrors(e=>this.handleErrors(e)),this.analyzer.registerForAnalysisFlushResults(e=>this.flushResults(e))}handleErrors(e){const t=JSON.stringify(e);if(this.lastErrorJson===t)return;let s=e.errors;i.config.showTodos||(s=s.filter(e=>"TODO"!==e.type)),this.diagnostics.set(r.Uri.file(e.file),s.map(e=>o.createDiagnostic(e))),this.lastErrorJson=t}static createDiagnostic(e){const t=new a(n.toRangeOnLine(e.location),e.message,o.getSeverity(e.severity,e.type));return t.code=e.code,t.source="dart",t.tags=o.getTags(e),t.type=e.type,e.correction&&(t.message+=`\n${e.correction}`),t}static getSeverity(e,t){switch(e){case"ERROR":return r.DiagnosticSeverity.Error;case"WARNING":return r.DiagnosticSeverity.Warning;case"INFO":switch(t){case"TODO":default:return r.DiagnosticSeverity.Information}default:throw new Error("Unknown severity type: "+e)}}static getTags(e){const t=[];return"dead_code"!==e.code&&"unused_local_variable"!==e.code&&"unused_import"!==e.code||t.push(r.DiagnosticTag.Unnecessary),t}flushResults(e){this.lastErrorJson=void 0;const t=e.files.map(e=>[r.Uri.file(e),void 0]);this.diagnostics.set(t)}}t.DartDiagnosticProvider=o;class a extends r.Diagnostic{}t.DartDiagnostic=a},function(e,t,s){e.exports=y;var r=s(6),i=s(49),n=s(22),o=(n.Minimatch,s(81)),a=s(16).EventEmitter,c=s(1),u=s(50),l=s(33),h=s(83),d=s(51),p=(d.alphasort,d.alphasorti,d.setopts),g=d.ownProp,f=s(84),m=(s(15),d.childrenIgnored),v=d.isIgnored,b=s(53);function y(e,t,s){if("function"==typeof t&&(s=t,t={}),t||(t={}),t.sync){if(s)throw new TypeError("callback provided to sync glob");return h(e,t)}return new S(e,t,s)}y.sync=h;var w=y.GlobSync=h.GlobSync;function S(e,t,s){if("function"==typeof t&&(s=t,t=null),t&&t.sync){if(s)throw new TypeError("callback provided to sync glob");return new w(e,t)}if(!(this instanceof S))return new S(e,t,s);p(this,e,t),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof s&&(s=b(s),this.on("error",s),this.on("end",function(e){s(null,e)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return a();for(var n=!0,o=0;o<r;o++)this._process(this.minimatch.set[o],o,!1,a);function a(){--i._processing,i._processing<=0&&(n?process.nextTick(function(){i._finish()}):i._finish())}n=!1}y.glob=y,y.hasMagic=function(e,t){var s=function(e,t){if(null===t||"object"!=typeof t)return e;for(var s=Object.keys(t),r=s.length;r--;)e[s[r]]=t[s[r]];return e}({},t);s.noprocess=!0;var r=new S(e,s).minimatch.set;if(!e)return!1;if(r.length>1)return!0;for(var i=0;i<r[0].length;i++)if("string"!=typeof r[0][i])return!0;return!1},y.Glob=S,o(S,a),S.prototype._finish=function(){if(u(this instanceof S),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();d.finish(this),this.emit("end",this.found)}},S.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,s=0;s<this.matches.length;s++)this._realpathSet(s,r)}function r(){0==--e&&t._finish()}},S.prototype._realpathSet=function(e,t){var s=this.matches[e];if(!s)return t();var r=Object.keys(s),n=this,o=r.length;if(0===o)return t();var a=this.matches[e]=Object.create(null);r.forEach(function(s,r){s=n._makeAbs(s),i.realpath(s,n.realpathCache,function(r,i){r?"stat"===r.syscall?a[s]=!0:n.emit("error",r):a[i]=!0,0==--o&&(n.matches[e]=a,t())})})},S.prototype._mark=function(e){return d.mark(this,e)},S.prototype._makeAbs=function(e){return d.makeAbs(this,e)},S.prototype.abort=function(){this.aborted=!0,this.emit("abort")},S.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},S.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var s=e[t];this._emitMatch(s[0],s[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<r.length;t++){var i=r[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},S.prototype._process=function(e,t,s,r){if(u(this instanceof S),u("function"==typeof r),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,s,r]);else{for(var i,o=0;"string"==typeof e[o];)o++;switch(o){case e.length:return void this._processSimple(e.join("/"),t,r);case 0:i=null;break;default:i=e.slice(0,o).join("/")}var a,c=e.slice(o);null===i?a=".":l(i)||l(e.join("/"))?(i&&l(i)||(i="/"+i),a=i):a=i;var h=this._makeAbs(a);if(m(this,a))return r();c[0]===n.GLOBSTAR?this._processGlobStar(i,a,h,c,t,s,r):this._processReaddir(i,a,h,c,t,s,r)}},S.prototype._processReaddir=function(e,t,s,r,i,n,o){var a=this;this._readdir(s,n,function(c,u){return a._processReaddir2(e,t,s,r,i,n,u,o)})},S.prototype._processReaddir2=function(e,t,s,r,i,n,o,a){if(!o)return a();for(var u=r[0],l=!!this.minimatch.negate,h=u._glob,d=this.dot||"."===h.charAt(0),p=[],g=0;g<o.length;g++){if("."!==(m=o[g]).charAt(0)||d)(l&&!e?!m.match(u):m.match(u))&&p.push(m)}var f=p.length;if(0===f)return a();if(1===r.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(g=0;g<f;g++){var m=p[g];e&&(m="/"!==e?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=c.join(this.root,m)),this._emitMatch(i,m)}return a()}r.shift();for(g=0;g<f;g++){m=p[g];e&&(m="/"!==e?e+"/"+m:e+m),this._process([m].concat(r),i,n,a)}a()},S.prototype._emitMatch=function(e,t){if(!this.aborted&&!v(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var s=l(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=s),!this.matches[e][t]){if(this.nodir){var r=this.cache[s];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0;var i=this.statCache[s];i&&this.emit("stat",t,i),this.emit("match",t)}}},S.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var s=this,i=f("lstat\0"+e,function(r,i){if(r&&"ENOENT"===r.code)return t();var n=i&&i.isSymbolicLink();s.symlinks[e]=n,n||!i||i.isDirectory()?s._readdir(e,!1,t):(s.cache[e]="FILE",t())});i&&r.lstat(e,i)}},S.prototype._readdir=function(e,t,s){if(!this.aborted&&(s=f("readdir\0"+e+"\0"+t,s))){if(t&&!g(this.symlinks,e))return this._readdirInGlobStar(e,s);if(g(this.cache,e)){var i=this.cache[e];if(!i||"FILE"===i)return s();if(Array.isArray(i))return s(null,i)}r.readdir(e,function(e,t,s){return function(r,i){r?e._readdirError(t,r,s):e._readdirEntries(t,i,s)}}(this,e,s))}},S.prototype._readdirEntries=function(e,t,s){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var i=t[r];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,s(null,t)}},S.prototype._readdirError=function(e,t,s){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return s()}},S.prototype._processGlobStar=function(e,t,s,r,i,n,o){var a=this;this._readdir(s,n,function(c,u){a._processGlobStar2(e,t,s,r,i,n,u,o)})},S.prototype._processGlobStar2=function(e,t,s,r,i,n,o,a){if(!o)return a();var c=r.slice(1),u=e?[e]:[],l=u.concat(c);this._process(l,i,!1,a);var h=this.symlinks[s],d=o.length;if(h&&n)return a();for(var p=0;p<d;p++){if("."!==o[p].charAt(0)||this.dot){var g=u.concat(o[p],c);this._process(g,i,!0,a);var f=u.concat(o[p],r);this._process(f,i,!0,a)}}a()},S.prototype._processSimple=function(e,t,s){var r=this;this._stat(e,function(i,n){r._processSimple2(e,t,i,n,s)})},S.prototype._processSimple2=function(e,t,s,r,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!r)return i();if(e&&l(e)&&!this.nomount){var n=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=c.join(this.root,e):(e=c.resolve(this.root,e),n&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()},S.prototype._stat=function(e,t){var s=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&g(this.cache,s)){var n=this.cache[s];if(Array.isArray(n)&&(n="DIR"),!i||"DIR"===n)return t(null,n);if(i&&"FILE"===n)return t()}var o=this.statCache[s];if(void 0!==o){if(!1===o)return t(null,o);var a=o.isDirectory()?"DIR":"FILE";return i&&"FILE"===a?t():t(null,a,o)}var c=this,u=f("stat\0"+s,function(i,n){if(n&&n.isSymbolicLink())return r.stat(s,function(r,i){r?c._stat2(e,s,null,n,t):c._stat2(e,s,r,i,t)});c._stat2(e,s,i,n,t)});u&&r.lstat(s,u)},S.prototype._stat2=function(e,t,s,r,i){if(s&&("ENOENT"===s.code||"ENOTDIR"===s.code))return this.statCache[t]=!1,i();var n="/"===e.slice(-1);if(this.statCache[t]=r,"/"===t.slice(-1)&&r&&!r.isDirectory())return i(null,!1,r);var o=!0;return r&&(o=r.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,n&&"FILE"===o?i():i(null,o,r)}},function(e,t,s){e.exports=l,l.realpath=l,l.sync=h,l.realpathSync=h,l.monkeypatch=function(){r.realpath=l,r.realpathSync=h},l.unmonkeypatch=function(){r.realpath=i,r.realpathSync=n};var r=s(6),i=r.realpath,n=r.realpathSync,o=process.version,a=/^v[0-5]\./.test(o),c=s(77);function u(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function l(e,t,s){if(a)return i(e,t,s);"function"==typeof t&&(s=t,t=null),i(e,t,function(r,i){u(r)?c.realpath(e,t,s):s(r,i)})}function h(e,t){if(a)return n(e,t);try{return n(e,t)}catch(s){if(u(s))return c.realpathSync(e,t);throw s}}},function(e,t){e.exports=require("assert")},function(e,t,s){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.alphasort=u,t.alphasorti=c,t.setopts=function(e,t,s){s||(s={});if(s.matchBase&&-1===t.indexOf("/")){if(s.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!s.silent,e.pattern=t,e.strict=!1!==s.strict,e.realpath=!!s.realpath,e.realpathCache=s.realpathCache||Object.create(null),e.follow=!!s.follow,e.dot=!!s.dot,e.mark=!!s.mark,e.nodir=!!s.nodir,e.nodir&&(e.mark=!0);e.sync=!!s.sync,e.nounique=!!s.nounique,e.nonull=!!s.nonull,e.nosort=!!s.nosort,e.nocase=!!s.nocase,e.stat=!!s.stat,e.noprocess=!!s.noprocess,e.absolute=!!s.absolute,e.maxLength=s.maxLength||1/0,e.cache=s.cache||Object.create(null),e.statCache=s.statCache||Object.create(null),e.symlinks=s.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(l))}(e,s),e.changedCwd=!1;var n=process.cwd();r(s,"cwd")?(e.cwd=i.resolve(s.cwd),e.changedCwd=e.cwd!==n):e.cwd=n;e.root=s.root||i.resolve(e.cwd,"/"),e.root=i.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=o(e.cwd)?e.cwd:h(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!s.nomount,s.nonegate=!0,s.nocomment=!0,e.minimatch=new a(t,s),e.options=e.minimatch.options},t.ownProp=r,t.makeAbs=h,t.finish=function(e){for(var t=e.nounique,s=t?[]:Object.create(null),r=0,i=e.matches.length;r<i;r++){var n=e.matches[r];if(n&&0!==Object.keys(n).length){var o=Object.keys(n);t?s.push.apply(s,o):o.forEach(function(e){s[e]=!0})}else if(e.nonull){var a=e.minimatch.globSet[r];t?s.push(a):s[a]=!0}}t||(s=Object.keys(s));e.nosort||(s=s.sort(e.nocase?c:u));if(e.mark){for(var r=0;r<s.length;r++)s[r]=e._mark(s[r]);e.nodir&&(s=s.filter(function(t){var s=!/\/$/.test(t),r=e.cache[t]||e.cache[h(e,t)];return s&&r&&(s="DIR"!==r&&!Array.isArray(r)),s}))}e.ignore.length&&(s=s.filter(function(t){return!d(e,t)}));e.found=s},t.mark=function(e,t){var s=h(e,t),r=e.cache[s],i=t;if(r){var n="DIR"===r||Array.isArray(r),o="/"===t.slice(-1);if(n&&!o?i+="/":!n&&o&&(i=i.slice(0,-1)),i!==t){var a=h(e,i);e.statCache[a]=e.statCache[s],e.cache[a]=e.cache[s]}}return i},t.isIgnored=d,t.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return!(!e.gmatcher||!e.gmatcher.match(t))})};var i=s(1),n=s(22),o=s(33),a=n.Minimatch;function c(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function u(e,t){return e.localeCompare(t)}function l(e){var t=null;if("/**"===e.slice(-3)){var s=e.replace(/(\/\*\*)+$/,"");t=new a(s,{dot:!0})}return{matcher:new a(e,{dot:!0}),gmatcher:t}}function h(e,t){var s=t;return s="/"===t.charAt(0)?i.join(e.root,t):o(t)||""===t?t:e.changedCwd?i.resolve(e.cwd,t):i.resolve(t),"win32"===process.platform&&(s=s.replace(/\\/g,"/")),s}function d(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))})}},function(e,t){e.exports=function e(t,s){if(t&&s)return e(t)(s);if("function"!=typeof t)throw new TypeError("need wrapper function");Object.keys(t).forEach(function(e){r[e]=t[e]});return r;function r(){for(var e=new Array(arguments.length),s=0;s<e.length;s++)e[s]=arguments[s];var r=t.apply(this,e),i=e[e.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach(function(e){r[e]=i[e]}),r}}},function(e,t,s){var r=s(52);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function n(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},s=e.name||"Function wrapped with `once`";return t.onceError=s+" shouldn't be called more than once",t.called=!1,t}e.exports=r(i),e.exports.strict=r(n),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return n(this)},configurable:!0})})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(12),n=s(1),o=s(0),a=s(5),c=s(9);t.createFlutterSampleInTempFolder=function(e,t){if(!e.supportsCreatingSamples)return void o.window.showErrorMessage("Opening sample projects requires Flutter v1.0 or later");const s=n.join(i.tmpdir(),a.dartCodeExtensionIdentifier,"flutter","sample",t,c.getRandomInt(4096,65536).toString(16));c.mkDirRecursive(s),r.writeFileSync(n.join(s,a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE),t);const u=!(!o.workspace.workspaceFolders||!o.workspace.workspaceFolders.length),l=o.Uri.file(s);return o.commands.executeCommand("vscode.openFolder",l,u),l}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nullToUndefined=function(e){return null===e?void 0:e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.element&&e.element.kind){case"CLASS":this.visitClass(e);break;case"CLASS_TYPE_ALIAS":this.visitClassTypeAlias(e);break;case"COMPILATION_UNIT":this.visitCompilationUnit(e);break;case"CONSTRUCTOR":this.visitConstructor(e);break;case"CONSTRUCTOR_INVOCATION":this.visitContructorInvocation(e);break;case"ENUM":this.visitEnum(e);break;case"ENUM_CONSTANT":this.visitEnumConstant(e);break;case"FIELD":this.visitField(e);break;case"FILE":this.visitXXX(e);break;case"FUNCTION":this.visitFile(e);break;case"FUNCTION_INVOCATION":this.visitFunctionInvocation(e);break;case"FUNCTION_TYPE_ALIAS":this.visitFunctionTypeAlias(e);break;case"GETTER":this.visitGetter(e);break;case"LABEL":this.visitLabel(e);break;case"LIBRARY":this.visitLibrary(e);break;case"LOCAL_VARIABLE":this.visitLocalVariable(e);break;case"METHOD":this.visitMethod(e);break;case"PARAMETER":this.visitParameter(e);break;case"PREFIX":this.visitPrefix(e);break;case"SETTER":this.visitSetter(e);break;case"TOP_LEVEL_VARIABLE":this.visitTopLevelVariable(e);break;case"TYPE_PARAMETER":this.visitTypeParameter(e);break;case"UNIT_TEST_GROUP":this.visitUnitTestGroup(e);break;case"UNIT_TEST_TEST":this.visitUnitTestTest(e);break;case"UNKNOWN":this.visitUnknown(e);break;default:this.logger.error(`Unknown Outline item! ${e&&e.element&&e.element.kind}`)}}visitClass(e){this.visitChildren(e)}visitClassTypeAlias(e){this.visitChildren(e)}visitCompilationUnit(e){this.visitChildren(e)}visitConstructor(e){this.visitChildren(e)}visitContructorInvocation(e){this.visitChildren(e)}visitEnum(e){this.visitChildren(e)}visitEnumConstant(e){this.visitChildren(e)}visitField(e){this.visitChildren(e)}visitXXX(e){this.visitChildren(e)}visitFile(e){this.visitChildren(e)}visitFunctionInvocation(e){this.visitChildren(e)}visitFunctionTypeAlias(e){this.visitChildren(e)}visitGetter(e){this.visitChildren(e)}visitLabel(e){this.visitChildren(e)}visitLibrary(e){this.visitChildren(e)}visitLocalVariable(e){this.visitChildren(e)}visitMethod(e){this.visitChildren(e)}visitParameter(e){this.visitChildren(e)}visitPrefix(e){this.visitChildren(e)}visitSetter(e){this.visitChildren(e)}visitTopLevelVariable(e){this.visitChildren(e)}visitTypeParameter(e){this.visitChildren(e)}visitUnitTestGroup(e){this.visitChildren(e)}visitUnitTestTest(e){this.visitChildren(e)}visitUnknown(e){this.visitChildren(e)}}t.OutlineVisitor=r;t.TestOutlineVisitor=class extends r{constructor(){super(...arguments),this.tests=[],this.names=[]}visitUnitTestTest(e){this.addTest(e,super.visitUnitTestTest)}visitUnitTestGroup(e){this.addTest(e,super.visitUnitTestGroup)}addTest(e,t){const s=this.extractTestName(e.element.name);if(!s||!e.element.location)return;this.names.push(s);const r=this.names.join(" "),i="UNIT_TEST_GROUP"===e.element.kind;this.tests.push({file:e.element.location.file,fullName:r,isGroup:i,length:e.codeLength||e.element.location.length,offset:e.codeOffset||e.element.location.offset});try{t.bind(this)(e)}finally{this.names.pop()}}extractTestName(e){if(!e)return;const t=e.indexOf("("),s=e.lastIndexOf(")");if(-1===t||-1===s||t>s)return;const r=(e=e.substring(t+1,s)).substr(0,1);return e.slice(-1)===r&&-1===(e=e.slice(1,-1)).indexOf(r)&&-1===e.indexOf("\\")?e:void 0}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);function i(e,t){const s=t?"":"$";return"^"+r.escapeRegExp(e)+s}t.getLaunchConfig=function(e,t,s,r){return{args:s?["--name",i(s,r)]:void 0,name:"Tests",noDebug:e,program:t,request:"launch",type:"dart"}},t.makeRegexForTest=i},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(12),o=s(1),a=s(0),c=s(5),u=s(3);t.surveyStart=Date.UTC(2019,4,13,19,0),t.surveyEnd=Date.UTC(2019,4,27,7,0),t.showFlutter2019Q2SurveyNotificationIfAppropriate=function(e,s,r){if(s<=t.surveyStart||s>=t.surveyEnd)return!1;const l=e.flutterSurvey2019Q2NotificationLastShown;if(e.flutterSurvey2019Q2NotificationDoNotShow)return!1;if(l&&s-l<c.longRepeatPromptThreshold)return!1;let h;try{const e=c.isWin&&process.env.APPDATA||n.homedir(),t=o.join(e,".flutter");if(i.existsSync(t)){const e=i.readFileSync(t).toString(),s=JSON.parse(e);s.enabled&&(h=s.clientId)}}catch(e){r.warn("Unable to read Flutter settings for preparing survey link")}const d=h?c.flutterSurvey2019Q2PromptWithAnalytics:c.flutterSurvey2019Q2PromptWithoutAnalytics,p="https://google.qualtrics.com/jfe/form/SV_3W3aVD2y9CoAe6V?Source=VSCode"+(h?`&ClientID=${encodeURIComponent(h)}`:"");return e.flutterSurvey2019Q2NotificationLastShown=Date.now(),a.window.showInformationMessage(d,c.takeSurveyAction,c.doNotAskAgainAction).then(t=>{t===c.doNotAskAgainAction?e.flutterSurvey2019Q2NotificationDoNotShow=!0:t===c.takeSurveyAction&&(e.flutterSurvey2019Q2NotificationDoNotShow=!0,u.openInBrowser(p))}),!0},t.showDevToolsNotificationIfAppropriate=function(e){return r(this,void 0,void 0,function*(){const t=e.devToolsNotificationLastShown,s=e.devToolsNotificationsShown||0;if(e.devToolsNotificationDoNotShow||s>=10)return!1;if(t&&Date.now()-t<c.noRepeatPromptThreshold)return!1;e.devToolsNotificationsShown=s+1,e.devToolsNotificationLastShown=Date.now();const r=yield a.window.showInformationMessage(c.wantToTryDevToolsPrompt,c.openDevToolsAction,c.noThanksAction,c.doNotAskAgainAction);return r===c.doNotAskAgainAction?(e.devToolsNotificationDoNotShow=!0,!1):r===c.openDevToolsAction&&(a.commands.executeCommand("dart.openDevTools"),!0)})}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(5),a=s(7),c=s(11),u=s(4),l=s(3),h=s(8),d=s(2),p=s(19);t.isLogging=!1;t.LoggingCommands=class{constructor(e,t){this.logger=e,this.extensionLogPath=t,this.disposables=[],this.disposables.push(n.commands.registerCommand("dart.startLogging",this.startLogging,this))}startLogging(){return r(this,void 0,void 0,function*(){const e=i.join(u.forceWindowsDriveLetterToUppercase(this.extensionLogPath),this.generateFilename()),s=n.Uri.file(e);d.createFolderForFile(e);const r=yield n.window.showQuickPick(Object.keys(p.userSelectableLogCategories).map(e=>({label:e,logCategory:p.userSelectableLogCategories[e],picked:!0})),{canPickMany:!0,placeHolder:"Select which categories to include in the log"});if(!r||!r.length)return;const g=[a.LogCategory.General].concat(r.map(e=>e.logCategory)),f=c.captureLogs(this.logger,l.fsPath(s),p.getLogHeader(),h.config.maxLogLineLength,g);t.isLogging=!0,this.disposables.push(f),yield n.window.showInformationMessage(`Dart and Flutter logs are being captured. Reproduce your issue then click ${o.stopLoggingAction}.`,o.stopLoggingAction),t.isLogging=!1,yield f.dispose();const m=yield n.workspace.openTextDocument(s);return yield n.window.showTextDocument(m),e})}generateFilename(){const e=e=>`0${e.toString()}`.slice(-2),t=new Date;return`Dart-Code-Log-${`${t.getFullYear()}-${e(t.getMonth())}-${e(t.getDay())} ${e(t.getHours())}-${e(t.getMinutes())}-${e(t.getSeconds())}`}.txt`}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(101),a=s(39);var c;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(c=t.LogLevel||(t.LogLevel={}));class u{constructor(){this._pendingLogQ=[]}log(e,t=c.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,c.Verbose)}warn(e){this.log(e,c.Warn)}error(e){this.log(e,c.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=c.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,s=!0){const r="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:r,prependTimestamp:s};this._currentLogger.setup(t).then(()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach(e=>this._write(e.msg,e.level))}})}}init(e,t,s){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new l(e,s),this._logFilePathFromInit=t}}t.Logger=u,t.logger=new u;class l{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=c.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}setup(e){return r(this,void 0,void 0,function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(n.isAbsolute(e.logFilePath)){const s=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,c.Error);try{yield(t=n.dirname(e.logFilePath),new Promise((e,s)=>{o(t,t=>{t?s(t):e()})})),this.log("Verbose logs are written to:\n",c.Warn),this.log(e.logFilePath+"\n",c.Warn),this._logFileStream=i.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",e=>{s(e)})}catch(e){s(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,c.Error);var t})}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}`+"-"+e.getUTCDate()+", "+p();this.log(t+"\n",c.Verbose,!1)}setupShutdownListeners(){process.addListener("beforeExit",this.beforeExitCallback),process.addListener("SIGTERM",this.disposeCallback),process.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,s=!0){if(this._minLogLevel!==c.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const s=t===c.Error?console.error:t===c.Warn?console.warn:null;s&&s(d(e))}t===c.Error&&(e=`[${c[t]}] ${e}`),this._prependTimestamp&&s&&(e="["+p()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const s=new h(e,t);this._logCallback(s)}}}class h extends a.OutputEvent{constructor(e,t){super(e,t===c.Error?"stderr":t===c.Warn?"console":"stdout")}}function d(e){return e.replace(/(\n|\r\n)$/,"")}function p(){let e=new Date;return g(2,String(e.getUTCHours()))+":"+g(2,String(e.getUTCMinutes()))+":"+g(2,String(e.getUTCSeconds()))+"."+g(3,String(e.getUTCMilliseconds()))+" UTC"}function g(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.LogOutputEvent=h,t.trimLastNewline=d},function(e,t,s){"use strict";const r=s(16),i=s(18),n=s(42),o=s(37),a=s(107),{randomBytes:c,createHash:u}=s(43),{URL:l}=s(41),h=s(26),d=s(62),p=s(64),{BINARY_TYPES:g,EMPTY_BUFFER:f,GUID:m,kStatusCode:v,kWebSocket:b,NOOP:y}=s(14),{addEventListener:w,removeEventListener:S}=s(111),{format:E,parse:T}=s(65),{toBuffer:C}=s(27),P=["CONNECTING","OPEN","CLOSING","CLOSED"],k=[8,13],_=3e4;class R extends r{constructor(e,t,s){super(),this.readyState=R.CONNECTING,this.protocol="",this._binaryType=g[0],this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._closeCode=1006,this._extensions={},this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(s=t,t=void 0),function e(t,s,r,o){const a={protocolVersion:k[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,auth:void 0,host:void 0,path:void 0,port:void 0};if(!k.includes(a.protocolVersion))throw new RangeError(`Unsupported protocol version: ${a.protocolVersion} `+`(supported versions: ${k.join(", ")})`);let d;s instanceof l?(d=s,t.url=s.href):(d=new l(s),t.url=s);const p="ws+unix:"===d.protocol;if(!(d.host||p&&d.pathname))throw new Error(`Invalid URL: ${t.url}`);const g="wss:"===d.protocol||"https:"===d.protocol;const f=g?443:80;const v=c(16).toString("base64");const b=g?i.get:n.get;let y;a.createConnection=g?F:x;a.defaultPort=a.defaultPort||f;a.port=d.port||f;a.host=d.hostname.startsWith("[")?d.hostname.slice(1,-1):d.hostname;a.headers={"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket",...a.headers};a.path=d.pathname+d.search;a.timeout=a.handshakeTimeout;a.perMessageDeflate&&(y=new h(!0!==a.perMessageDeflate?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=E({[h.extensionName]:y.offer()}));r&&(a.headers["Sec-WebSocket-Protocol"]=r);a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin);(d.username||d.password)&&(a.auth=`${d.username}:${d.password}`);if(p){const e=a.path.split(":");a.socketPath=e[0],a.path=e[1]}let w=t._req=b(a);a.timeout&&w.on("timeout",()=>{D(t,w,"Opening handshake has timed out")});w.on("error",e=>{t._req.aborted||(w=t._req=null,t.readyState=R.CLOSING,t.emit("error",e),t.emitClose())});w.on("response",i=>{const n=i.headers.location,c=i.statusCode;if(n&&a.followRedirects&&c>=300&&c<400){if(++t._redirects>a.maxRedirects)return void D(t,w,"Maximum redirects exceeded");w.abort();const i=new l(n,s);e(t,i,r,o)}else t.emit("unexpected-response",w,i)||D(t,w,`Unexpected server response: ${i.statusCode}`)});w.on("upgrade",(e,s,i)=>{if(t.emit("upgrade",e),t.readyState!==R.CONNECTING)return;w=t._req=null;const n=u("sha1").update(v+m).digest("base64");if(e.headers["sec-websocket-accept"]!==n)return void D(t,s,"Invalid Sec-WebSocket-Accept header");const o=e.headers["sec-websocket-protocol"],c=(r||"").split(/, */);let l;if(!r&&o?l="Server sent a subprotocol but none was requested":r&&!o?l="Server sent no subprotocol":o&&!c.includes(o)&&(l="Server sent an invalid subprotocol"),l)D(t,s,l);else{if(o&&(t.protocol=o),y)try{const r=T(e.headers["sec-websocket-extensions"]);r[h.extensionName]&&(y.accept(r[h.extensionName]),t._extensions[h.extensionName]=y)}catch(e){return void D(t,s,"Invalid Sec-WebSocket-Extensions header")}t.setSocket(s,i,a.maxPayload)}})}(this,e,t,s)):this._isServer=!0}get CONNECTING(){return R.CONNECTING}get CLOSING(){return R.CLOSING}get CLOSED(){return R.CLOSED}get OPEN(){return R.OPEN}get binaryType(){return this._binaryType}set binaryType(e){g.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?(this._socket.bufferSize||0)+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,s){const r=new d(this._binaryType,this._extensions,s);this._sender=new p(e,this._extensions),this._receiver=r,this._socket=e,r[b]=this,e[b]=this,r.on("conclude",O),r.on("drain",I),r.on("error",L),r.on("message",N),r.on("ping",$),r.on("pong",j),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",U),e.on("data",W),e.on("end",q),e.on("error",B),this.readyState=R.OPEN,this.emit("open")}emitClose(){this.readyState=R.CLOSED,this._socket?(this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this.emit("close",this._closeCode,this._closeMessage)):this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==R.CLOSED){if(this.readyState===R.CONNECTING){const e="WebSocket was closed before the connection was established";return D(this,this._req,e)}this.readyState!==R.CLOSING?(this.readyState=R.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._closeFrameReceived&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),_)):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}ping(e,t,s){if(this.readyState===R.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===R.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||f,t,s)):A(this,e,s)}pong(e,t,s){if(this.readyState===R.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===R.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||f,t,s)):A(this,e,s)}send(e,t,s){if(this.readyState===R.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(s=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN)return void A(this,e,s);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(r.compress=!1),this._sender.send(e||f,r,s)}terminate(){if(this.readyState!==R.CLOSED){if(this.readyState===R.CONNECTING){const e="WebSocket was closed before the connection was established";return D(this,this._req,e)}this._socket&&(this.readyState=R.CLOSING,this._socket.destroy())}}}function x(e){return e.path=e.socketPath,o.connect(e)}function F(e){return e.path=void 0,e.servername=e.servername||e.host,a.connect(e)}function D(e,t,s){e.readyState=R.CLOSING;const r=new Error(s);Error.captureStackTrace(r,D),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function A(e,t,s){if(t){const s=C(t).length;e._socket?e._sender._bufferedBytes+=s:e._bufferedAmount+=s}if(s){s(new Error(`WebSocket is not open: readyState ${e.readyState} `+`(${P[e.readyState]})`))}}function O(e,t){const s=this[b];s._socket.removeListener("data",W),s._socket.resume(),s._closeFrameReceived=!0,s._closeMessage=t,s._closeCode=e,1005===e?s.close():s.close(e,t)}function I(){this[b]._socket.resume()}function L(e){const t=this[b];t._socket.removeListener("data",W),t.readyState=R.CLOSING,t._closeCode=e[v],t.emit("error",e),t._socket.destroy()}function M(){this[b].emitClose()}function N(e){this[b].emit("message",e)}function $(e){const t=this[b];t.pong(e,!t._isServer,y),t.emit("ping",e)}function j(e){this[b].emit("pong",e)}function U(){const e=this[b];this.removeListener("close",U),this.removeListener("end",q),e.readyState=R.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",W),this[b]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",M),e._receiver.on("finish",M))}function W(e){this[b]._receiver.write(e)||this.pause()}function q(){const e=this[b];e.readyState=R.CLOSING,e._receiver.end(),this.end()}function B(){const e=this[b];this.removeListener("error",B),this.on("error",y),e.readyState=R.CLOSING,this.destroy()}P.forEach((e,t)=>{R[e]=t}),["open","error","close","message"].forEach(e=>{Object.defineProperty(R.prototype,`on${e}`,{get(){const t=this.listeners(e);for(let e=0;e<t.length;e++)if(t[e]._listener)return t[e]._listener},set(t){const s=this.listeners(e);for(let t=0;t<s.length;t++)s[t]._listener&&this.removeListener(e,s[t]);this.addEventListener(e,t)}})}),R.prototype.addEventListener=w,R.prototype.removeEventListener=S,e.exports=R},function(e,t,s){"use strict";const{Writable:r}=s(110),i=s(26),{BINARY_TYPES:n,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:c}=s(14),{concat:u,toArrayBuffer:l,unmask:h}=s(27),{isValidStatusCode:d,isValidUTF8:p}=s(63),g=0,f=1,m=2,v=3,b=4,y=5;function w(e,t,s,r){const i=new e(s?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(i,w),i[a]=r,i}e.exports=class extends r{constructor(e,t,s){super(),this._binaryType=e||n[0],this[c]=void 0,this._extensions=t||{},this._maxPayload=0|s,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=g,this._loop=!1}_write(e,t,s){if(8===this._opcode&&this._state==g)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const s=this._buffers[0];e>=s.length?this._buffers.shift().copy(t,t.length-e):(s.copy(t,t.length-e,0,e),this._buffers[0]=s.slice(e)),e-=s.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case g:t=this.getInfo();break;case f:t=this.getPayloadLength16();break;case m:t=this.getPayloadLength64();break;case v:this.getMask();break;case b:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,w(RangeError,"RSV2 and RSV3 must be clear",!0,1002);const t=64==(64&e[0]);if(t&&!this._extensions[i.extensionName])return this._loop=!1,w(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,w(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,w(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,w(RangeError,`invalid opcode ${this._opcode}`,!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,w(RangeError,`invalid opcode ${this._opcode}`,!0,1002);if(!this._fin)return this._loop=!1,w(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,w(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,w(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),126===this._payloadLength)this._state=f;else{if(127!==this._payloadLength)return this.haveLength();this._state=m}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,w(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,w(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=v:this._state=b}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=b)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&h(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=y,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,s)=>{if(e)return t(e);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(w(RangeError,"Max payload size exceeded",!1,1009));this._fragments.push(s)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)})}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let s;s="nodebuffer"===this._binaryType?u(t,e):"arraybuffer"===this._binaryType?l(u(t,e)):t,this.emit("message",s)}else{const s=u(t,e);if(!p(s))return this._loop=!1,w(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",s.toString())}}this._state=g}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return w(RangeError,"invalid payload length 1",!0,1002);{const t=e.readUInt16BE(0);if(!d(t))return w(RangeError,`invalid status code ${t}`,!0,1002);const s=e.slice(2);if(!p(s))return w(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,s.toString()),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=g}}},function(e,t,s){"use strict";try{const e=s(!function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}());t.isValidUTF8="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=()=>!0}t.isValidStatusCode=e=>e>=1e3&&e<=1013&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},function(e,t,s){"use strict";const{randomFillSync:r}=s(43),i=s(26),{EMPTY_BUFFER:n}=s(14),{isValidStatusCode:o}=s(63),{mask:a,toBuffer:c}=s(27),u=Buffer.alloc(4);class l{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const s=t.mask&&t.readOnly;let i=t.mask?6:2,n=e.length;e.length>=65536?(i+=8,n=127):e.length>125&&(i+=2,n=126);const o=Buffer.allocUnsafe(s?e.length+i:i);return o[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(o[0]|=64),o[1]=n,126===n?o.writeUInt16BE(e.length,2):127===n&&(o.writeUInt32BE(0,2),o.writeUInt32BE(e.length,6)),t.mask?(r(u,0,4),o[1]|=128,o[i-4]=u[0],o[i-3]=u[1],o[i-2]=u[2],o[i-1]=u[3],s?(a(e,u,o,i,e.length),[o]):(a(e,u,e,0,e.length),[o,e])):[o,e]}close(e,t,s,r){let i;if(void 0===e)i=n;else{if("number"!=typeof e||!o(e))throw new TypeError("First argument must be a valid error code number");void 0===t||""===t?(i=Buffer.allocUnsafe(2)).writeUInt16BE(e,0):((i=Buffer.allocUnsafe(2+Buffer.byteLength(t))).writeUInt16BE(e,0),i.write(t,2))}this._deflating?this.enqueue([this.doClose,i,s,r]):this.doClose(i,s,r)}doClose(e,t,s){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),s)}ping(e,t,s){const r=c(e);this._deflating?this.enqueue([this.doPing,r,t,c.readOnly,s]):this.doPing(r,t,c.readOnly,s)}doPing(e,t,s,r){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:s}),r)}pong(e,t,s){const r=c(e);this._deflating?this.enqueue([this.doPong,r,t,c.readOnly,s]):this.doPong(r,t,c.readOnly,s)}doPong(e,t,s,r){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:s}),r)}send(e,t,s){const r=c(e),n=this._extensions[i.extensionName];let o=t.binary?2:1,a=t.compress;if(this._firstFragment?(this._firstFragment=!1,a&&n&&(a=r.length>=n._threshold),this._compress=a):(a=!1,o=0),t.fin&&(this._firstFragment=!0),n){const e={fin:t.fin,rsv1:a,opcode:o,mask:t.mask,readOnly:c.readOnly};this._deflating?this.enqueue([this.dispatch,r,this._compress,e,s]):this.dispatch(r,this._compress,e,s)}else this.sendFrame(l.frame(r,{fin:t.fin,rsv1:!1,opcode:o,mask:t.mask,readOnly:c.readOnly}),s)}dispatch(e,t,s,r){if(!t)return void this.sendFrame(l.frame(e,s),r);const n=this._extensions[i.extensionName];this._deflating=!0,n.compress(e,s.fin,(e,t)=>{this._deflating=!1,s.readOnly=!1,this.sendFrame(l.frame(t,s),r),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=l},function(e,t,s){"use strict";const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function i(e,t,s){void 0===e[t]?e[t]=[s]:e[t].push(s)}e.exports={format:function(e){return Object.keys(e).map(t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map(e=>[t].concat(Object.keys(e).map(t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){const t=Object.create(null);if(void 0===e||""===e)return t;let s,n,o=Object.create(null),a=!1,c=!1,u=!1,l=-1,h=-1,d=0;for(;d<e.length;d++){const p=e.charCodeAt(d);if(void 0===s)if(-1===h&&1===r[p])-1===l&&(l=d);else if(32===p||9===p)-1===h&&-1!==l&&(h=d);else{if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===h&&(h=d);const r=e.slice(l,h);44===p?(i(t,r,o),o=Object.create(null)):s=r,l=h=-1}}else if(void 0===n)if(-1===h&&1===r[p])-1===l&&(l=d);else if(32===p||9===p)-1===h&&-1!==l&&(h=d);else if(59===p||44===p){if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===h&&(h=d),i(o,e.slice(l,h),!0),44===p&&(i(t,s,o),o=Object.create(null),s=void 0),l=h=-1}else{if(61!==p||-1===l||-1!==h)throw new SyntaxError(`Unexpected character at index ${d}`);n=e.slice(l,d),l=h=-1}else if(c){if(1!==r[p])throw new SyntaxError(`Unexpected character at index ${d}`);-1===l?l=d:a||(a=!0),c=!1}else if(u)if(1===r[p])-1===l&&(l=d);else if(34===p&&-1!==l)u=!1,h=d;else{if(92!==p)throw new SyntaxError(`Unexpected character at index ${d}`);c=!0}else if(34===p&&61===e.charCodeAt(d-1))u=!0;else if(-1===h&&1===r[p])-1===l&&(l=d);else if(-1===l||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===h&&(h=d);let r=e.slice(l,h);a&&(r=r.replace(/\\/g,""),a=!1),i(o,n,r),44===p&&(i(t,s,o),o=Object.create(null),s=void 0),n=void 0,l=h=-1}}else-1===h&&(h=d)}if(-1===l||u)throw new SyntaxError("Unexpected end of input");-1===h&&(h=d);const p=e.slice(l,h);return void 0===s?i(t,p,o):(void 0===n?i(o,p,!0):i(o,n,a?p.replace(/\\/g,""):p),i(t,s,o)),t}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(21),n=s(5),o=s(7),a=s(67),c=s(38),u=s(117),l=s(29),h=s(28),d="my-group",p="══╡ EXCEPTION CAUGHT BY",g="══════════════════════════════════════════";t.FlutterDebugSession=class extends c.DartDebugSession{constructor(){super(),this.appHasStarted=!1,this.isReloadInProgress=!1,this.outputCategory="stdout",this.sendStdOutToConsole=!1,this.parseObservatoryUriFromStdOut=!1,this.requiresProgram=!1,this.logCategory=o.LogCategory.FlutterRun,this.connectVmEvenForNoDebug=!0}initializeRequest(e,t){e.body.supportsRestartRequest=!0,super.initializeRequest(e,t)}launchRequest(e,t){return this.flutterTrackWidgetCreation=t&&t.flutterTrackWidgetCreation,this.outputCategory="stdout",super.launchRequest(e,t)}attachRequest(e,t){return r(this,void 0,void 0,function*(){this.launchRequest(e,t)})}spawnProcess(e){const t="attach"===e.request;t?this.sendEvent(new i.Event("dart.launching",{message:"Waiting for Application to connect...",finished:!1})):this.sendEvent(new i.Event("dart.launching",{message:"Launching...",finished:!1})),e.showMemoryUsage&&(this.pollforMemoryMs=1e3),this.allowTerminatingObservatoryVmPid="flutter-tester"===e.deviceId&&!t;const s=new h.DebugAdapterLogger(this,this.logCategory);return this.flutter=this.spawnRunDaemon(t,e,s),this.flutter.registerForUnhandledMessages(e=>this.handleLogOutput(e)),this.flutter.registerForDaemonConnect(e=>this.additionalPidsToTerminate.push(e.pid)),this.flutter.registerForAppStart(e=>this.currentRunningAppId=e.appId),this.flutter.registerForAppDebugPort(e=>{this.observatoryUri=e.wsUri,this.connectToObservatoryIfReady()}),this.flutter.registerForAppStarted(e=>{this.appHasStarted=!0,this.connectToObservatoryIfReady(),this.sendEvent(new i.Event("dart.launched"))}),this.flutter.registerForAppStop(e=>{this.currentRunningAppId=void 0,this.flutter.dispose()}),this.flutter.registerForAppProgress(e=>this.sendEvent(new i.Event("dart.progress",{message:e.message,finished:e.finished,progressID:e.progressId||e.id}))),this.flutter.registerForError(e=>this.sendEvent(new i.OutputEvent(`${e}\n`,"stderr"))),this.flutter.registerForDaemonLog(e=>this.handleLogOutput(e.log,e.error)),this.flutter.registerForAppLog(e=>this.handleLogOutput(e.log,e.error)),this.flutter.process}handleLogOutput(e,t=!1){-1!==(e=`${e.trimRight()}\n`).indexOf(p)?(this.outputCategory="stderr",this.logToUser(e,this.outputCategory)):-1!==e.indexOf(g)?(this.logToUser(e,this.outputCategory),this.outputCategory="stdout"):this.logToUser(e,t?"stderr":this.outputCategory)}spawnRunDaemon(e,t,s){let r=[];if(e||(r.push("-t"),r.push(this.sourceFileForArgs(t))),t.deviceId&&(r.push("-d"),r.push(t.deviceId)),e){const e=t;if(e.observatoryUri)if(t.flutterAttachSupportsUris)r.push("--debug-uri"),r.push(e.observatoryUri);else{const t=a.extractObservatoryPort(e.observatoryUri);t?(r.push("--debug-port"),r.push(t.toString())):s.warn(`Observatory port was not found: ${e.observatoryUri}`)}}return e||("profile"===t.flutterMode?r.push("--profile"):"release"===t.flutterMode?r.push("--release"):this.flutterTrackWidgetCreation&&r.push("--track-widget-creation"),t.flutterPlatform&&"default"!==t.flutterPlatform&&r.push(`--target-platform=${t.flutterPlatform}`),this.shouldConnectDebugger&&(r.push("--start-paused"),t.vmServicePort&&-1===r.indexOf("--observatory-port")&&(r.push("--observatory-port"),r.push(t.vmServicePort.toString())))),t.args&&(r=r.concat(t.args)),!0===t.forceFlutterVerboseMode&&-1===r.indexOf("-v")&&-1===r.indexOf("--verbose")&&r.push("-v"),new u.FlutterRun(e?l.RunMode.Attach:l.RunMode.Run,t.flutterPath,t.cwd,r,t.env,t.flutterRunLogFile,s,this.maxLogLineLength)}connectToObservatoryIfReady(){this.observatoryUri&&this.appHasStarted&&!this.observatory&&this.initDebugger(this.observatoryUri)}terminate(e){const t=Object.create(null,{terminate:{get:()=>super.terminate}});return r(this,void 0,void 0,function*(){try{if(this.currentRunningAppId&&this.appHasStarted&&!this.processExited){const e=this.flutter.mode===l.RunMode.Run?()=>this.flutter.stop(this.currentRunningAppId):()=>this.flutter.detach(this.currentRunningAppId);yield Promise.race([e(),new Promise(e=>setTimeout(e,1e3))])}}catch(e){}t.terminate.call(this,e)})}restartRequest(e,t){this.sendEvent(new i.Event("dart.hotRestartRequest")),this.performReload(!0,n.restartReasonManual),super.restartRequest(e,t)}performReload(e,t){return r(this,void 0,void 0,function*(){if(!this.appHasStarted)return;if(this.isReloadInProgress)return void this.sendEvent(new i.OutputEvent("Reload already in progress, ignoring request","stderr"));this.isReloadInProgress=!0;const s=e?"hot-restart":"hot-reload";try{yield this.flutter.restart(this.currentRunningAppId,!this.noDebug,e,t),this.requestCoverageUpdate(s)}catch(e){this.sendEvent(new i.OutputEvent(`Error running ${s}: ${e}\n`,"stderr"))}finally{this.isReloadInProgress=!1}})}customRequest(e,t,s){const o=Object.create(null,{customRequest:{get:()=>super.customRequest}});return r(this,void 0,void 0,function*(){try{switch(e){case"serviceExtension":this.currentRunningAppId&&(yield this.flutter.callServiceExtension(this.currentRunningAppId,s.type,s.params)),this.sendResponse(t);break;case"checkPlatformOverride":if(this.currentRunningAppId){const e=yield this.flutter.callServiceExtension(this.currentRunningAppId,"ext.flutter.platformOverride",void 0);this.sendEvent(new i.Event("dart.flutter.updatePlatformOverride",{platform:e.value}))}this.sendResponse(t);break;case"checkIsWidgetCreationTracked":if(this.currentRunningAppId){const e=yield this.flutter.callServiceExtension(this.currentRunningAppId,"ext.flutter.inspector.isWidgetCreationTracked",void 0);this.sendEvent(new i.Event("dart.flutter.updateIsWidgetCreationTracked",{isWidgetCreationTracked:e.result}))}this.sendResponse(t);break;case"hotReload":this.currentRunningAppId&&(yield this.performReload(!1,s&&s.reason||n.restartReasonManual)),this.sendResponse(t);break;case"hotRestart":this.currentRunningAppId&&(yield this.performReload(!0,s&&s.reason||n.restartReasonManual)),this.sendResponse(t);break;default:o.customRequest.call(this,e,t,s)}}catch(e){this.sendEvent(new i.OutputEvent(`${e}\n`,"stderr"))}})}handleInspectEvent(e){return r(this,void 0,void 0,function*(){const e=yield this.flutter.callServiceExtension(this.currentRunningAppId,"ext.flutter.inspector.getSelectedSummaryWidget",{previousSelectionId:null,objectGroup:d});if(e&&e.result&&e.result.creationLocation){const t=e.result.creationLocation,s=t.file,r=t.line,n=t.column;this.sendEvent(new i.Event("dart.navigate",{file:s,line:r,column:n}))}yield this.flutter.callServiceExtension(this.currentRunningAppId,"ext.flutter.inspector.disposeGroup",{objectGroup:d})})}handleExtensionEvent(e){"Extension"===e.kind&&"Flutter.FirstFrame"===e.extensionKind?this.sendEvent(new i.Event("dart.flutter.firstFrame",{})):"Extension"===e.kind&&"Flutter.Frame"===e.extensionKind?this.requestCoverageUpdate("frame"):"Extension"===e.kind&&"Flutter.ServiceExtensionStateChanged"===e.extensionKind?this.sendEvent(new i.Event("dart.flutter.serviceExtensionStateChanged",e.extensionData)):super.handleExtensionEvent(e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),i=/:([0-9]+)\/?$/;t.extractObservatoryPort=function(e){const t=i.exec(e);return t?parseInt(t[1],10):void 0};t.DartDebugSessionInformation=class{constructor(e){this.session=e,this.launchProgressPromise=new r.PromiseCompleter,this.sessionStart=new Date}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(5),o=s(7),a=s(4),c=s(17),u=s(57),l=s(3),h=s(30),d=s(2),p={};class g{constructor(){this.disposables=[],this.onDidChangeTreeDataEmitter=new i.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.onDidStartTestsEmitter=new i.EventEmitter,this.onDidStartTests=this.onDidStartTestsEmitter.event,this.onFirstFailureEmitter=new i.EventEmitter,this.onFirstFailure=this.onFirstFailureEmitter.event,this.owningDebugSessions={},this.disposables.push(i.debug.onDidReceiveDebugSessionCustomEvent(e=>this.handleDebugSessionCustomEvent(e))),this.disposables.push(i.debug.onDidTerminateDebugSession(e=>this.handleDebugSessionEnd(e))),this.disposables.push(i.commands.registerCommand("dart.startDebuggingTest",e=>{i.debug.startDebugging(i.workspace.getWorkspaceFolder(e.resourceUri),u.getLaunchConfig(!1,l.fsPath(e.resourceUri),e instanceof y?e.test.name:e instanceof b?e.group.name:void 0,e instanceof b))})),this.disposables.push(i.commands.registerCommand("dart.startWithoutDebuggingTest",e=>{i.debug.startDebugging(i.workspace.getWorkspaceFolder(e.resourceUri),u.getLaunchConfig(!0,l.fsPath(e.resourceUri),e instanceof y?e.test.name:e instanceof b?e.group.name:void 0,e instanceof b))})),this.disposables.push(i.commands.registerCommand("_dart.displaySuite",e=>i.commands.executeCommand("_dart.jumpToLineColInUri",i.Uri.file(e.suite.path)))),this.disposables.push(i.commands.registerCommand("_dart.displayGroup",e=>i.commands.executeCommand("_dart.jumpToLineColInUri",i.Uri.parse(e.group.url||e.group.root_url),e.group.root_line||e.group.line,e.group.root_column||e.group.column))),this.disposables.push(i.commands.registerCommand("_dart.displayTest",e=>(this.writeTestOutput(e,!0),i.commands.executeCommand("_dart.jumpToLineColInUri",i.Uri.parse(e.test.root_url||e.test.url),e.test.root_line||e.test.line,e.test.root_column||e.test.column))))}static flagSuiteStart(e,t){if(g.isNewTestRun=!0,g.nextFailureIsFirst=!0,t&&e&&r.isAbsolute(e)){const t=p[l.fsPath(e)];t&&(t.getAllGroups().forEach(e=>e.isPotentiallyDeleted=!0),t.getAllTests().forEach(e=>e.isPotentiallyDeleted=!0))}Object.keys(p).forEach(e=>{const t=p[l.fsPath(e)];t.currentRunNumber++,t.getAllGroups().forEach(e=>e.isStale=!0),t.getAllTests().forEach(e=>e.isStale=!0)})}setSelectedNodes(e){this.currentSelectedNode=e}writeTestOutput(e,t=!1){const s=h.getChannel("Test Output");s.clear(),t&&s.show(!0),s.appendLine(`${e.test.name}:\n`),e.outputEvents.length||s.appendLine("(no output)");for(const t of e.outputEvents)this.appendTestOutput(t,s)}appendTestOutput(e,t=h.getChannel("Test Output")){"error"===e.type?(e=e,t.appendLine(`ERROR: ${e.error}`),t.appendLine(e.stackTrace)):"print"===e.type?(e=e,t.appendLine(e.message)):t.appendLine(`Unknown message type '${e.type}'.`)}handleDebugSessionCustomEvent(e){"dart.testRunNotification"===e.event&&("suite"===e.body.notification.type&&(this.owningDebugSessions[e.body.suitePath]=e.session),this.handleNotification(e.body.suitePath,e.body.notification))}getTreeItem(e){return e}getChildren(e){let t=e?e instanceof v||e instanceof b?e.children:[]:Object.keys(p).map(e=>p[e].node);return t=t.filter(e=>e),e||(t=t.sort((e,t)=>{if(e.sort>t.sort)return 1;if(e.sort<t.sort)return-1;const s=e.label||(e.resourceUri?e.resourceUri.toString():""),r=t.label||(t.resourceUri?t.resourceUri.toString():"");return s>r?1:s<r?-1:0})),t}getParent(e){if(e instanceof y||e instanceof b)return e.parent}updateNode(e){this.onDidChangeTreeDataEmitter.fire(e)}updateAllStatuses(e){this.updateStatusFromChildren(e.node),this.updateNode()}updateStatusFromChildren(e){const t=e.children.length?e.children.filter(e=>e instanceof b&&!e.isPhantomGroup||e instanceof y&&!e.hidden).map(e=>e instanceof b?this.updateStatusFromChildren(e):e instanceof y?e.status:o.TestStatus.Unknown):[o.TestStatus.Unknown],s=Math.max.apply(Math,t);return s!==e.status&&(e.status=s,e.iconPath=w(e.status,!1),this.updateNode(e)),e.status}dispose(){this.disposables.forEach(e=>e.dispose())}handleNotification(e,t){const s=p[e];switch(t.type){case"suite":this.handleSuiteNotification(e,t);break;case"testStart":this.handleTestStartNotifcation(s,t);break;case"testDone":this.handleTestDoneNotification(s,t);break;case"group":this.handleGroupNotification(s,t);break;case"print":this.handlePrintNotification(s,t);break;case"error":this.handleErrorNotification(s,t)}}handleSuiteNotification(e,t){let s=p[t.suite.path];s||(s=new f(e,new v(t.suite)),p[t.suite.path]=s),s.node.status=o.TestStatus.Waiting,this.updateNode(s.node),this.updateNode(),g.isNewTestRun&&(g.isNewTestRun=!1,this.onDidStartTestsEmitter.fire(s.node))}handleTestStartNotifcation(e,t){let s;const r=e.getCurrentTest(t.test.id)||e.reuseMatchingTest(e.currentRunNumber,t.test,e=>s=e),i=r||new y(e,t.test);r||e.storeTest(t.test.id,i),i.test=t.test,i.test.name&&i.test.name.startsWith("loading ")&&i.parent instanceof v?i.hidden=!0:i.hidden=!1;const n=s&&s!==i.parent;n&&(s.tests.splice(s.tests.indexOf(i),1),this.updateNode(s)),r&&!n||i.parent.tests.push(i),i.status=o.TestStatus.Running,this.updateNode(i),this.updateNode(i.parent),i.hidden||this.updateAllStatuses(e)}handleTestDoneNotification(e,t){const s=e.getCurrentTest(t.testID);s.hidden=t.hidden,t.skipped?s.status=o.TestStatus.Skipped:"success"===t.result?s.status=o.TestStatus.Passed:"failure"===t.result?s.status=o.TestStatus.Failed:"error"===t.result?s.status=o.TestStatus.Errored:s.status=o.TestStatus.Unknown,this.updateNode(s),this.updateNode(s.parent),this.updateAllStatuses(e),s.status===o.TestStatus.Failed&&g.nextFailureIsFirst&&(g.nextFailureIsFirst=!1,this.onFirstFailureEmitter.fire(e.node))}handleGroupNotification(e,t){let s;const r=e.getCurrentGroup(t.group.id)||e.reuseMatchingGroup(e.currentRunNumber,t.group,e=>s=e),i=r||new b(e,t.group);r||e.storeGroup(t.group.id,i),i.group=t.group;const n=s&&s!==i.parent;s&&n&&(s.groups.splice(s.groups.indexOf(i),1),this.updateNode(s)),r&&!n||i.parent.groups.push(i),i.status=o.TestStatus.Running,this.updateNode(i),this.updateNode(i.parent)}handleDebugSessionEnd(e){const t=Object.keys(this.owningDebugSessions).filter(t=>this.owningDebugSessions[t]&&e&&this.owningDebugSessions[t].id===e.id);for(const e of t)this.handleSuiteEnd(p[e]),this.owningDebugSessions[e]=void 0,delete this.owningDebugSessions[e]}handleSuiteEnd(e){e&&(e.getAllTests(!0).filter(e=>e.isPotentiallyDeleted||e.hidden).forEach(e=>{e.hidden=!0,this.updateNode(e.parent)}),e.getAllTests().filter(e=>e.status===o.TestStatus.Running).forEach(e=>{e.status=o.TestStatus.Unknown,this.updateNode(e)}),this.updateAllStatuses(e))}handlePrintNotification(e,t){const s=e.getCurrentTest(t.testID);s.outputEvents.push(t),s===this.currentSelectedNode&&this.appendTestOutput(t)}handleErrorNotification(e,t){const s=e.getCurrentTest(t.testID);s.outputEvents.push(t),s===this.currentSelectedNode&&this.appendTestOutput(t)}}g.isNewTestRun=!0,g.nextFailureIsFirst=!0,t.TestResultsProvider=g;class f{constructor(e,t){this.path=e,this.node=t,this.currentRunNumber=1,this.groups={},this.tests={}}getAllGroups(e=!1){return a.uniq(Object.keys(this.groups).map(e=>this.groups[e]).filter(t=>e||!t.hidden&&!t.isPhantomGroup))}getAllTests(e=!1){return a.uniq(Object.keys(this.tests).map(e=>this.tests[e]).filter(t=>e||!t.hidden))}getCurrentGroup(e){return this.groups[`${this.currentRunNumber}_${e}`]}getCurrentTest(e){return this.tests[`${this.currentRunNumber}_${e}`]}getMyGroup(e,t){return this.groups[`${e}_${t}`]}getMyTest(e,t){return this.tests[`${e}_${t}`]}storeGroup(e,t){return this.groups[`${this.currentRunNumber}_${e}`]=t}storeTest(e,t){return this.tests[`${this.currentRunNumber}_${e}`]=t}reuseMatchingGroup(e,t,s){const r=this.getAllGroups().filter(s=>s.group.name===t.name&&s.suiteRunNumber!==e).sort((e,s)=>Math.abs(e.group.line-t.line)-Math.abs(s.group.line-t.line)),i=r.length?r[0]:void 0;return i&&(s(i.parent),i.suiteRunNumber=this.currentRunNumber,this.storeGroup(t.id,i)),i}reuseMatchingTest(e,t,s){const r=this.getAllTests().filter(s=>s.test.name===t.name&&s.suiteRunNumber!==e),i=c.sortBy(r,e=>Math.abs(e.test.line-t.line)),n=i.length?i[0]:void 0;return n&&(s(n.parent),n.suiteRunNumber=this.currentRunNumber,this.storeTest(t.id,n)),n}}class m extends i.TreeItem{constructor(){super(...arguments),this._isStale=!1,this._status=o.TestStatus.Unknown,this._sort=S.Middle,this.suiteRunNumber=0,this.isPotentiallyDeleted=!1}get status(){return this._status}set status(e){this._status=e,this.iconPath=w(e,this.isStale),e!==o.TestStatus.Errored&&e!==o.TestStatus.Failed&&e!==o.TestStatus.Passed&&e!==o.TestStatus.Skipped||(this.isStale=!1,this.isPotentiallyDeleted=!1,this._sort=function(e){return e===o.TestStatus.Failed||e===o.TestStatus.Errored?S.Top:S.Middle}(e))}get isStale(){return this._isStale}set isStale(e){this._isStale=e,this.iconPath=w(this.status,this.isStale)}get sort(){return this._sort}}t.TestItemTreeItem=m;class v extends m{constructor(e){super(i.Uri.file(e.path),i.TreeItemCollapsibleState.Collapsed),this.groups=[],this.tests=[],this.suite=e,this.contextValue=n.DART_TEST_SUITE_NODE_CONTEXT,this.resourceUri=i.Uri.file(e.path),this.description=!0,this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_${this.suite.id}`,this.status=o.TestStatus.Unknown,this.command={command:"_dart.displaySuite",arguments:[this],title:""}}get children(){return[...a.flatMap(this.groups.filter(e=>e.isPhantomGroup),e=>e.children),...this.groups.filter(e=>!e.isPhantomGroup&&!e.hidden),...this.tests.filter(e=>!e.hidden)]}get suite(){return this._suite}set suite(e){this._suite=e}}t.SuiteTreeItem=v;class b extends m{constructor(e,t){super(t.name,i.TreeItemCollapsibleState.Collapsed),this.suite=e,this.groups=[],this.tests=[],this.suiteRunNumber=e.currentRunNumber,this.group=t,this.contextValue=n.DART_TEST_GROUP_NODE_CONTEXT,this.resourceUri=i.Uri.file(e.path),this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_group_${this.group.id}`,this.status=o.TestStatus.Unknown,this.command={command:"_dart.displayGroup",arguments:[this],title:""}}get isPhantomGroup(){return!this.group.name&&this.parent instanceof v}get hidden(){return this.children.every(e=>e instanceof b&&e.hidden||e instanceof y&&e.hidden)}get parent(){const e=this.group.parentID?this.suite.getMyGroup(this.suiteRunNumber,this.group.parentID):this.suite.node;return e instanceof b&&e.isPhantomGroup?e.parent:e}get children(){return[].concat(this.groups.filter(e=>!e.hidden)).concat(this.tests.filter(e=>!e.hidden))}get group(){return this._group}set group(e){this._group=e;const t=this.parent;this.label=t&&t instanceof b&&t.fullName&&e.name&&e.name.startsWith(`${t.fullName} `)?e.name.substr(t.fullName.length+1):e.name}get fullName(){return this._group.name}}class y extends m{constructor(e,t,s=!1){super(t.name,i.TreeItemCollapsibleState.None),this.suite=e,this.hidden=s,this.outputEvents=[],this.suiteRunNumber=e.currentRunNumber,this.test=t,this.contextValue=n.DART_TEST_TEST_NODE_CONTEXT,this.resourceUri=i.Uri.file(e.path),this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_test_${this.test.id}`,this.status=o.TestStatus.Unknown,this.command={command:"_dart.displayTest",arguments:[this],title:""}}get parent(){const e=this.test.groupIDs&&this.test.groupIDs.length?this.suite.getMyGroup(this.suiteRunNumber,this.test.groupIDs[this.test.groupIDs.length-1]):this.suite.node;return e instanceof b&&e.isPhantomGroup?e.parent:e}get test(){return this._test}set test(e){this._test=e,this.outputEvents.length=0;const t=this.parent;this.label=t&&t instanceof b&&t.fullName&&e.name.startsWith(`${t.fullName} `)?e.name.substr(t.fullName.length+1):e.name}get fullName(){return this._test.name}}function w(e,t){let s;switch(e){case o.TestStatus.Running:s="running";break;case o.TestStatus.Passed:s=t?"pass_stale":"pass";break;case o.TestStatus.Failed:case o.TestStatus.Errored:s=t?"fail_stale":"fail";break;case o.TestStatus.Skipped:s=t?"skip_stale":"skip";break;case o.TestStatus.Unknown:s="unknown";break;case o.TestStatus.Waiting:s="loading";break;default:s=void 0}return s&&d.extensionPath?i.Uri.file(r.join(d.extensionPath,`media/icons/tests/${s}.svg`)):void 0}var S;!function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(S||(S={}))},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.waitFor=function(e,t=500,s=1e4,i){return r(this,void 0,void 0,function*(){let r=s;for(;r>0&&(!i||!i.isCancellationRequested);){const s=e();if(s)return s;yield new Promise(e=>setTimeout(e,t)),r-=t}})}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(0),o=s(3),a=s(45),c=s(46);function u(e){const t={};for(const s of e.edits){t[s.file]||(t[s.file]=[]);for(const e of s.edits){if(t[s.file].find(t=>t.offset<=e.offset))return!0;t[s.file].push(e)}}return!1}t.EditCommands=class{constructor(e,t,s){this.logger=e,this.context=t,this.analyzer=s,this.commands=[],this.commands.push(n.commands.registerCommand("_dart.organizeImports",this.organizeImports,this),n.commands.registerCommand("dart.sortMembers",this.sortMembers,this),n.commands.registerCommand("_dart.applySourceChange",this.applyEdits,this),n.commands.registerCommand("_dart.jumpToLineColInUri",this.jumpToLineColInUri,this),n.commands.registerCommand("_dart.showCode",c.showCode,this),n.commands.registerCommand("dart.completeStatement",this.completeStatement,this))}getActiveDoc(){return n.window.activeTextEditor&&n.window.activeTextEditor.document}organizeImports(e){return e=e||this.getActiveDoc(),this.sendEdit(this.analyzer.editOrganizeDirectives,"Organize Imports",e)}jumpToLineColInUri(e,t,s){return r(this,void 0,void 0,function*(){if(!e||"file"!==e.scheme)return;const r=yield n.workspace.openTextDocument(e),i=yield n.window.showTextDocument(r);if(t&&s){const e=r.lineAt(t>0?t-1:0),s=e.range.start.translate({characterDelta:e.firstNonWhitespaceCharacterIndex});c.showCode(i,e.range,e.range,new n.Range(s,s))}})}sortMembers(e){return e=e||this.getActiveDoc(),this.sendEdit(this.analyzer.editSortMembers,"Sort Members",e)}completeStatement(){return r(this,void 0,void 0,function*(){const e=n.window.activeTextEditor;if(!e||!e.selection||!this.analyzer.capabilities.hasCompleteStatementFix)return;const t=e.document,s=o.fsPath(t.uri),r=t.offsetAt(e.selection.end),i=yield this.analyzer.editGetStatementCompletion({file:s,offset:r});i&&i.change&&(yield this.applyEdits(t,i.change))})}sendEdit(e,t,s){return r(this,void 0,void 0,function*(){if(!s||!a.isDartDocument(s))return void n.window.showWarningMessage("Not a Dart file.");const r=s.version;e=e.bind(this.analyzer);try{const i=(yield e({file:o.fsPath(s.uri)})).edit;if(0===i.edits.length)return;if(s.isClosed)return void n.window.showErrorMessage(`Error running ${t}: Document has been closed.`);if(s.version!==r)return void n.window.showErrorMessage(`Error running ${t}: Document has been modified.`);const a=new n.WorkspaceEdit;i.edits.forEach(e=>{const t=new n.Range(s.positionAt(e.offset),s.positionAt(e.offset+e.length));a.replace(s.uri,t,e.replacement)}),yield n.workspace.applyEdit(a)}catch(e){n.window.showErrorMessage(`Error running ${t}: ${e.message}.`)}})}dispose(){for(const e of this.commands)e.dispose()}applyEdits(e,t){return r(this,void 0,void 0,function*(){if(1===t.edits.length&&t.linkedEditGroups&&0!==t.linkedEditGroups.length)return this.applyEditsWithSnippets(e,t);const s=u(t);s&&this.logger.warn("Falling back to sequential edits due to overlapping edits in server.");const r=s;let o=r?void 0:new n.WorkspaceEdit;for(const e of t.edits){const t=n.Uri.file(e.file);if(!i.existsSync(e.file)&&e.edits.find(e=>0!==e.offset||0!==e.length)){this.logger.error(`Unable to edit file ${e.file} because it does not exist and had an edit that was not the start of the file`),n.window.showErrorMessage(`Unable to edit file ${e.file} because it does not exist and had an edit that was not the start of the file`);continue}const s=i.existsSync(e.file)?yield n.workspace.openTextDocument(t):void 0;o&&o.createFile(t,{ignoreIfExists:!0});for(const i of e.edits){o||(o=new n.WorkspaceEdit).createFile(t,{ignoreIfExists:!0});const e=s?new n.Range(s.positionAt(i.offset),s.positionAt(i.offset+i.length)):new n.Range(new n.Position(0,0),new n.Position(0,0));o.replace(t,e,i.replacement),r&&(yield n.workspace.applyEdit(o),o=void 0)}}if(o&&(yield n.workspace.applyEdit(o)),t.selection){const e=n.Uri.file(t.selection.file),s=yield n.workspace.openTextDocument(e),r=yield n.window.showTextDocument(s),i=s.positionAt(t.selection.offset),o=new n.Selection(i,i);r.selection=o}})}applyEditsWithSnippets(e,t){return r(this,void 0,void 0,function*(){const s=t.edits[0],r=yield n.workspace.openTextDocument(s.file),i=yield n.window.showTextDocument(r);yield i.edit(e=>{s.edits.forEach(t=>{e.replace(new n.Range(r.positionAt(t.offset),r.positionAt(t.offset+t.length)),t.replacement)})});const o=i.document.getText(),a=[];let c=1;t.linkedEditGroups.forEach(e=>{e.positions.forEach(t=>{const s=o.substr(t.offset,e.length);let r=e.suggestions?e.suggestions.map(e=>e.value):void 0;s&&r&&-1===r.indexOf(s)&&(r=[s,...r]),a.push({offset:t.offset,length:e.length,defaultValue:s,choices:r,placeholderNumber:c})}),c++}),a.sort((e,t)=>e.offset-t.offset);const u=new n.SnippetString,l=a[0],h=a[a.length-1],d=l.offset,p=h.offset+h.length;let g=d;a.forEach(e=>{g!==e.offset&&u.appendText(o.substring(g,e.offset)),e.choices&&e.choices.length>1?u.appendText("").value+="${"+e.placeholderNumber+"|"+e.choices.map(e=>this.snippetStringEscape(e)).join(",")+"|}":u.appendPlaceholder(e.defaultValue,e.placeholderNumber),g=e.offset+e.length}),yield i.insertSnippet(u,new n.Range(r.positionAt(d),r.positionAt(p))),yield n.window.showTextDocument(e)})}snippetStringEscape(e){return e.replace(/\$|}|\\|,/g,"\\$&")}},t.hasOverlappingEdits=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(13);t.findNearestOutlineNode=function(e,t,s=!1,i=["CLASS","METHOD","GETTER","SETTER"]){const n=r.openFileTracker.getOutlineFor(e.uri);return n&&function e(t,s,r,i){if(t)for(const n of t){const t=n.offset,o=n.offset+n.length;if(t>s||o<s)continue;const a=!r||!n.element||!n.element.location||s>=t&&s<=n.element.location.offset+n.element.location.length;return e(n.children,s,r,i)||(-1!==i.indexOf(n.element.kind)&&a?n:void 0)}}([n],e.offsetAt(t),s,i)}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(12),o=s(1),a=s(0),c=s(0),u=s(5),l=s(7),h=s(11),d=s(4),p=s(17),g=s(31),f=s(9),m=s(54),v=s(3),b=s(8),y=s(24),w=s(73),S=s(127),E=s(128),T=s(129),C=s(130),P=s(2),k=s(10),_=s(30),R=new RegExp("^[a-z][a-z0-9_]*$");let x,F,D=0;t.SdkCommands=class{constructor(e,t,s,u,l,h,d){this.logger=e,this.context=t,this.workspace=s,this.sdkUtils=u,this.pubGlobal=l,this.flutterCapabilities=h,this.deviceManager=d,this.runningCommands={},this.sdks=s.sdks;const p=new C.DartSdkManager(this.logger,this.sdks);if(t.subscriptions.push(a.commands.registerCommand("dart.changeSdk",()=>p.changeSdk())),s.hasAnyFlutterProjects){const e=new C.FlutterSdkManager(this.logger,s.sdks);t.subscriptions.push(a.commands.registerCommand("dart.changeFlutterSdk",()=>e.changeSdk()))}t.subscriptions.push(a.commands.registerCommand("dart.getPackages",e=>r(this,void 0,void 0,function*(){if(e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to get packages for"))){"string"==typeof e&&(e=a.Uri.file(e));try{return P.isInsideFlutterProject(e)?this.runFlutter(["packages","get"],e):this.runPub(["get"],e)}finally{w.DartHoverProvider.clearPackageMapCaches()}}}))),t.subscriptions.push(a.commands.registerCommand("dart.upgradePackages",e=>r(this,void 0,void 0,function*(){return e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to upgrade packages in")),"string"==typeof e&&(e=a.Uri.file(e)),P.isInsideFlutterProject(e)?this.runFlutter(["packages","upgrade"],e):this.runPub(["upgrade"],e)}))),t.subscriptions.push(a.commands.registerCommand("pub.get",e=>a.commands.executeCommand("dart.getPackages",e))),t.subscriptions.push(a.commands.registerCommand("pub.upgrade",e=>a.commands.executeCommand("dart.upgradePackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.get",e=>r(this,void 0,void 0,function*(){if(!e){const t=yield this.getFolderToRunCommandIn('Select the folder to run "flutter packages get" in',e);if(!t)return;e=a.Uri.file(t)}if(e&&v.fsPath(e)===s.sdks.flutter)return this.runFlutter(["update-packages"],e);try{return this.runFlutter(["packages","get"],e)}finally{w.DartHoverProvider.clearPackageMapCaches()}}))),t.subscriptions.push(a.commands.registerCommand("flutter.clean",e=>r(this,void 0,void 0,function*(){if(!e){const t=yield this.getFolderToRunCommandIn('Select the folder to run "flutter clean" in',e,!0);if(!t)return;e=a.Uri.file(t)}return this.runFlutter(["clean"],e)}))),t.subscriptions.push(a.commands.registerCommand("_flutter.screenshot.touchBar",e=>a.commands.executeCommand("flutter.screenshot",e))),t.subscriptions.push(a.commands.registerCommand("flutter.screenshot",()=>r(this,void 0,void 0,function*(){let e=!1;if((!this.flutterScreenshotPath||b.config.flutterScreenshotPath&&this.flutterScreenshotPath!==b.config.flutterScreenshotPath)&&(this.flutterScreenshotPath=b.config.flutterScreenshotPath,e=!0),!this.flutterScreenshotPath){const t=yield c.window.showOpenDialog({canSelectFolders:!0,openLabel:"Set screenshots folder"});if(!(t&&t.length>0))return;this.flutterScreenshotPath=t[0].path,e=!0}f.mkDirRecursive(this.flutterScreenshotPath);const t=this.deviceManager&&this.deviceManager.currentDevice?this.deviceManager.currentDevice.id:void 0,s=t?["screenshot","-d",t]:["screenshot"];yield this.runFlutterInFolder(this.flutterScreenshotPath,s,"screenshot"),e&&(yield a.window.showInformationMessage(`Screenshots will be saved to ${this.flutterScreenshotPath}`,"Show Folder"))&&(yield a.commands.executeCommand("revealFileInOS",c.Uri.file(this.flutterScreenshotPath)))}))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.upgrade",e=>a.commands.executeCommand("dart.upgradePackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.doctor",e=>{if(!s.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.doctor");const t=o.join(n.tmpdir(),"dart-code-cmd-run");return i.existsSync(t)||i.mkdirSync(t),this.runFlutterInFolder(t,["doctor"],"flutter")})),t.subscriptions.push(a.commands.registerCommand("flutter.upgrade",e=>r(this,void 0,void 0,function*(){if(!s.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.upgrade");const e=o.join(n.tmpdir(),"dart-code-cmd-run");i.existsSync(e)||i.mkdirSync(e),yield this.runFlutterInFolder(e,["upgrade"],"flutter"),yield P.reloadExtension()}))),t.subscriptions.push(a.commands.registerCommand("flutter.createProject",e=>this.createFlutterProject())),t.subscriptions.push(a.commands.registerCommand("_dart.flutter.createSampleProject",e=>this.createFlutterSampleProject())),t.subscriptions.push(a.commands.registerCommand("flutter.createWebProject",e=>this.createFlutterWebProject())),t.subscriptions.push(a.commands.registerCommand("dart.createProject",e=>this.createDartProject())),t.subscriptions.push(a.commands.registerCommand("_dart.create",(e,t)=>{const s=["global","run","stagehand",t];return this.runPubInFolder(e,s,t)})),t.subscriptions.push(a.commands.registerCommand("_flutter.create",(e,t,s)=>{const r=["create"];return t&&(r.push("--project-name"),r.push(t)),b.config.flutterCreateOrganization&&(r.push("--org"),r.push(b.config.flutterCreateOrganization)),b.config.flutterCreateIOSLanguage&&(r.push("--ios-language"),r.push(b.config.flutterCreateIOSLanguage)),b.config.flutterCreateAndroidLanguage&&(r.push("--android-language"),r.push(b.config.flutterCreateAndroidLanguage)),s&&(r.push("--sample"),r.push(s),r.push("--overwrite")),r.push("."),this.runFlutterInFolder(e,r,t)})),t.subscriptions.push(a.commands.registerCommand("_flutter.clean",(e,t)=>(t=t||o.basename(e),this.runFlutterInFolder(e,["clean"],t)))),this.setupPubspecWatcher(t)}setupPubspecWatcher(e){e.subscriptions.push(a.workspace.onWillSaveTextDocument(e=>{"pubspec.yaml"===o.basename(v.fsPath(e.document.uri)).toLowerCase()&&(F=e.reason)}));const t=a.workspace.createFileSystemWatcher("**/pubspec.yaml");e.subscriptions.push(t),t.onDidChange(this.handlePubspecChange,this),t.onDidCreate(this.handlePubspecChange,this)}handlePubspecChange(e){const t=b.config.for(e);if(!t.runPubGetOnPubspecChanges)return;if(D>0)return void this.logger.info("Skipping package fetch because project creation is in progress");if(this.workspace.hasProjectsInFuchsiaTree&&!t.runPubGetOnPubspecChangesIsConfiguredExplicitly)return;x&&clearTimeout(x);const s=F===a.TextDocumentSaveReason.FocusOut||F===a.TextDocumentSaveReason.AfterDelay?1e4:1e3;x=setTimeout(()=>{x=void 0,F=void 0,this.fetchPackagesOrPrompt(e)},s)}fetchPackagesOrPrompt(e,t){const s=t&&t.alwaysPrompt,r=P.getDartWorkspaceFolders().map(e=>v.fsPath(e.uri)),i=f.findProjectFolders(r,{requirePubspec:!0}).map(a.Uri.file).filter(e=>b.config.for(e).promptToGetPackages).filter(S.isPubGetProbablyRequired);s||0!==i.length?s||1!==i.length?i.length&&S.promptToRunPubGet(i):a.commands.executeCommand("dart.getPackages",i[0]):a.commands.executeCommand("dart.getPackages",e)}runCommandForWorkspace(e,t,s,i){return r(this,void 0,void 0,function*(){const r=yield this.getFolderToRunCommandIn(t,i);if(!r)return;const n=a.workspace.getWorkspaceFolder(a.Uri.file(r));if(!n)throw this.logger.error(`Failed to get workspace folder for ${r}`),new Error(`Failed to get workspace folder for ${r}`);const c=v.fsPath(n.uri),u=o.relative(c,r)||o.basename(r);return e(r,s,u)})}getFolderToRunCommandIn(e,t,s=!1){return r(this,void 0,void 0,function*(){let r=t&&v.fsPath(t);const i=(r=r||a.window.activeTextEditor&&v.fsPath(a.window.activeTextEditor.document.uri))&&y.locateBestProjectRoot(r);if(i)return i;const n=P.getDartWorkspaceFolders().map(e=>v.fsPath(e.uri)),o=f.findProjectFolders(n,{sort:!0}).filter(s?P.isFlutterProjectFolder:()=>!0);if(o&&o.length)return this.showFolderPicker(o,e);{const e=s?"Flutter":"Dart/Flutter";a.window.showWarningMessage(`No ${e} projects were found.`)}})}showFolderPicker(e,t){return r(this,void 0,void 0,function*(){if(1===e.length)return e[0];const s=e.map(e=>{const t=a.workspace.getWorkspaceFolder(c.Uri.file(e));if(!t)return;const s=o.dirname(v.fsPath(t.uri));return{description:P.homeRelativePath(s),label:o.relative(s,e),path:e}}).filter(P.notUndefined),r=yield a.window.showQuickPick(s,{placeHolder:t});return r&&r.path})}runFlutter(e,t){return this.runCommandForWorkspace(this.runFlutterInFolder.bind(this),`Select the folder to run "flutter ${e.join(" ")}" in`,e,t)}runFlutterInFolder(e,t,s){if(!this.sdks.flutter)throw new Error("Flutter SDK not available");const r=o.join(this.sdks.flutter,u.flutterPath);return this.runCommandInFolder(s,"flutter",e,r,k.globalFlutterArgs.concat(t))}runPub(e,t){return this.runCommandForWorkspace(this.runPubInFolder.bind(this),`Select the folder to run "pub ${e.join(" ")}" in`,e,t)}runPubInFolder(e,t,s){if(!this.sdks.dart)throw new Error("Flutter SDK not available");const r=o.join(this.sdks.dart,u.pubPath);return t=t.concat(...b.config.for(a.Uri.file(e)).pubAdditionalArgs),this.runCommandInFolder(s,"pub",e,r,t)}runCommandInFolder(e,t,s,r,i,n=!1){const o=t.substr(0,1).toUpperCase()+t.substr(1),u=_.createChannel(o);u.show(!0);const d=`${s}|${t}|${i}`,p=this.runningCommands[d];return p&&!p.hasStarted?Promise.resolve(void 0):a.window.withProgress({cancellable:!0,location:c.ProgressLocation.Notification,title:`${t} ${i.join(" ")}`},(n,o)=>{p?(n.report({message:"terminating previous command..."}),p.cancel()):u.clear();const a=new A(()=>{u.appendLine(`[${e}] ${t} ${i.join(" ")}`),n.report({message:"running..."});const o=k.safeSpawn(s,r,i);return _.runProcessInChannel(o,u),this.logger.info(`(PROC ${o.pid}) Spawned ${r} ${i.join(" ")} in ${s}`,l.LogCategory.CommandProcesses),h.logProcess(this.logger,l.LogCategory.CommandProcesses,o),o},p);return this.runningCommands[d]=a,o.onCancellationRequested(()=>a.cancel()),a.completed})}isFlutterWebTemplate(e){return null!=e.categories&&-1!==e.categories.indexOf("flutter")&&-1!==e.categories.indexOf("web")}createDartProject(){return r(this,void 0,void 0,function*(){return this.createStagehandProject("dart.createProject",u.DART_STAGEHAND_PROJECT_TRIGGER_FILE,!1,e=>!this.isFlutterWebTemplate(e))})}createFlutterWebProject(){return r(this,void 0,void 0,function*(){return this.createStagehandProject("flutter.createWebProject",u.FLUTTER_STAGEHAND_PROJECT_TRIGGER_FILE,!0,e=>this.isFlutterWebTemplate(e))})}createStagehandProject(e,t,s,n){return r(this,void 0,void 0,function*(){if(!this.sdks||!this.sdks.dart)return void this.sdkUtils.showDartActivationFailure(e);const r=new E.Stagehand(this.logger,this.sdks,this.pubGlobal);if(!(yield r.promptToInstallIfRequired()))return;let u;try{u=yield r.getTemplates()}catch(e){return void a.window.showErrorMessage(`Unable to execute Stagehand. ${e}`)}const l=u.filter(n),h=p.sortBy(l,e=>e.label).map(e=>({description:e.name,detail:e.description,label:e.label,template:e})),d=s&&1===h.length?h[0]:yield a.window.showQuickPick(h,{matchOnDescription:!0,placeHolder:"Which Dart template?"});if(!d)return;const g=yield a.window.showInputBox({prompt:"Enter a name for your new project",placeHolder:"hello_world",validateInput:this.validateDartProjectName});if(!g)return;const f=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:"Select a folder to create the project in"});if(!f||1!==f.length)return;const m=f[0],b=c.Uri.file(o.join(v.fsPath(m),g));if(i.existsSync(v.fsPath(b)))return void a.window.showErrorMessage(`A folder named ${g} already exists in ${v.fsPath(m)}`);i.mkdirSync(v.fsPath(b)),i.writeFileSync(o.join(v.fsPath(b),t),JSON.stringify(d.template));const y=!(!a.workspace.workspaceFolders||!a.workspace.workspaceFolders.length);a.commands.executeCommand("vscode.openFolder",b,y)})}createFlutterProject(){return r(this,void 0,void 0,function*(){if(!this.sdks||!this.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.createProject");const e=yield a.window.showInputBox({prompt:"Enter a name for your new project",placeHolder:"hello_world",validateInput:this.validateFlutterProjectName});if(!e)return;const t=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:"Select a folder to create the project in"});if(!t||1!==t.length)return;const s=t[0],r=c.Uri.file(o.join(v.fsPath(s),e));if(i.existsSync(v.fsPath(r)))return void a.window.showErrorMessage(`A folder named ${e} already exists in ${v.fsPath(s)}`);i.mkdirSync(v.fsPath(r)),i.writeFileSync(o.join(v.fsPath(r),u.FLUTTER_CREATE_PROJECT_TRIGGER_FILE),"");const n=!(!a.workspace.workspaceFolders||!a.workspace.workspaceFolders.length);a.commands.executeCommand("vscode.openFolder",r,n)})}createFlutterSampleProject(){return r(this,void 0,void 0,function*(){if(!this.sdks||!this.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("_dart.flutter.createSampleProject");let e;try{e=yield T.getFlutterSnippets(this.logger,this.sdks,this.flutterCapabilities)}catch(e){return void a.window.showErrorMessage("Unable to retrieve Flutter documentation snippets")}const t=p.sortBy(e,e=>e.element),s=yield a.window.showQuickPick(t.map(e=>({description:`${e.package}/${e.library}`,detail:g.stripMarkdown(e.description),label:e.element,snippet:e})),{matchOnDescription:!0,placeHolder:"Which Flutter sample?"});return s?m.createFlutterSampleInTempFolder(this.flutterCapabilities,s.snippet.id):void 0})}validateDartProjectName(e){return R.test(e)?-1!==["dart","test"].indexOf(e)?`You may not use ${e} as the name for a dart project`:void 0:"Dart project names should be all lowercase, with underscores to separate words"}validateFlutterProjectName(e){return R.test(e)?-1!==["flutter","flutter_test","test"].indexOf(e)?`You may not use ${e} as the name for a flutter project`:void 0:"Flutter project names should be all lowercase, with underscores to separate words"}},t.markProjectCreationStarted=function(){D++},t.markProjectCreationEnded=function(){D--};class A{constructor(e,t){this.spawn=e,this.processNumber=A.processNumber++,this.completer=new d.PromiseCompleter,this.completed=this.completer.promise,this.isCancelled=!1,t?t.completed.then(()=>this.start()):this.start()}get hasStarted(){return void 0!==this.process}start(){if(this.process)throw new Error(`${this.processNumber} Can't start an already started process!`);this.isCancelled?this.completer.resolve(void 0):(this.process=this.spawn(),this.process.on("close",e=>this.completer.resolve(e)))}cancel(){this.isCancelled=!0}}A.processNumber=1},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(31),o=s(3),a=s(25);class c{constructor(e,t){this.logger=e,this.analyzer=t}provideHover(e,t,s){return r(this,void 0,void 0,function*(){try{const r=yield this.analyzer.analysisGetHover({file:o.fsPath(e.uri),offset:e.offsetAt(t)});if(s.isCancellationRequested||0===r.hovers.length)return;const n=r.hovers[0],a=this.getHoverData(e.uri,n);if(!a)return;const c=new i.Range(e.positionAt(n.offset),e.positionAt(n.offset+n.length));return new i.Hover([{language:"dart",value:a.displayString},a.documentation||void 0],c.isSingleLine?c:void 0)}catch(e){this.logger.error(e)}})}getHoverData(e,t){if(!t.elementDescription)return;if("import prefix"===t.elementKind)return;const s=t.elementDescription,r=t.dartdoc,i=t.propagatedType;let o="";s&&(o+=(t.isDeprecated?"(deprecated) ":"")+`${s}\n`),i&&(o+=`propogated type: ${i.trim()}`);let a=n.cleanDartdoc(r);if(this.analyzer.capabilities.hasNewHoverLibraryFormat)t.containingLibraryName&&(a=`*${t.containingLibraryName}*\n\n`+a);else{const s=t.containingLibraryName,r=t.containingLibraryPath;if(s)a=`*${s}*\n\n`+a;else if(r){const t=c.getPackageMapFor(e),s=t&&t.convertFileToPackageUri(r,!1),i=s&&s.split("/")[0];i&&(a=`*${i}*\n\n`+a)}}return{displayString:o.trim(),documentation:a.trim()}}static getPackageMapFor(e){const t=o.fsPath(e);if(this.packageMaps[t])return this.packageMaps[t];const s=a.PackageMap.findPackagesFile(t),r=s&&new a.PackageMap(s);return r&&(this.packageMaps[t]=r),r}static clearPackageMapCaches(){this.packageMaps={}}}c.packageMaps={},t.DartHoverProvider=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);class i{static get empty(){return new i("0.0.0")}constructor(e){this.version=e}get supportsPidFileForMachine(){return r.versionIsAtLeast(this.version,"0.10.0")}get supportsCreatingSamples(){return r.versionIsAtLeast(this.version,"1.0.0")}get supportsMultipleSamplesPerElement(){return r.versionIsAtLeast(this.version,"1.2.2")}get supportsDevTools(){return r.versionIsAtLeast(this.version,"1.1.0")}get hasTestGroupFix(){return r.versionIsAtLeast(this.version,"1.3.4")}get hasEvictBug(){return!r.versionIsAtLeast(this.version,"1.2.2")}get supportsFlutterCreateListSamples(){return r.versionIsAtLeast(this.version,"1.3.10")}get supportsUrisForFlutterAttach(){return r.versionIsAtLeast(this.version,"1.5.3")}get webSupportsDebugging(){return!1}}t.FlutterCapabilities=i},function(e,t){var s;t=e.exports=H,s="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var r=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,n=t.re=[],o=t.src=[],a=0,c=a++;o[c]="0|[1-9]\\d*";var u=a++;o[u]="[0-9]+";var l=a++;o[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var h=a++;o[h]="("+o[c]+")\\.("+o[c]+")\\.("+o[c]+")";var d=a++;o[d]="("+o[u]+")\\.("+o[u]+")\\.("+o[u]+")";var p=a++;o[p]="(?:"+o[c]+"|"+o[l]+")";var g=a++;o[g]="(?:"+o[u]+"|"+o[l]+")";var f=a++;o[f]="(?:-("+o[p]+"(?:\\."+o[p]+")*))";var m=a++;o[m]="(?:-?("+o[g]+"(?:\\."+o[g]+")*))";var v=a++;o[v]="[0-9A-Za-z-]+";var b=a++;o[b]="(?:\\+("+o[v]+"(?:\\."+o[v]+")*))";var y=a++,w="v?"+o[h]+o[f]+"?"+o[b]+"?";o[y]="^"+w+"$";var S="[v=\\s]*"+o[d]+o[m]+"?"+o[b]+"?",E=a++;o[E]="^"+S+"$";var T=a++;o[T]="((?:<|>)?=?)";var C=a++;o[C]=o[u]+"|x|X|\\*";var P=a++;o[P]=o[c]+"|x|X|\\*";var k=a++;o[k]="[v=\\s]*("+o[P]+")(?:\\.("+o[P]+")(?:\\.("+o[P]+")(?:"+o[f]+")?"+o[b]+"?)?)?";var _=a++;o[_]="[v=\\s]*("+o[C]+")(?:\\.("+o[C]+")(?:\\.("+o[C]+")(?:"+o[m]+")?"+o[b]+"?)?)?";var R=a++;o[R]="^"+o[T]+"\\s*"+o[k]+"$";var x=a++;o[x]="^"+o[T]+"\\s*"+o[_]+"$";var F=a++;o[F]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var D=a++;o[D]="(?:~>?)";var A=a++;o[A]="(\\s*)"+o[D]+"\\s+",n[A]=new RegExp(o[A],"g");var O=a++;o[O]="^"+o[D]+o[k]+"$";var I=a++;o[I]="^"+o[D]+o[_]+"$";var L=a++;o[L]="(?:\\^)";var M=a++;o[M]="(\\s*)"+o[L]+"\\s+",n[M]=new RegExp(o[M],"g");var N=a++;o[N]="^"+o[L]+o[k]+"$";var $=a++;o[$]="^"+o[L]+o[_]+"$";var j=a++;o[j]="^"+o[T]+"\\s*("+S+")$|^$";var U=a++;o[U]="^"+o[T]+"\\s*("+w+")$|^$";var W=a++;o[W]="(\\s*)"+o[T]+"\\s*("+S+"|"+o[k]+")",n[W]=new RegExp(o[W],"g");var q=a++;o[q]="^\\s*("+o[k]+")\\s+-\\s+("+o[k]+")\\s*$";var B=a++;o[B]="^\\s*("+o[_]+")\\s+-\\s+("+o[_]+")\\s*$";var G=a++;o[G]="(<|>)?=?\\s*\\*";for(var V=0;V<35;V++)s(V,o[V]),n[V]||(n[V]=new RegExp(o[V]));function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof H)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?n[E]:n[y]).test(e))return null;try{return new H(e,t)}catch(e){return null}}function H(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof H){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>r)throw new TypeError("version is longer than "+r+" characters");if(!(this instanceof H))return new H(e,t);s("SemVer",e,t),this.options=t,this.loose=!!t.loose;var o=e.trim().match(t.loose?n[E]:n[y]);if(!o)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}t.parse=z,t.valid=function(e,t){var s=z(e,t);return s?s.version:null},t.clean=function(e,t){var s=z(e.trim().replace(/^[=v]+/,""),t);return s?s.version:null},t.SemVer=H,H.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},H.prototype.toString=function(){return this.version},H.prototype.compare=function(e){return s("SemVer.compare",this.version,this.options,e),e instanceof H||(e=new H(e,this.options)),this.compareMain(e)||this.comparePre(e)},H.prototype.compareMain=function(e){return e instanceof H||(e=new H(e,this.options)),Q(this.major,e.major)||Q(this.minor,e.minor)||Q(this.patch,e.patch)},H.prototype.comparePre=function(e){if(e instanceof H||(e=new H(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],i=e.prerelease[t];if(s("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return Q(r,i)}while(++t)},H.prototype.compareBuild=function(e){e instanceof H||(e=new H(e,this.options));var t=0;do{var r=this.build[t],i=e.build[t];if(s("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return Q(r,i)}while(++t)},H.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var s=this.prerelease.length;--s>=0;)"number"==typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);-1===s&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,s,r){"string"==typeof s&&(r=s,s=void 0);try{return new H(e,s).inc(t,r).version}catch(e){return null}},t.diff=function(e,t){if(Z(e,t))return null;var s=z(e),r=z(t),i="";if(s.prerelease.length||r.prerelease.length){i="pre";var n="prerelease"}for(var o in s)if(("major"===o||"minor"===o||"patch"===o)&&s[o]!==r[o])return i+o;return n},t.compareIdentifiers=Q;var K=/^[0-9]+$/;function Q(e,t){var s=K.test(e),r=K.test(t);return s&&r&&(e=+e,t=+t),e===t?0:s&&!r?-1:r&&!s?1:e<t?-1:1}function J(e,t,s){return new H(e,s).compare(new H(t,s))}function X(e,t,s){return J(e,t,s)>0}function Y(e,t,s){return J(e,t,s)<0}function Z(e,t,s){return 0===J(e,t,s)}function ee(e,t,s){return 0!==J(e,t,s)}function te(e,t,s){return J(e,t,s)>=0}function se(e,t,s){return J(e,t,s)<=0}function re(e,t,s,r){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e===s;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e!==s;case"":case"=":case"==":return Z(e,s,r);case"!=":return ee(e,s,r);case">":return X(e,s,r);case">=":return te(e,s,r);case"<":return Y(e,s,r);case"<=":return se(e,s,r);default:throw new TypeError("Invalid operator: "+t)}}function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ie))return new ie(e,t);s("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ne?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}t.rcompareIdentifiers=function(e,t){return Q(t,e)},t.major=function(e,t){return new H(e,t).major},t.minor=function(e,t){return new H(e,t).minor},t.patch=function(e,t){return new H(e,t).patch},t.compare=J,t.compareLoose=function(e,t){return J(e,t,!0)},t.compareBuild=function(e,t,s){var r=new H(e,s),i=new H(t,s);return r.compare(i)||r.compareBuild(i)},t.rcompare=function(e,t,s){return J(t,e,s)},t.sort=function(e,s){return e.sort(function(e,r){return t.compareBuild(e,r,s)})},t.rsort=function(e,s){return e.sort(function(e,r){return t.compareBuild(r,e,s)})},t.gt=X,t.lt=Y,t.eq=Z,t.neq=ee,t.gte=te,t.lte=se,t.cmp=re,t.Comparator=ie;var ne={};function oe(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof oe)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new oe(e.raw,t);if(e instanceof ie)return new oe(e.value,t);if(!(this instanceof oe))return new oe(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e,t){for(var s=!0,r=e.slice(),i=r.pop();s&&r.length;)s=r.every(function(e){return i.intersects(e,t)}),i=r.pop();return s}function ce(e){return!e||"x"===e.toLowerCase()||"*"===e}function ue(e,t,s,r,i,n,o,a,c,u,l,h,d){return((t=ce(s)?"":ce(r)?">="+s+".0.0":ce(i)?">="+s+"."+r+".0":">="+t)+" "+(a=ce(c)?"":ce(u)?"<"+(+c+1)+".0.0":ce(l)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+l+"-"+h:"<="+a)).trim()}function le(e,t,r){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(i=0;i<e.length;i++)if(s(e[i].semver),e[i].semver!==ne&&e[i].semver.prerelease.length>0){var n=e[i].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}function he(e,t,s){try{t=new oe(t,s)}catch(e){return!1}return t.test(e)}function de(e,t,s,r){var i,n,o,a,c;switch(e=new H(e,r),t=new oe(t,r),s){case">":i=X,n=se,o=Y,a=">",c=">=";break;case"<":i=Y,n=te,o=X,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(he(e,t,r))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],h=null,d=null;if(l.forEach(function(e){e.semver===ne&&(e=new ie(">=0.0.0")),h=h||e,d=d||e,i(e.semver,h.semver,r)?h=e:o(e.semver,d.semver,r)&&(d=e)}),h.operator===a||h.operator===c)return!1;if((!d.operator||d.operator===a)&&n(e,d.semver))return!1;if(d.operator===c&&o(e,d.semver))return!1}return!0}ie.prototype.parse=function(e){var t=this.options.loose?n[j]:n[U],s=e.match(t);if(!s)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==s[1]?s[1]:"","="===this.operator&&(this.operator=""),s[2]?this.semver=new H(s[2],this.options.loose):this.semver=ne},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return s("Comparator.test",e,this.options.loose),this.semver===ne||e===ne||("string"==typeof e&&(e=new H(e,this.options)),re(e,this.operator,this.semver,this.options))},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Comparator is required");var s;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(s=new oe(e.value,t),he(this.value,s,t));if(""===e.operator)return""===e.value||(s=new oe(this.value,t),he(e.semver,s,t));var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),n=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||i||n&&o||a||c},t.Range=oe,oe.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},oe.prototype.toString=function(){return this.range},oe.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?n[B]:n[q];e=e.replace(r,ue),s("hyphen replace",e),e=e.replace(n[W],"$1$2$3"),s("comparator trim",e,n[W]),e=(e=(e=e.replace(n[A],"$1~")).replace(n[M],"$1^")).split(/\s+/).join(" ");var i=t?n[j]:n[U],o=e.split(" ").map(function(e){return function(e,t){return s("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){s("caret",e,t);var r=t.loose?n[$]:n[N];return e.replace(r,function(t,r,i,n,o){var a;return s("caret",e,t,r,i,n,o),ce(r)?a="":ce(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":ce(n)?a="0"===r?">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":">="+r+"."+i+".0 <"+(+r+1)+".0.0":o?(s("replaceCaret pr",o),a="0"===r?"0"===i?">="+r+"."+i+"."+n+"-"+o+" <"+r+"."+i+"."+(+n+1):">="+r+"."+i+"."+n+"-"+o+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+n+"-"+o+" <"+(+r+1)+".0.0"):(s("no pr"),a="0"===r?"0"===i?">="+r+"."+i+"."+n+" <"+r+"."+i+"."+(+n+1):">="+r+"."+i+"."+n+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+n+" <"+(+r+1)+".0.0"),s("caret return",a),a})}(e,t)}).join(" ")}(e,t),s("caret",e),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){var r=t.loose?n[I]:n[O];return e.replace(r,function(t,r,i,n,o){var a;return s("tilde",e,t,r,i,n,o),ce(r)?a="":ce(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":ce(n)?a=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":o?(s("replaceTilde pr",o),a=">="+r+"."+i+"."+n+"-"+o+" <"+r+"."+(+i+1)+".0"):a=">="+r+"."+i+"."+n+" <"+r+"."+(+i+1)+".0",s("tilde return",a),a})}(e,t)}).join(" ")}(e,t),s("tildes",e),e=function(e,t){return s("replaceXRanges",e,t),e.split(/\s+/).map(function(e){return function(e,t){e=e.trim();var r=t.loose?n[x]:n[R];return e.replace(r,function(t,r,i,n,o,a){s("xRange",e,t,r,i,n,o,a);var c=ce(i),u=c||ce(n),l=u||ce(o),h=l;return"="===r&&h&&(r=""),c?t=">"===r||"<"===r?"<0.0.0":"*":r&&h?(u&&(n=0),o=0,">"===r?(r=">=",u?(i=+i+1,n=0,o=0):(n=+n+1,o=0)):"<="===r&&(r="<",u?i=+i+1:n=+n+1),t=r+i+"."+n+"."+o):u?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0"),s("xRange return",t),t})}(e,t)}).join(" ")}(e,t),s("xrange",e),e=function(e,t){return s("replaceStars",e,t),e.trim().replace(n[G],"")}(e,t),s("stars",e),e}(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(e){return!!e.match(i)})),o=o.map(function(e){return new ie(e,this.options)},this)},oe.prototype.intersects=function(e,t){if(!(e instanceof oe))throw new TypeError("a Range is required");return this.set.some(function(s){return ae(s,t)&&e.set.some(function(e){return ae(e,t)&&s.every(function(s){return e.every(function(e){return s.intersects(e,t)})})})})},t.toComparators=function(e,t){return new oe(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},oe.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new H(e,this.options));for(var t=0;t<this.set.length;t++)if(le(this.set[t],e,this.options))return!0;return!1},t.satisfies=he,t.maxSatisfying=function(e,t,s){var r=null,i=null;try{var n=new oe(t,s)}catch(e){return null}return e.forEach(function(e){n.test(e)&&(r&&-1!==i.compare(e)||(i=new H(r=e,s)))}),r},t.minSatisfying=function(e,t,s){var r=null,i=null;try{var n=new oe(t,s)}catch(e){return null}return e.forEach(function(e){n.test(e)&&(r&&1!==i.compare(e)||(i=new H(r=e,s)))}),r},t.minVersion=function(e,t){e=new oe(e,t);var s=new H("0.0.0");if(e.test(s))return s;if(s=new H("0.0.0-0"),e.test(s))return s;s=null;for(var r=0;r<e.set.length;++r){var i=e.set[r];i.forEach(function(e){var t=new H(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!X(s,t)||(s=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}if(s&&e.test(s))return s;return null},t.validRange=function(e,t){try{return new oe(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,s){return de(e,t,"<",s)},t.gtr=function(e,t,s){return de(e,t,">",s)},t.outside=de,t.prerelease=function(e,t){var s=z(e,t);return s&&s.prerelease.length?s.prerelease:null},t.intersects=function(e,t,s){return e=new oe(e,s),t=new oe(t,s),e.intersects(t)},t.coerce=function(e,t){if(e instanceof H)return e;if("string"!=typeof e)return null;var s=e.match(n[F]);if(null==s)return null;return z(s[1]+"."+(s[2]||"0")+"."+(s[3]||"0"),t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internalApiSymbol="_privateApi"},function(e,t,s){var r=s(1),i="win32"===process.platform,n=s(6),o=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function a(e){return"function"==typeof e?e:function(){var e;if(o){var t=new Error;e=function(e){e&&(t.message=e.message,s(e=t))}}else e=s;return e;function s(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}r.normalize;if(i)var c=/(.*?)(?:[\/\\]+|$)/g;else c=/(.*?)(?:[\/]+|$)/g;if(i)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else u=/^[\/]*/;t.realpathSync=function(e,t){if(e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var s,o,a,l,h=e,d={},p={};function g(){var t=u.exec(e);s=t[0].length,o=t[0],a=t[0],l="",i&&!p[a]&&(n.lstatSync(a),p[a]=!0)}for(g();s<e.length;){c.lastIndex=s;var f=c.exec(e);if(l=o,o+=f[0],a=l+f[1],s=c.lastIndex,!(p[a]||t&&t[a]===a)){var m;if(t&&Object.prototype.hasOwnProperty.call(t,a))m=t[a];else{var v=n.lstatSync(a);if(!v.isSymbolicLink()){p[a]=!0,t&&(t[a]=a);continue}var b=null;if(!i){var y=v.dev.toString(32)+":"+v.ino.toString(32);d.hasOwnProperty(y)&&(b=d[y])}null===b&&(n.statSync(a),b=n.readlinkSync(a)),m=r.resolve(l,b),t&&(t[a]=m),i||(d[y]=b)}e=r.resolve(m,e.slice(s)),g()}}return t&&(t[h]=e),e},t.realpath=function(e,t,s){if("function"!=typeof s&&(s=a(t),t=null),e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(s.bind(null,null,t[e]));var o,l,h,d,p=e,g={},f={};function m(){var t=u.exec(e);o=t[0].length,l=t[0],h=t[0],d="",i&&!f[h]?n.lstat(h,function(e){if(e)return s(e);f[h]=!0,v()}):process.nextTick(v)}function v(){if(o>=e.length)return t&&(t[p]=e),s(null,e);c.lastIndex=o;var r=c.exec(e);return d=l,l+=r[0],h=d+r[1],o=c.lastIndex,f[h]||t&&t[h]===h?process.nextTick(v):t&&Object.prototype.hasOwnProperty.call(t,h)?w(t[h]):n.lstat(h,b)}function b(e,r){if(e)return s(e);if(!r.isSymbolicLink())return f[h]=!0,t&&(t[h]=h),process.nextTick(v);if(!i){var o=r.dev.toString(32)+":"+r.ino.toString(32);if(g.hasOwnProperty(o))return y(null,g[o],h)}n.stat(h,function(e){if(e)return s(e);n.readlink(h,function(e,t){i||(g[o]=t),y(e,t)})})}function y(e,i,n){if(e)return s(e);var o=r.resolve(d,i);t&&(t[n]=o),w(o)}function w(t){e=r.resolve(t,e.slice(o)),m()}m()}},function(e,t,s){var r=s(79),i=s(80);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,s){var n=[];var o=i("{","}",t);if(!o||/\$$/.test(o.pre))return[t];var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body);var u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body);var h=c||u;var m=o.body.indexOf(",")>=0;if(!h&&!m)return o.post.match(/,.*\}/)?(t=o.pre+"{"+o.body+a+o.post,e(t)):[t];var v;if(h)v=o.body.split(/\.\./);else if(1===(v=function e(t){if(!t)return[""];var s=[];var r=i("{","}",t);if(!r)return t.split(",");var n=r.pre;var o=r.body;var a=r.post;var c=n.split(",");c[c.length-1]+="{"+o+"}";var u=e(a);a.length&&(c[c.length-1]+=u.shift(),c.push.apply(c,u));s.push.apply(s,c);return s}(o.body)).length&&1===(v=e(v[0],!1).map(d)).length){var b=o.post.length?e(o.post,!1):[""];return b.map(function(e){return o.pre+v[0]+e})}var y=o.pre;var b=o.post.length?e(o.post,!1):[""];var w;if(h){var S=l(v[0]),E=l(v[1]),T=Math.max(v[0].length,v[1].length),C=3==v.length?Math.abs(l(v[2])):1,P=g,k=E<S;k&&(C*=-1,P=f);var _=v.some(p);w=[];for(var R=S;P(R,E);R+=C){var x;if(u)"\\"===(x=String.fromCharCode(R))&&(x="");else if(x=String(R),_){var F=T-x.length;if(F>0){var D=new Array(F+1).join("0");x=R<0?"-"+D+x.slice(1):D+x}}w.push(x)}}else w=r(v,function(t){return e(t,!1)});for(var A=0;A<w.length;A++)for(var O=0;O<b.length;O++){var I=y+w[A]+b[O];(!s||h||I)&&n.push(I)}return n}(function(e){return e.split("\\\\").join(n).split("\\{").join(o).split("\\}").join(a).split("\\,").join(c).split("\\.").join(u)}(e),!0).map(h)};var n="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function h(e){return e.split(n).join("\\").split(o).join("{").split(a).join("}").split(c).join(",").split(u).join(".")}function d(e){return"{"+e+"}"}function p(e){return/^-?0\d/.test(e)}function g(e,t){return e<=t}function f(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var r=[],i=0;i<e.length;i++){var n=t(e[i],i);s(n)?r.push.apply(r,n):r.push(n)}return r};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,s){"use strict";function r(e,t,s){e instanceof RegExp&&(e=i(e,s)),t instanceof RegExp&&(t=i(t,s));var r=n(e,t,s);return r&&{start:r[0],end:r[1],pre:s.slice(0,r[0]),body:s.slice(r[0]+e.length,r[1]),post:s.slice(r[1]+t.length)}}function i(e,t){var s=t.match(e);return s?s[0]:null}function n(e,t,s){var r,i,n,o,a,c=s.indexOf(e),u=s.indexOf(t,c+1),l=c;if(c>=0&&u>0){for(r=[],n=s.length;l>=0&&!a;)l==c?(r.push(l),c=s.indexOf(e,l+1)):1==r.length?a=[r.pop(),u]:((i=r.pop())<n&&(n=i,o=u),u=s.indexOf(t,l+1)),l=c<u&&c>=0?c:u;r.length&&(a=[n,o])}return a}e.exports=r,r.range=n},function(e,t,s){try{var r=s(15);if("function"!=typeof r.inherits)throw"";e.exports=r.inherits}catch(t){e.exports=s(82)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}},function(e,t,s){e.exports=g,g.GlobSync=f;var r=s(6),i=s(49),n=s(22),o=(n.Minimatch,s(48).Glob,s(15),s(1)),a=s(50),c=s(33),u=s(51),l=(u.alphasort,u.alphasorti,u.setopts),h=u.ownProp,d=u.childrenIgnored,p=u.isIgnored;function g(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new f(e,t).found}function f(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof f))return new f(e,t);if(l(this,e,t),this.noprocess)return this;var s=this.minimatch.set.length;this.matches=new Array(s);for(var r=0;r<s;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}f.prototype._finish=function(){if(a(this instanceof f),this.realpath){var e=this;this.matches.forEach(function(t,s){var r=e.matches[s]=Object.create(null);for(var n in t)try{n=e._makeAbs(n),r[i.realpathSync(n,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;r[e._makeAbs(n)]=!0}})}u.finish(this)},f.prototype._process=function(e,t,s){a(this instanceof f);for(var r,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:r=null;break;default:r=e.slice(0,i).join("/")}var o,u=e.slice(i);null===r?o=".":c(r)||c(e.join("/"))?(r&&c(r)||(r="/"+r),o=r):o=r;var l=this._makeAbs(o);d(this,o)||(u[0]===n.GLOBSTAR?this._processGlobStar(r,o,l,u,t,s):this._processReaddir(r,o,l,u,t,s))},f.prototype._processReaddir=function(e,t,s,r,i,n){var a=this._readdir(s,n);if(a){for(var c=r[0],u=!!this.minimatch.negate,l=c._glob,h=this.dot||"."===l.charAt(0),d=[],p=0;p<a.length;p++){if("."!==(m=a[p]).charAt(0)||h)(u&&!e?!m.match(c):m.match(c))&&d.push(m)}var g=d.length;if(0!==g)if(1!==r.length||this.mark||this.stat){r.shift();for(p=0;p<g;p++){var f;m=d[p];f=e?[e,m]:[m],this._process(f.concat(r),i,n)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var p=0;p<g;p++){var m=d[p];e&&(m="/"!==e.slice(-1)?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=o.join(this.root,m)),this._emitMatch(i,m)}}}},f.prototype._emitMatch=function(e,t){if(!p(this,t)){var s=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=s),!this.matches[e][t]){if(this.nodir){var r=this.cache[s];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},f.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,s;try{s=r.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var i=s&&s.isSymbolicLink();return this.symlinks[e]=i,i||!s||s.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},f.prototype._readdir=function(e,t){if(t&&!h(this.symlinks,e))return this._readdirInGlobStar(e);if(h(this.cache,e)){var s=this.cache[e];if(!s||"FILE"===s)return null;if(Array.isArray(s))return s}try{return this._readdirEntries(e,r.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},f.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var s=0;s<t.length;s++){var r=t[s];r="/"===e?e+r:e+"/"+r,this.cache[r]=!0}return this.cache[e]=t,t},f.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var s=this._makeAbs(e);if(this.cache[s]="FILE",s===this.cwdAbs){var r=new Error(t.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=t.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},f.prototype._processGlobStar=function(e,t,s,r,i,n){var o=this._readdir(s,n);if(o){var a=r.slice(1),c=e?[e]:[],u=c.concat(a);this._process(u,i,!1);var l=o.length;if(!this.symlinks[s]||!n)for(var h=0;h<l;h++){if("."!==o[h].charAt(0)||this.dot){var d=c.concat(o[h],a);this._process(d,i,!0);var p=c.concat(o[h],r);this._process(p,i,!0)}}}},f.prototype._processSimple=function(e,t){var s=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),s){if(e&&c(e)&&!this.nomount){var r=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=o.join(this.root,e):(e=o.resolve(this.root,e),r&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},f.prototype._stat=function(e){var t=this._makeAbs(e),s="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&h(this.cache,t)){var i=this.cache[t];if(Array.isArray(i)&&(i="DIR"),!s||"DIR"===i)return i;if(s&&"FILE"===i)return!1}var n=this.statCache[t];if(!n){var o;try{o=r.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(o&&o.isSymbolicLink())try{n=r.statSync(t)}catch(e){n=o}else n=o}this.statCache[t]=n;i=!0;return n&&(i=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||i,(!s||"FILE"!==i)&&i},f.prototype._mark=function(e){return u.mark(this,e)},f.prototype._makeAbs=function(e){return u.makeAbs(this,e)}},function(e,t,s){var r=s(52),i=Object.create(null),n=s(53);e.exports=r(function(e,t){return i[e]?(i[e].push(t),null):(i[e]=[t],function(e){return n(function t(){var s=i[e],r=s.length,n=function(e){for(var t=e.length,s=[],r=0;r<t;r++)s[r]=e[r];return s}(arguments);try{for(var o=0;o<r;o++)s[o].apply(null,n)}finally{s.length>r?(s.splice(0,r),process.nextTick(function(){t.apply(null,n)})):delete i[e]}})}(e))})},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(86);t.DartUriHandler=class{constructor(e){this.handlers={"/flutter/sample/":new n.FlutterSampleUriHandler(e)}}handleUri(e){return r(this,void 0,void 0,function*(){const t=Object.keys(this.handlers).find(t=>e.path.startsWith(t));t?yield this.handlers[t].handle(e.path.substr(t.length)):i.window.showErrorMessage(`No handler for '${e.path}'. Check you have the latest version of the Dart plugin and try again.`)})}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(54);t.FlutterSampleUriHandler=class{constructor(e){this.flutterCapabilities=e,this.validSampleIdentifierPattern=new RegExp("^[\\w\\.]+$")}handle(e){return r(this,void 0,void 0,function*(){this.isValidSampleName(e)?n.createFlutterSampleInTempFolder(this.flutterCapabilities,e):i.window.showErrorMessage(`${e} is not a valid Flutter sample identifier`)})}isValidSampleName(e){return this.validSampleIdentifierPattern.test(e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.context=e}static for(e){return new r(e)}get devToolsNotificationsShown(){return this.context.globalState.get("devToolsNotificationsShown")||0}set devToolsNotificationsShown(e){this.context.globalState.update("devToolsNotificationsShown",e)}get devToolsNotificationLastShown(){return this.context.globalState.get("devToolsNotificationLastShown")}set devToolsNotificationLastShown(e){this.context.globalState.update("devToolsNotificationLastShown",e)}get devToolsNotificationDoNotShow(){return!!this.context.globalState.get("devToolsNotificationDoNotShowAgain")}set devToolsNotificationDoNotShow(e){this.context.globalState.update("devToolsNotificationDoNotShowAgain",e)}get flutterSurvey2019Q2NotificationLastShown(){return this.context.globalState.get("flutterSurvey2019Q2NotificationLastShown")}set flutterSurvey2019Q2NotificationLastShown(e){this.context.globalState.update("flutterSurvey2019Q2NotificationLastShown",e)}get flutterSurvey2019Q2NotificationDoNotShow(){return!!this.context.globalState.get("flutterSurvey2019Q2NotificationDoNotShowAgain")}set flutterSurvey2019Q2NotificationDoNotShow(e){this.context.globalState.update("flutterSurvey2019Q2NotificationDoNotShowAgain",e)}get hasWarnedAboutFormatterSyntaxLimitation(){return!!this.context.globalState.get("hasWarnedAboutFormatterSyntaxLimitation")}set hasWarnedAboutFormatterSyntaxLimitation(e){this.context.globalState.update("hasWarnedAboutFormatterSyntaxLimitation",e)}get lastSeenVersion(){return this.context.globalState.get("lastSeenVersion")}set lastSeenVersion(e){this.context.globalState.update("lastSeenVersion",e)}getPackageLastCheckedForUpdates(e){return this.context.globalState.get(`packageLastCheckedForUpdates:${e}`)}setPackageLastCheckedForUpdates(e,t){this.context.globalState.update(`packageLastCheckedForUpdates:${e}`,t)}update(e,t){return this.context.globalState.update(e,t)}get(e){return this.context.globalState.get(e)}get subscriptions(){return this.context.subscriptions}}t.Context=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WorkspaceContext=class{constructor(e,t,s,r,i){this.sdks=e,this.hasAnyFlutterMobileProjects=t,this.hasAnyFlutterWebProjects=s,this.hasAnyStandardDartProjects=r,this.hasProjectsInFuchsiaTree=i,this.workspaceTypeDescription=this.buildWorkspaceTypeDescription()}get hasOnlyDartProjects(){return!this.hasAnyFlutterProjects&&!this.hasProjectsInFuchsiaTree}get hasAnyFlutterProjects(){return this.hasAnyFlutterMobileProjects||this.hasAnyFlutterWebProjects}get shouldLoadFlutterExtension(){return this.hasAnyFlutterProjects}buildWorkspaceTypeDescription(){const e=[];return this.hasAnyStandardDartProjects&&e.push("Dart"),this.hasAnyFlutterMobileProjects&&e.push("Flutter"),this.hasAnyFlutterWebProjects&&e.push("Flutter Web"),this.hasProjectsInFuchsiaTree&&e.push("Fuchsia"),0===e.length&&(this.sdks&&this.sdks.dartSdkIsFromFlutter?e.push("Unknown (Flutter SDK)"):this.sdks&&this.sdks.dart?e.push("Unknown (Dart SDK)"):e.push("Unknown (No SDK)")),e.join(", ")}}},function(e,t){e.exports=require("child_process")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(7),i=s(11),n=s(20);t.AnalyzerGen=class extends n.StdIOService{constructor(e,t,s){super(t,new i.CategoryLogger(e,r.LogCategory.Analyzer),s),this.serverConnectedSubscriptions=[],this.serverErrorSubscriptions=[],this.serverStatusSubscriptions=[],this.analysisAnalyzedFilesSubscriptions=[],this.analysisClosingLabelsSubscriptions=[],this.analysisErrorsSubscriptions=[],this.analysisFlushResultsSubscriptions=[],this.analysisFoldingSubscriptions=[],this.analysisHighlightsSubscriptions=[],this.analysisImplementedSubscriptions=[],this.analysisInvalidateSubscriptions=[],this.analysisNavigationSubscriptions=[],this.analysisOccurrencesSubscriptions=[],this.analysisOutlineSubscriptions=[],this.analysisOverridesSubscriptions=[],this.completionResultsSubscriptions=[],this.completionAvailableSuggestionsSubscriptions=[],this.completionExistingImportsSubscriptions=[],this.searchResultsSubscriptions=[],this.executionLaunchDataSubscriptions=[],this.flutterOutlineSubscriptions=[]}buildRequest(e,t,s){return Object.assign(super.buildRequest(e,t,s),{clientRequestTime:Date.now()})}handleNotification(e){switch(e.event){case"server.connected":this.notify(this.serverConnectedSubscriptions,e.params);break;case"server.error":this.notify(this.serverErrorSubscriptions,e.params);break;case"server.status":this.notify(this.serverStatusSubscriptions,e.params);break;case"analysis.analyzedFiles":this.notify(this.analysisAnalyzedFilesSubscriptions,e.params);break;case"analysis.closingLabels":this.notify(this.analysisClosingLabelsSubscriptions,e.params);break;case"analysis.errors":this.notify(this.analysisErrorsSubscriptions,e.params);break;case"analysis.flushResults":this.notify(this.analysisFlushResultsSubscriptions,e.params);break;case"analysis.folding":this.notify(this.analysisFoldingSubscriptions,e.params);break;case"analysis.highlights":this.notify(this.analysisHighlightsSubscriptions,e.params);break;case"analysis.implemented":this.notify(this.analysisImplementedSubscriptions,e.params);break;case"analysis.invalidate":this.notify(this.analysisInvalidateSubscriptions,e.params);break;case"analysis.navigation":this.notify(this.analysisNavigationSubscriptions,e.params);break;case"analysis.occurrences":this.notify(this.analysisOccurrencesSubscriptions,e.params);break;case"analysis.outline":this.notify(this.analysisOutlineSubscriptions,e.params);break;case"analysis.overrides":this.notify(this.analysisOverridesSubscriptions,e.params);break;case"completion.results":this.notify(this.completionResultsSubscriptions,e.params);break;case"completion.availableSuggestions":this.notify(this.completionAvailableSuggestionsSubscriptions,e.params);break;case"completion.existingImports":this.notify(this.completionExistingImportsSubscriptions,e.params);break;case"search.results":this.notify(this.searchResultsSubscriptions,e.params);break;case"execution.launchData":this.notify(this.executionLaunchDataSubscriptions,e.params);break;case"flutter.outline":this.notify(this.flutterOutlineSubscriptions,e.params)}}registerForServerConnected(e){return this.subscribe(this.serverConnectedSubscriptions,e)}registerForServerError(e){return this.subscribe(this.serverErrorSubscriptions,e)}registerForServerStatus(e){return this.subscribe(this.serverStatusSubscriptions,e)}registerForAnalysisAnalyzedFiles(e){return this.subscribe(this.analysisAnalyzedFilesSubscriptions,e)}registerForAnalysisClosingLabels(e){return this.subscribe(this.analysisClosingLabelsSubscriptions,e)}registerForAnalysisErrors(e){return this.subscribe(this.analysisErrorsSubscriptions,e)}registerForAnalysisFlushResults(e){return this.subscribe(this.analysisFlushResultsSubscriptions,e)}registerForAnalysisFolding(e){return this.subscribe(this.analysisFoldingSubscriptions,e)}registerForAnalysisHighlights(e){return this.subscribe(this.analysisHighlightsSubscriptions,e)}registerForAnalysisImplemented(e){return this.subscribe(this.analysisImplementedSubscriptions,e)}registerForAnalysisInvalidate(e){return this.subscribe(this.analysisInvalidateSubscriptions,e)}registerForAnalysisNavigation(e){return this.subscribe(this.analysisNavigationSubscriptions,e)}registerForAnalysisOccurrences(e){return this.subscribe(this.analysisOccurrencesSubscriptions,e)}registerForAnalysisOutline(e){return this.subscribe(this.analysisOutlineSubscriptions,e)}registerForAnalysisOverrides(e){return this.subscribe(this.analysisOverridesSubscriptions,e)}registerForCompletionResults(e){return this.subscribe(this.completionResultsSubscriptions,e)}registerForCompletionAvailableSuggestions(e){return this.subscribe(this.completionAvailableSuggestionsSubscriptions,e)}registerForCompletionExistingImports(e){return this.subscribe(this.completionExistingImportsSubscriptions,e)}registerForSearchResults(e){return this.subscribe(this.searchResultsSubscriptions,e)}registerForExecutionLaunchData(e){return this.subscribe(this.executionLaunchDataSubscriptions,e)}registerForFlutterOutline(e){return this.subscribe(this.flutterOutlineSubscriptions,e)}serverGetVersion(){return this.sendRequest("server.getVersion")}serverShutdown(){return this.sendRequest("server.shutdown")}serverSetSubscriptions(e){return this.sendRequest("server.setSubscriptions",e)}analysisGetErrors(e){return this.sendRequest("analysis.getErrors",e)}analysisGetHover(e){return this.sendRequest("analysis.getHover",e)}analysisGetImportedElements(e){return this.sendRequest("analysis.getImportedElements",e)}analysisGetLibraryDependencies(){return this.sendRequest("analysis.getLibraryDependencies")}analysisGetNavigation(e){return this.sendRequest("analysis.getNavigation",e)}analysisGetReachableSources(e){return this.sendRequest("analysis.getReachableSources",e)}analysisGetSignature(e){return this.sendRequest("analysis.getSignature",e)}analysisReanalyze(){return this.sendRequest("analysis.reanalyze")}analysisSetAnalysisRoots(e){return this.sendRequest("analysis.setAnalysisRoots",e)}analysisSetGeneralSubscriptions(e){return this.sendRequest("analysis.setGeneralSubscriptions",e)}analysisSetPriorityFiles(e){return this.sendRequest("analysis.setPriorityFiles",e)}analysisSetSubscriptions(e){return this.sendRequest("analysis.setSubscriptions",e)}analysisUpdateContent(e){return this.sendRequest("analysis.updateContent",e)}analysisUpdateOptions(e){return this.sendRequest("analysis.updateOptions",e)}completionGetSuggestions(e){return this.sendRequest("completion.getSuggestions",e)}completionSetSubscriptions(e){return this.sendRequest("completion.setSubscriptions",e)}completionRegisterLibraryPaths(e){return this.sendRequest("completion.registerLibraryPaths",e)}completionGetSuggestionDetails(e){return this.sendRequest("completion.getSuggestionDetails",e)}completionListTokenDetails(e){return this.sendRequest("completion.listTokenDetails",e)}searchFindElementReferences(e){return this.sendRequest("search.findElementReferences",e)}searchFindMemberDeclarations(e){return this.sendRequest("search.findMemberDeclarations",e)}searchFindMemberReferences(e){return this.sendRequest("search.findMemberReferences",e)}searchFindTopLevelDeclarations(e){return this.sendRequest("search.findTopLevelDeclarations",e)}searchGetElementDeclarations(e){return this.sendRequest("search.getElementDeclarations",e)}searchGetTypeHierarchy(e){return this.sendRequest("search.getTypeHierarchy",e)}editFormat(e){return this.sendRequest("edit.format",e)}editGetAssists(e){return this.sendRequest("edit.getAssists",e)}editGetAvailableRefactorings(e){return this.sendRequest("edit.getAvailableRefactorings",e)}editGetDartfixInfo(){return this.sendRequest("edit.getDartfixInfo")}editDartfix(e){return this.sendRequest("edit.dartfix",e)}editGetFixes(e){return this.sendRequest("edit.getFixes",e)}editGetPostfixCompletion(e){return this.sendRequest("edit.getPostfixCompletion",e)}editGetRefactoring(e){return this.sendRequest("edit.getRefactoring",e)}editGetStatementCompletion(e){return this.sendRequest("edit.getStatementCompletion",e)}editIsPostfixCompletionApplicable(e){return this.sendRequest("edit.isPostfixCompletionApplicable",e)}editListPostfixCompletionTemplates(){return this.sendRequest("edit.listPostfixCompletionTemplates")}editImportElements(e){return this.sendRequest("edit.importElements",e)}editSortMembers(e){return this.sendRequest("edit.sortMembers",e)}editOrganizeDirectives(e){return this.sendRequest("edit.organizeDirectives",e)}executionCreateContext(e){return this.sendRequest("execution.createContext",e)}executionDeleteContext(e){return this.sendRequest("execution.deleteContext",e)}executionGetSuggestions(e){return this.sendRequest("execution.getSuggestions",e)}executionMapUri(e){return this.sendRequest("execution.mapUri",e)}executionSetSubscriptions(e){return this.sendRequest("execution.setSubscriptions",e)}diagnosticGetDiagnostics(){return this.sendRequest("diagnostic.getDiagnostics")}diagnosticGetServerPort(){return this.sendRequest("diagnostic.getServerPort")}analyticsIsEnabled(){return this.sendRequest("analytics.isEnabled")}analyticsEnable(e){return this.sendRequest("analytics.enable",e)}analyticsSendEvent(e){return this.sendRequest("analytics.sendEvent",e)}analyticsSendTiming(e){return this.sendRequest("analytics.sendTiming",e)}kytheGetKytheEntries(e){return this.sendRequest("kythe.getKytheEntries",e)}flutterGetChangeAddForDesignTimeConstructor(e){return this.sendRequest("flutter.getChangeAddForDesignTimeConstructor",e)}flutterSetSubscriptions(e){return this.sendRequest("flutter.setSubscriptions",e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(12),n=s(1),o=s(0),a=s(7),c=s(4),u=s(9),l=s(8),h=s(2),d=3,p=!1;let g=0;t.AnalyzerStatusReporter=class{constructor(e,t,s,r){this.logger=e,this.analyzer=t,this.workspaceContext=s,this.analytics=r,this.analysisInProgress=!1,t.registerForServerStatus(e=>this.handleServerStatus(e)),t.registerForServerError(e=>this.handleServerError(e)),t.registerForRequestError(e=>this.handleRequestError(e)),p&&setTimeout(()=>{this.handleServerError({isFatal:!1,message:"This is a fake error for testing the error reporting!",stackTrace:(new Error).stack||""},"testError")},5e3)}handleServerStatus(e){e.analysis&&(this.analysisInProgress=e.analysis.isAnalyzing,this.analysisInProgress?setTimeout(()=>{this.analysisInProgress&&!this.analyzingPromise&&o.window.withProgress({location:o.ProgressLocation.Window,title:"Analyzing…"},e=>(this.analyzingPromise||(this.analyzingPromise=new c.PromiseCompleter),this.analyzingPromise.promise))},500):this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0))}handleRequestError(e){this.handleServerError({isFatal:!1,message:e.message,stackTrace:e.stackTrace||""},e.method)}handleServerError(e,t){if(this.logger.error(e.message,a.LogCategory.Analyzer),e.stackTrace&&this.logger.error(e.stackTrace,a.LogCategory.Analyzer),this.analytics.logAnalyzerError((t?`(${t}) `:"")+e.message,e.isFatal),g++,l.config.reportAnalyzerErrors&&g<=d&&this.shouldReportErrors()){const s="Generate error report";o.window.showErrorMessage(`Exception from the Dart analysis server: ${e.message}`,s).then(r=>{r===s&&this.reportError(e,t)})}}shouldReportErrors(){const e=this.workspaceContext.sdks;return this.workspaceContext.hasAnyFlutterProjects&&e.flutter?!c.isStableSdk(h.getSdkVersion(this.logger,e.flutter)):!c.isStableSdk(h.getSdkVersion(this.logger,e.dart))}reportError(e,t){const s=h.getSdkVersion(this.logger,this.workspaceContext.sdks.dart),a=this.workspaceContext.sdks.dartSdkIsFromFlutter?h.getSdkVersion(this.logger,this.workspaceContext.sdks.flutter):void 0,c=this.analyzer.getLastDiagnostics(),l=this.analyzer.getAnalyzerLaunchArgs(),d=`\nPlease review the below report for any information you do not wish to share and report to\n  https://github.com/dart-lang/sdk/issues/new\n\nException from analysis server (running from VSCode / Dart Code)\n\n### What I was doing\n\n(please describe what you were doing when this exception occurred)\n${t?"\n### Request\n\nWhile responding to request: `"+t+"`\n":""}\n### Versions\n\n- ${a?`Flutter SDK ${a}`:`Dart SDK ${s}`}\n- ${o.env.appName} ${o.version}\n- Dart Code ${h.extensionVersion}\n\n### Analyzer Info\n\nThe analyzer was launched using the arguments:\n\n\`\`\`text\n${l.join("\n")}\n\`\`\`\n\n### Exception${e.isFatal?" (fatal)":""}\n\n${e.message}\n\n\`\`\`text\n${e.stackTrace.trim()}\n\`\`\`\n${c?"\nDiagnostics requested after the error occurred are:\n\n```js\n"+JSON.stringify(c,void 0,4)+"\n```\n":""}\n`,p=`bug-${u.getRandomInt(4096,65536).toString(16)}.md`,g=n.join(i.tmpdir(),p);r.writeFileSync(g,d),o.workspace.openTextDocument(g).then(e=>{o.window.showTextDocument(e)})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(3),n=s(8),o=s(2);t.FileChangeHandler=class{constructor(e){this.analyzer=e,this.disposables=[],this.filesWarnedAbout=new Set,this.disposables.push(r.workspace.onDidOpenTextDocument(e=>this.onDidOpenTextDocument(e)),r.workspace.onDidChangeTextDocument(e=>this.onDidChangeTextDocument(e)),r.workspace.onDidCloseTextDocument(e=>this.onDidCloseTextDocument(e))),r.workspace.textDocuments.forEach(e=>this.onDidOpenTextDocument(e))}onDidOpenTextDocument(e){if(!o.isAnalyzable(e))return;const t={};t[i.fsPath(e.uri)]={content:e.getText(),type:"add"},this.analyzer.analysisUpdateContent({files:t})}onDidChangeTextDocument(e){if(!o.isAnalyzable(e.document))return;if(0===e.contentChanges.length)return;const t=i.fsPath(e.document.uri);if(r.workspace.workspaceFolders&&r.workspace.workspaceFolders.length&&n.config.warnWhenEditingFilesOutsideWorkspace&&!this.filesWarnedAbout.has(t)&&!o.isWithinWorkspace(t)){const e="Don't Warn Me";r.window.showWarningMessage("You are modifying a file outside of your open folders",e).then(t=>{t===e&&n.config.setWarnWhenEditingFilesOutsideWorkspace(!1)}),this.filesWarnedAbout.add(t)}const s={};s[t]={edits:e.contentChanges.map(t=>this.convertChange(e.document,t)),type:"change"},this.analyzer.analysisUpdateContent({files:s})}onDidCloseTextDocument(e){if(!o.isAnalyzable(e))return;const t={};t[i.fsPath(e.uri)]={type:"remove"},this.analyzer.analysisUpdateContent({files:t})}convertChange(e,t){return{id:"",length:t.rangeLength,offset:t.rangeOffset,replacement:t.text}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(18),n=s(94),o=s(0),a=s(5),c=s(8),u=s(2),l=!1,h="someValue.machineId"!==o.env.machineId?o.env.machineId:void 0;var d,p,g;!function(e){e[e.Extension=0]="Extension",e[e.Analyzer=1]="Analyzer",e[e.Debugger=2]="Debugger"}(d||(d={})),function(e){e[e.Activated=0]="Activated",e[e.SdkDetectionFailure=1]="SdkDetectionFailure",e[e.Deactivated=2]="Deactivated",e[e.Restart=3]="Restart",e[e.HotReload=4]="HotReload",e[e.OpenObservatory=5]="OpenObservatory",e[e.OpenTimeline=6]="OpenTimeline",e[e.OpenDevTools=7]="OpenDevTools"}(p||(p={})),function(e){e[e.Startup=0]="Startup",e[e.FirstAnalysis=1]="FirstAnalysis",e[e.SessionDuration=2]="SessionDuration"}(g||(g={}));t.Analytics=class{constructor(e,t){this.logger=e,this.workspaceContext=t,this.dummyDartFile=o.Uri.parse("untitled:foo.dart"),this.dartConfig=o.workspace.getConfiguration("",this.dummyDartFile).get("[dart]"),this.formatter=this.getFormatterSetting()}getFormatterSetting(){try{const e=this.getAppliedConfig("editor","defaultFormatter",!1);return e&&e!==a.dartCodeExtensionIdentifier?e:c.config.enableSdkFormatter?this.getAppliedConfig("editor","formatOnSave")?"Enabled on Save":"Enabled":"Disabled"}catch(e){return"Unknown"}}getAppliedConfig(e,t,s=!0){const r=this.dartConfig?this.dartConfig[`${e}.${t}`]:void 0;return null!=r?r:o.workspace.getConfiguration(e,s?this.dummyDartFile:void 0).get(t)}logExtensionStartup(e){this.event(d.Extension,p.Activated),this.time(d.Extension,g.Startup,e)}logExtensionRestart(e){this.event(d.Extension,p.Restart),this.time(d.Extension,g.Startup,e)}logExtensionShutdown(){return this.event(d.Extension,p.Deactivated)}logSdkDetectionFailure(){this.event(d.Extension,p.SdkDetectionFailure)}logAnalyzerError(e,t){this.error("AS: "+e,t)}logAnalyzerStartupTime(e){this.time(d.Analyzer,g.Startup,e)}logDebugSessionDuration(e){this.time(d.Debugger,g.SessionDuration,e)}logAnalyzerFirstAnalysisTime(e){this.time(d.Analyzer,g.FirstAnalysis,e)}logDebuggerStart(e,t,s){const r={cd15:t,cd16:s};this.event(d.Debugger,p.Activated,e,r)}logDebuggerRestart(){this.event(d.Debugger,p.Restart)}logDebuggerHotReload(){this.event(d.Debugger,p.HotReload)}logDebuggerOpenObservatory(){this.event(d.Debugger,p.OpenObservatory)}logDebuggerOpenTimeline(){this.event(d.Debugger,p.OpenTimeline)}logDebuggerOpenDevTools(){this.event(d.Debugger,p.OpenDevTools)}event(e,t,s,r){const i={ea:p[t],ec:d[e],t:"event"};return Object.assign(i,r),e===d.Extension&&t===p.Activated&&(i.sc="start"),e===d.Extension&&t===p.Deactivated&&(i.sc="end"),this.send(i,s)}time(e,t,s){const r={t:"timing",utc:d[e],utt:Math.round(s),utv:g[t]};this.send(r)}error(e,t){const s={exd:e.split(/[\n\{\/\\]/)[0].substring(0,150).trim(),exf:t?1:0,t:"exception"};this.send(s)}send(e,t){return r(this,void 0,void 0,function*(){if(!h||!c.config.allowAnalytics||process.env.DART_CODE_IS_TEST_RUN)return;const s={aip:1,an:"Dart Code",av:u.extensionVersion,cd1:u.isDevExtension,cd10:c.config.showTodos?"On":"Off",cd12:this.formatter,cd13:this.flutterSdkVersion,cd14:u.hasFlutterExtension?"Installed":"Not Installed",cd17:this.workspaceContext.hasAnyFlutterProjects?c.config.previewFlutterUiGuides?c.config.previewFlutterUiGuidesCustomTracking?"On + Custom Tracking":"On":"Off":null,cd2:a.isChromeOS?`${process.platform} (ChromeOS)`:process.platform,cd3:this.sdkVersion,cd4:this.analysisServerVersion,cd5:o.version,cd6:t?this.getDebuggerPreference(t):null,cd7:this.workspaceContext.workspaceTypeDescription,cd8:c.config.closingLabels?"On":"Off",cd9:this.workspaceContext.hasAnyFlutterProjects?c.config.flutterHotReloadOnSave?"On":"Off":null,cid:h,tid:"UA-2201586-19",ul:o.env.language,v:"1"};Object.assign(s,e),l&&this.logger.info("Sending analytic: "+JSON.stringify(s));const r={headers:{"Content-Type":"application/x-www-form-urlencoded"},hostname:"www.google-analytics.com",method:"POST",path:l?"/debug/collect":"/collect",port:443};yield new Promise(e=>{try{const t=i.request(r,t=>{l&&t.on("data",e=>{try{const t=JSON.parse(e.toString());t&&t.hitParsingResult&&!0===t.hitParsingResult[0].valid?this.logger.info("Sent OK!"):t&&t.hitParsingResult&&!1===t.hitParsingResult[0].valid?this.logger.warn(e.toString()):this.logger.warn("Unexpected GA debug response: "+e.toString())}catch(t){this.logger.warn("Error in GA debug response: "+e.toString())}}),(!t||!t.statusCode||t.statusCode<200||t.statusCode>300)&&this.logger.info(`Failed to send analytics ${t&&t.statusCode}: ${t&&t.statusMessage}`),e()});t.write(n.stringify(s)),t.end()}catch(t){this.logger.error(`Failed to send analytics: ${t}`),e()}})})}getDebuggerPreference(e){const t=c.config.for(e);return t.debugSdkLibraries&&t.debugExternalLibraries?"All code":t.debugSdkLibraries?"My code + SDK":t.debugExternalLibraries?"My code + Libraries":"My code"}}},function(e,t){e.exports=require("querystring")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.DartExtensionApi=class{constructor(){this.version=1,this.flutterCreateSampleProject=()=>r.commands.executeCommand("_dart.flutter.createSampleProject")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(4),n=s(56),o=s(57),a=s(13),c=s(2);t.TestCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()})),this.disposables.push(r.commands.registerCommand("_dart.startDebuggingTestFromOutline",e=>{r.debug.startDebugging(r.workspace.getWorkspaceFolder(r.Uri.file(e.file)),o.getLaunchConfig(!1,e.file,e.fullName,e.isGroup))})),this.disposables.push(r.commands.registerCommand("_dart.startWithoutDebuggingTestFromOutline",e=>{r.debug.startDebugging(r.workspace.getWorkspaceFolder(r.Uri.file(e.file)),o.getLaunchConfig(!0,e.file,e.fullName,e.isGroup))}))}provideCodeLenses(e,t){const s=a.openFileTracker.getOutlineFor(e.uri);if(!s||!s.children||!s.children.length)return;if(!a.openFileTracker.supportsPubRunTest(e.uri))return;const o=new n.TestOutlineVisitor(this.logger);return o.visit(s),i.flatMap(o.tests.filter(e=>e.offset&&e.length).map(t=>[new r.CodeLens(c.toRange(e,t.offset,t.length),{arguments:[t],command:"_dart.startWithoutDebuggingTestFromOutline",title:"Run"}),new r.CodeLens(c.toRange(e,t.offset,t.length),{arguments:[t],command:"_dart.startDebuggingTestFromOutline",title:"Debug"})]),e=>e)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3);t.AnalyzerCommands=class{constructor(e,t){e.subscriptions.push(i.commands.registerCommand("dart.openAnalyzerDiagnostics",()=>r(this,void 0,void 0,function*(){const e=yield t.diagnosticGetServerPort();n.openInBrowser(`http://127.0.0.1:${e.port}/`)})))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(5),n=s(7),o=s(32),a=s(36);t.IS_INSPECTING_WIDGET_CONTEXT="dart-code:flutter.isInspectingWidget";const c={[n.FlutterServiceExtension.PlatformOverride]:"value",[n.FlutterServiceExtension.DebugBanner]:"enabled",[n.FlutterServiceExtension.CheckElevations]:"enabled",[n.FlutterServiceExtension.DebugPaint]:"enabled",[n.FlutterServiceExtension.PaintBaselines]:"enabled",[n.FlutterServiceExtension.InspectorSelectMode]:"enabled",[n.FlutterServiceExtension.RepaintRainbow]:"enabled",[n.FlutterServiceExtension.PerformanceOverlay]:"enabled",[n.FlutterServiceExtension.SlowAnimations]:"timeDilation"};t.timeDilationNormal=1,t.timeDilationSlow=5;const u={[n.FlutterServiceExtension.PlatformOverride]:null,[n.FlutterServiceExtension.DebugBanner]:!0,[n.FlutterServiceExtension.CheckElevations]:!1,[n.FlutterServiceExtension.DebugPaint]:!1,[n.FlutterServiceExtension.PaintBaselines]:!1,[n.FlutterServiceExtension.InspectorSelectMode]:!1,[n.FlutterServiceExtension.RepaintRainbow]:!1,[n.FlutterServiceExtension.PerformanceOverlay]:!1,[n.FlutterServiceExtension.SlowAnimations]:t.timeDilationNormal};t.FlutterVmServiceExtensions=class{constructor(e){this.registeredServices={},this.loadedServiceExtensions=[],this.currentExtensionState=Object.assign({},u),this.sendValueToVM=t=>{if(-1!==this.loadedServiceExtensions.indexOf(t)&&void 0!==c[t]){const s={[c[t]]:this.currentExtensionState[t]};e(t,{type:t,params:s}),this.syncInspectingWidgetContext(t)}}}handleDebugEvent(e){if("dart.serviceExtensionAdded"===e.event)this.handleServiceExtensionLoaded(e.body.id),"ext.flutter.inspector.isWidgetCreationTracked"===e.body.id?e.session.customRequest("checkIsWidgetCreationTracked"):e.body.id===n.FlutterServiceExtension.PlatformOverride?e.session.customRequest("checkPlatformOverride"):e.body.id===n.FlutterServiceExtension.InspectorSetPubRootDirectories&&e.session.configuration.debuggerType!==a.DebuggerType.FlutterWeb&&e.session.customRequest("serviceExtension",{params:{arg0:this.formatPathForPubRootDirectories(e.session.configuration.cwd),arg1:e.session.configuration.cwd,isolateId:e.body.isolateId},type:"ext.flutter.inspector.setPubRootDirectories"});else if("dart.serviceRegistered"===e.event)this.handleServiceRegistered(e.body.service,e.body.method);else if("dart.flutter.firstFrame"===e.event)for(const e in n.FlutterServiceExtension)this.sendValueToVM(e);else"dart.flutter.updateIsWidgetCreationTracked"===e.event?r.commands.executeCommand("setContext",i.TRACK_WIDGET_CREATION_ENABLED,e.body.isWidgetCreationTracked):"dart.flutter.updatePlatformOverride"===e.event?this.currentExtensionState[n.FlutterServiceExtension.PlatformOverride]=e.body.platform:"dart.flutter.serviceExtensionStateChanged"===e.event&&this.handleRemoteValueUpdate(e.body.extension,e.body.value)}formatPathForPubRootDirectories(e){return i.isWin?e&&`file:///${e.replace(/\\/g,"/")}`:e}toggle(e,t=!0,s=!1){this.currentExtensionState[e]=this.currentExtensionState[e]!==t?t:s,this.sendValueToVM(e)}syncInspectingWidgetContext(e){r.commands.executeCommand("setContext",t.IS_INSPECTING_WIDGET_CONTEXT,this.currentExtensionState[n.FlutterServiceExtension.InspectorSelectMode])}handleRemoteValueUpdate(e,t){if(void 0!==this.currentExtensionState[e]){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}this.currentExtensionState[e]=t,this.syncInspectingWidgetContext(e)}}resetToDefaults(){this.currentExtensionState=Object.assign({},u)}handleServiceRegistered(e,t){this.registeredServices[e]=t,r.commands.executeCommand("setContext",`${o.SERVICE_CONTEXT_PREFIX}${e}`,!0)}handleServiceExtensionLoaded(e){this.loadedServiceExtensions.push(e),r.commands.executeCommand("setContext",`${o.SERVICE_EXTENSION_CONTEXT_PREFIX}${e}`,!0)}markAllServicesUnloaded(){for(const e of Object.keys(this.registeredServices))r.commands.executeCommand("setContext",`${o.SERVICE_CONTEXT_PREFIX}${e}`,void 0);this.registeredServices={};for(const e of this.loadedServiceExtensions)r.commands.executeCommand("setContext",`${o.SERVICE_EXTENSION_CONTEXT_PREFIX}${e}`,void 0);this.loadedServiceExtensions.length=0,r.commands.executeCommand("setContext",i.TRACK_WIDGET_CREATION_ENABLED,!1)}serviceIsRegistered(e){return!!this.registeredServices[e]}getServiceMethodName(e){return this.registeredServices[e]}serviceExtensionIsLoaded(e){return!!this.loadedServiceExtensions.find(t=>t===e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(16),i=s(40);class n extends r.EventEmitter{constructor(){super(),this._pendingRequests=new Map}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=new Buffer(0),e.on("data",e=>this._handleData(e)),e.on("close",()=>{this._emitEvent(new i.Event("close"))}),e.on("error",e=>{this._emitEvent(new i.Event("error","inStream error: "+(e&&e.message)))}),t.on("error",e=>{this._emitEvent(new i.Event("error","outStream error: "+(e&&e.message)))}),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,s,r){const n={command:e};if(t&&Object.keys(t).length>0&&(n.arguments=t),this._writableStream){if(this._send("request",n),r){this._pendingRequests.set(n.seq,r);const e=setTimeout(()=>{clearTimeout(e);const t=this._pendingRequests.get(n.seq);t&&(this._pendingRequests.delete(n.seq),t(new i.Response(n,"timeout")))},s)}}else this._emitEvent(new i.Event("error","sendRequest: No writableStream"))}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);if("request"===t.type)this.dispatchRequest(t);else if("response"===t.type){const e=t,s=this._pendingRequests.get(e.request_seq);s&&(this._pendingRequests.delete(e.request_seq),s(e))}}catch(e){this._emitEvent(new i.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(n.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const s=t[e].split(/: +/);"Content-Length"==s[0]&&(this._contentLength=+s[1])}this._rawData=this._rawData.slice(e+n.TWO_CRLF.length);continue}}break}}}n.TWO_CRLF="\r\n\r\n",t.ProtocolServer=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(60),i=r.logger,n=s(39);t.LoggingDebugSession=class extends n.DebugSession{constructor(e,t,s){super(t,s),this.obsolete_logFilePath=e,this.on("error",e=>{i.error(e.body)})}start(e,t){super.start(e,t),i.init(e=>this.sendEvent(e),this.obsolete_logFilePath,this._isServer)}sendEvent(e){e instanceof r.LogOutputEvent||i.verbose(`To client: ${JSON.stringify(e)}`),super.sendEvent(e)}sendRequest(e,t,s,r){i.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${s}`),super.sendRequest(e,t,s,r)}sendResponse(e){i.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){i.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}},function(e,t,s){var r=s(1),i=s(6),n=parseInt("0777",8);function o(e,t,s,a){"function"==typeof t?(s=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,u=t.fs||i;void 0===c&&(c=n&~process.umask()),a||(a=null);var l=s||function(){};e=r.resolve(e),u.mkdir(e,c,function(s){if(!s)return l(null,a=a||e);switch(s.code){case"ENOENT":o(r.dirname(e),t,function(s,r){s?l(s,r):o(e,t,l,r)});break;default:u.stat(e,function(e,t){e||!t.isDirectory()?l(s,a):l(null,a)})}})}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(t,s,o){s&&"object"==typeof s||(s={mode:s});var a=s.mode,c=s.fs||i;void 0===a&&(a=n&~process.umask()),o||(o=null),t=r.resolve(t);try{c.mkdirSync(t,a),o=o||t}catch(i){switch(i.code){case"ENOENT":o=e(r.dirname(t),s,o),e(t,s,o);break;default:var u;try{u=c.statSync(t)}catch(e){throw i}if(!u.isDirectory())throw i}}return o}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);class i{constructor(e){this.version=e}static get empty(){return new i("0.0.0")}get serviceStreamIsPublic(){return r.versionIsAtLeast(this.version,"3.22.0")}}t.VmServiceCapabilities=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=e=>`[${e}m`;t.black=e=>`${r(30)}${e}${r(0)}`,t.red=e=>`${r(31)}${e}${r(0)}`,t.green=e=>`${r(32)}${e}${r(0)}`,t.yellow=e=>`${r(33)}${e}${r(0)}`,t.blue=e=>`${r(34)}${e}${r(0)}`,t.magenta=e=>`${r(35)}${e}${r(0)}`,t.cyan=e=>`${r(36)}${e}${r(0)}`,t.white=e=>`${r(37)}${e}${r(0)}`,t.brightBlack=e=>`${r(90)}${e}${r(0)}`,t.brightRed=e=>`${r(91)}${e}${r(0)}`,t.brightGreen=e=>`${r(92)}${e}${r(0)}`,t.brightYellow=e=>`${r(93)}${e}${r(0)}`,t.brightBlue=e=>`${r(94)}${e}${r(0)}`,t.brightMagenta=e=>`${r(95)}${e}${r(0)}`,t.brightCyan=e=>`${r(96)}${e}${r(0)}`,t.brightWhite=e=>`${r(97)}${e}${r(0)}`,t.blackBackground=e=>`${r(90)}${e}${r(0)}`,t.redBackground=e=>`${r(41)}${e}${r(0)}`,t.greenBackground=e=>`${r(42)}${e}${r(0)}`,t.yellowBackground=e=>`${r(43)}${e}${r(0)}`,t.blueBackground=e=>`${r(44)}${e}${r(0)}`,t.magentaBackground=e=>`${r(45)}${e}${r(0)}`,t.cyanBackground=e=>`${r(46)}${e}${r(0)}`,t.whiteBackground=e=>`${r(47)}${e}${r(0)}`,t.brightBlackBackground=e=>`${r(100)}${e}${r(0)}`,t.brightRedBackground=e=>`${r(101)}${e}${r(0)}`,t.brightGreenBackground=e=>`${r(102)}${e}${r(0)}`,t.brightYellowBackground=e=>`${r(103)}${e}${r(0)}`,t.brightBlueBackground=e=>`${r(104)}${e}${r(0)}`,t.brightMagentaBackground=e=>`${r(105)}${e}${r(0)}`,t.brightCyanBackground=e=>`${r(106)}${e}${r(0)}`,t.brightWhiteBackground=e=>`${r(107)}${e}${r(0)}`},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(106),i=s(4);class n{constructor(e){this.result=e}}var o;t.DebuggerResult=n,function(e){e[e.Coverage=0]="Coverage",e[e.PossibleBreakpoints=1]="PossibleBreakpoints"}(o=t.SourceReportKind||(t.SourceReportKind={}));class a{constructor(e,t,s){this.code=e,this.message=t,this.data=s}details(){return this.data?this.data.details:void 0}toString(){return`${this.code} ${this.message}`}}t.RPCError=a;t.ObservatoryConnection=class{constructor(e){this.completers={},this.eventListeners={},this.nextId=0,this.socket=new r(e),this.socket.on("message",e=>this.handleData(e.toString()))}onOpen(e){this.socket.on("open",e)}onLogging(e){this.logging=e}getVersion(){return this.callMethod("getVersion")}getVM(){return this.callMethod("getVM")}getIsolate(e){return this.callMethod("getIsolate",{isolateId:e})}on(e,t){this.streamListen(e),this.eventListeners[e]=t}streamListen(e){this.callMethod("streamListen",{streamId:e})}addBreakpointWithScriptUri(e,t,s,r){let i;return i={isolateId:e,scriptUri:t,line:s},r&&(i.column=r),this.callMethod("addBreakpointWithScriptUri",i)}setExceptionPauseMode(e,t){return this.callMethod("setExceptionPauseMode",{isolateId:e,mode:t})}removeBreakpoint(e,t){return this.callMethod("removeBreakpoint",{isolateId:e,breakpointId:t})}pause(e){return this.callMethod("pause",{isolateId:e})}resume(e,t){return this.callMethod("resume",{isolateId:e,step:t})}getStack(e){return this.callMethod("getStack",{isolateId:e})}getSourceReport(e,t,s){return this.callMethod("getSourceReport",{isolateId:e.id,reports:t.map(e=>o[e]),scriptId:s.id})}getObject(e,t,s,r){let i;return i={isolateId:e,objectId:t},s&&(i.offset=s),r&&(i.count=r),this.callMethod("getObject",i)}evaluate(e,t,s,r){return this.callMethod("evaluate",{disableBreakpoints:r,expression:s,isolateId:e,targetId:t})}evaluateInFrame(e,t,s,r){return this.callMethod("evaluateInFrame",{disableBreakpoints:r,expression:s,frameIndex:t,isolateId:e})}setLibraryDebuggable(e,t,s){return this.callMethod("setLibraryDebuggable",{isolateId:e,libraryId:t,isDebuggable:s})}callMethod(e,t){const s=`${this.nextId++}`,r=new i.PromiseCompleter;let n;this.completers[s]=r,n={id:s,method:e},t&&(n.params=t);const o=JSON.stringify(n);return this.logTraffic(`==> ${o}\n`),this.socket.send(o),r.promise}handleData(e){let t;this.logTraffic(`<== ${e}\n`);const s=(t=JSON.parse(e)).id,r=t.method,i=t.error,o=this.completers[s];if(o)delete this.completers[s],i?o.reject(new a(i.code,i.message,i.data)):o.resolve(new n(t.result));else if(r){const e=t.params,s=e.streamId,r=this.eventListeners[s];r&&r(e.event)}}onError(e){this.socket.on("error",e)}onClose(e){this.socket.on("close",e)}logTraffic(e){this.logging&&this.logging(e)}close(){this.socket.close()}}},function(e,t,s){"use strict";const r=s(61);r.Server=s(112),r.Receiver=s(62),r.Sender=s(64),e.exports=r},function(e,t){e.exports=require("tls")},function(e,t,s){"use strict";function r(e){if(!(this instanceof r))return new r(e);e=e||{},this.concurrency=e.concurrency||1/0,this.pending=0,this.jobs=[],this.cbs=[],this._done=function(){this.pending--,this._run()}.bind(this)}["push","unshift","splice"].forEach(function(e){r.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this._run(),t}}),Object.defineProperty(r.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),r.prototype._run=function(){if(this.pending!==this.concurrency){if(this.jobs.length){var e=this.jobs.shift();this.pending++,e(this._done),this._run()}if(0===this.pending)for(;0!==this.cbs.length;){var t=this.cbs.pop();process.nextTick(t)}}},r.prototype.onDone=function(e){"function"==typeof e&&(this.cbs.push(e),this._run())},e.exports=r},function(e,t){e.exports=require("zlib")},function(e,t){e.exports=require("stream")},function(e,t,s){"use strict";class r{constructor(e,t){this.target=t,this.type=e}}class i extends r{constructor(e,t){super("message",t),this.data=e}}class n extends r{constructor(e,t,s){super("close",s),this.wasClean=s._closeFrameReceived&&s._closeFrameSent,this.reason=t,this.code=e}}class o extends r{constructor(e){super("open",e)}}class a extends r{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const c={addEventListener(e,t){function s(e){t.call(this,new i(e,this))}function r(e,s){t.call(this,new n(e,s,this))}function c(e){t.call(this,new a(e,this))}function u(){t.call(this,new o(this))}"function"==typeof t&&("message"===e?(s._listener=t,this.on(e,s)):"close"===e?(r._listener=t,this.on(e,r)):"error"===e?(c._listener=t,this.on(e,c)):"open"===e?(u._listener=t,this.on(e,u)):this.on(e,t))},removeEventListener(e,t){const s=this.listeners(e);for(let r=0;r<s.length;r++)s[r]!==t&&s[r]._listener!==t||this.removeListener(e,s[r])}};e.exports=c},function(e,t,s){"use strict";const r=s(16),{createHash:i}=s(43),{createServer:n,STATUS_CODES:o}=s(42),a=s(26),c=s(61),{format:u,parse:l}=s(65),{GUID:h}=s(14),d=/^[+\/0-9A-Za-z]{22}==$/;function p(e){e.emit("close")}function g(){this.destroy()}function f(e,t,s,r){e.writable&&(s=s||o[t],r={Connection:"close","Content-type":"text/html","Content-Length":Buffer.byteLength(s),...r},e.write(`HTTP/1.1 ${t} ${o[t]}\r\n`+Object.keys(r).map(e=>`${e}: ${r[e]}`).join("\r\n")+"\r\n\r\n"+s)),e.removeListener("error",g),e.destroy()}e.exports=class extends r{constructor(e,t){if(super(),null==(e={maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e}).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');null!=e.port?(this._server=n((e,t)=>{const s=o[426];t.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),t.end(s)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._removeListeners=function(e,t){for(const s of Object.keys(t))e.on(s,t[s]);return function(){for(const s of Object.keys(t))e.removeListener(s,t[s])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,s)=>{this.handleUpgrade(e,t,s,t=>{this.emit("connection",t,e)})}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this.clients)for(const e of this.clients)e.terminate();const t=this._server;t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?t.close(()=>this.emit("close")):process.nextTick(p,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,s,r){t.on("error",g);const i=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),n=+e.headers["sec-websocket-version"],o={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!i||!d.test(i)||8!==n&&13!==n||!this.shouldHandle(e))return f(t,400);if(this.options.perMessageDeflate){const s=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const r=l(e.headers["sec-websocket-extensions"]);r[a.extensionName]&&(s.accept(r[a.extensionName]),o[a.extensionName]=s)}catch(e){return f(t,400)}}if(this.options.verifyClient){const a={origin:e.headers[`${8===n?"sec-websocket-origin":"origin"}`],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(a,(n,a,c,u)=>{if(!n)return f(t,a||401,c,u);this.completeUpgrade(i,o,e,t,s,r)});if(!this.options.verifyClient(a))return f(t,401)}this.completeUpgrade(i,o,e,t,s,r)}completeUpgrade(e,t,s,r,n,o){if(!r.readable||!r.writable)return r.destroy();const l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${i("sha1").update(e+h).digest("base64")}`],d=new c(null);let p=s.headers["sec-websocket-protocol"];if(p&&(p=p.trim().split(/ *, */),(p=this.options.handleProtocols?this.options.handleProtocols(p,s):p[0])&&(l.push(`Sec-WebSocket-Protocol: ${p}`),d.protocol=p)),t[a.extensionName]){const e=t[a.extensionName].params,s=u({[a.extensionName]:[e]});l.push(`Sec-WebSocket-Extensions: ${s}`),d._extensions=t}this.emit("headers",l,s),r.write(l.concat("\r\n").join("\r\n")),r.removeListener("error",g),d.setSocket(r,n,this.options.maxPayload),this.clients&&(this.clients.add(d),d.on("close",()=>this.clients.delete(d))),o(d)}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(21),n=s(7),o=s(4),a=s(114);t.ThreadManager=class{constructor(e,t){this.logger=e,this.debugSession=t,this.nextThreadId=0,this.threads=[],this.bps={},this.hasConfigurationDone=!1,this.exceptionMode="Unhandled",this.nextDataId=1,this.storedData={}}registerThread(e,t){return r(this,void 0,void 0,function*(){let s=this.getThreadInfoFromRef(e);s||(s=new u(this,e,this.nextThreadId),this.nextThreadId++,this.threads.push(s),this.debugSession.sendEvent(new i.ThreadEvent("started",s.num)),this.hasConfigurationDone&&s.receivedConfigurationDone()),"IsolateRunnable"!==t||s.runnable||(s.runnable=!0,this.debugSession.observatory&&(yield Promise.all([this.debugSession.observatory.setExceptionPauseMode(s.ref.id,this.exceptionMode),this.setLibrariesDebuggable(s.ref),this.resetBreakpoints()]),s.setInitialBreakpoints()))})}receivedConfigurationDone(){this.hasConfigurationDone=!0;for(const e of this.threads)e.receivedConfigurationDone()}getThreadInfoFromRef(e){for(const t of this.threads)if(t.ref.id===e.id)return t}getThreadInfoFromNumber(e){for(const t of this.threads)if(t.num===e)return t}getThreads(){return this.threads.map(e=>new i.Thread(e.num,e.ref.name))}setExceptionPauseMode(e){if(this.exceptionMode=e,this.debugSession.observatory)for(const t of this.threads)if(t.runnable){let s=e;"All"===e&&t.isInfrastructure&&(s="Unhandled"),this.debugSession.observatory.setExceptionPauseMode(t.ref.id,s)}}setLibrariesDebuggable(e){return r(this,void 0,void 0,function*(){if(this.debugSession.noDebug||!this.debugSession.observatory)return;const t=(yield this.debugSession.observatory.getIsolate(e.id)).result;yield Promise.all(t.libraries.filter(e=>this.debugSession.isValidToDebug(e.uri)).map(e=>{if(!this.debugSession.observatory)return Promise.resolve(!0);const s=!(this.debugSession.isSdkLibrary(e.uri)&&!this.debugSession.debugSdkLibraries||this.debugSession.isExternalLibrary(e.uri)&&!this.debugSession.debugExternalLibraries);return this.debugSession.observatory.setLibraryDebuggable(t.id,e.id,s)}))})}resetBreakpoints(){return r(this,void 0,void 0,function*(){const e=[];for(const t of Object.keys(this.bps))e.push(this.setBreakpoints(t,this.bps[t]));yield Promise.all(e)})}setBreakpoints(e,t){let s;0===t.length?delete this.bps[e]:this.bps[e]=t;for(const r of this.threads)if(r.runnable){const i=r.setBreakpoints(this.logger,e,t);s||(s=i)}if(s)return s;const r=new o.PromiseCompleter;return r.resolve(t.map(e=>!0)),r.promise}storeData(e,t){const s=this.nextDataId;return this.nextDataId++,this.storedData[s]=new c(e,t),s}getStoredData(e){return this.storedData[e]}removeStoredData(e){for(const t of Object.keys(this.storedData).map(e=>parseInt(e,10)))this.storedData[t].thread.num===e.num&&delete this.storedData[t]}removeAllStoredData(){for(const e of Object.keys(this.storedData).map(e=>parseInt(e,10)))delete this.storedData[e]}handleIsolateExit(e){const t=this.getThreadInfoFromRef(e);t&&(this.debugSession.sendEvent(new i.ThreadEvent("exited",t.num)),this.threads.splice(this.threads.indexOf(t),1),this.removeStoredData(t))}};class c{constructor(e,t){this.thread=e,this.data=t}}class u{constructor(e,t,s){this.manager=e,this.ref=t,this.num=s,this.scriptCompleters={},this.runnable=!1,this.vmBps={},this.breakpoints={},this.atAsyncSuspension=!1,this.exceptionReference=0,this.paused=!1,this.gotPauseStart=!1,this.initialBreakpoints=!1,this.hasConfigurationDone=!1,this.hasPendingResume=!1}get isInfrastructure(){return this.ref&&this.ref.name&&a.isKnownInfrastructureThread(this.ref)}removeBreakpointsAtUri(e){const t=[],s=this.vmBps[e];if(s){for(const e of s)t.push(this.manager.debugSession.observatory.removeBreakpoint(this.ref.id,e.id));delete this.vmBps[e]}return Promise.all(t)}removeAllBreakpoints(){const e=[];for(const t of Object.keys(this.vmBps))e.push(this.removeBreakpointsAtUri(t));return Promise.all(e).then(e=>[].concat.apply([],e))}setBreakpoints(e,t,s){return r(this,void 0,void 0,function*(){return yield this.removeBreakpointsAtUri(t),this.vmBps[t]=[],Promise.all(s.map(s=>r(this,void 0,void 0,function*(){try{const r=(yield this.manager.debugSession.observatory.addBreakpointWithScriptUri(this.ref.id,t,s.line,s.column)).result;return this.vmBps[t].push(r),this.breakpoints[r.id]=s,r}catch(t){return void e.error(t,n.LogCategory.Observatory)}})))})}receivedPauseStart(){this.gotPauseStart=!0,this.paused=!0,this.checkResume()}setInitialBreakpoints(){this.initialBreakpoints=!0,this.checkResume()}receivedConfigurationDone(){this.hasConfigurationDone=!0,this.checkResume()}checkResume(){this.paused&&this.gotPauseStart&&this.initialBreakpoints&&this.hasConfigurationDone&&this.resume()}handleResumed(){this.manager.removeStoredData(this),this.atAsyncSuspension=!1,this.exceptionReference=0,this.paused=!1}resume(e){return r(this,void 0,void 0,function*(){if(this.paused&&!this.hasPendingResume){this.hasPendingResume=!0;try{yield this.manager.debugSession.observatory.resume(this.ref.id,e),this.handleResumed()}finally{this.hasPendingResume=!1}}})}getScript(e){const t=e.id;if(this.scriptCompleters[t]){return this.scriptCompleters[t].promise}{const s=new o.PromiseCompleter;return this.scriptCompleters[t]=s,this.manager.debugSession.observatory.getObject(this.ref.id,e.id).then(e=>{const t=e.result;s.resolve(t)}).catch(e=>{s.reject(e)}),s.promise}}storeData(e){return this.manager.storeData(this,e)}handlePaused(e,t){this.atAsyncSuspension=e,t&&(t.evaluateName="$e",this.exceptionReference=this.storeData(t)),this.paused=!0}}t.ThreadInfo=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=["pub.dart.snapshot","test.dart.snapshot"];t.isKnownInfrastructureThread=function(e){return e&&e.name&&!!r.find(t=>e.name.startsWith(t))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);t.formatPathForVm=function(e){return(e=(e=(e=(e=r.forceWindowsDriveLetterToUppercase(e)).replace(/\\/g,"/")).replace(/^file:\/+/,"")).replace(/^\/+/,"")).startsWith("dart:")?e:`file:///${encodeURI(e)}`}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(20);t.TestRunner=class extends r.StdIOService{constructor(e,t,s,r,i,n,o){super(()=>i,n,o,!0,!0),this.unhandledMessageSubscriptions=[],this.testStartedProcessSubscriptions=[],this.allTestNotificationsSubscriptions=[],this.createProcess(t,e,s,r)}shouldHandleMessage(e){return e.startsWith("{")&&e.endsWith("}")||e.startsWith("[{")&&e.endsWith("}]")}isNotification(e){return!(!e.type&&!e.event)}isResponse(e){return!1}processUnhandledMessage(e){this.notify(this.unhandledMessageSubscriptions,e)}registerForUnhandledMessages(e){return this.subscribe(this.unhandledMessageSubscriptions,e)}handleNotification(e){switch(e.event){case"test.startedProcess":this.notify(this.testStartedProcessSubscriptions,e.params)}this.notify(this.allTestNotificationsSubscriptions,e)}registerForTestStartedProcess(e){return this.subscribe(this.testStartedProcessSubscriptions,e)}registerForAllTestNotifications(e){return this.subscribe(this.allTestNotificationsSubscriptions,e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(7),i=s(11),n=s(10),o=s(29);t.FlutterRun=class extends o.FlutterRunBase{constructor(e,t,s,a,c,u,l,h){super(e,()=>u,new i.CategoryLogger(l,r.LogCategory.FlutterRun),h,!0,!0);const d=e===o.RunMode.Attach?"attach":"run";this.createProcess(s,t,n.globalFlutterArgs.concat([d,"--machine"]).concat(a),c)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(7),i=s(10),n=s(44),o=s(28);t.FlutterTestDebugSession=class extends n.DartTestDebugSession{spawnProcess(e){let t=[];this.shouldConnectDebugger&&t.push("--start-paused"),e.args&&(t=t.concat(e.args)),e.program&&t.push(this.sourceFileForArgs(e));const s=new o.DebugAdapterLogger(this,r.LogCategory.FlutterTest);return this.createRunner(e.flutterPath,e.cwd,e.program,i.globalFlutterArgs.concat(["test","--machine"]).concat(t),e.env,e.flutterTestLogFile,s,e.maxLogLineLength)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(7),i=s(66),n=s(29),o=s(120);t.FlutterWebDebugSession=class extends i.FlutterDebugSession{constructor(){super(),this.supportsObservatory=!1,this.logCategory=r.LogCategory.WebDaemon}spawnRunDaemon(e,t,s){let r=[];return t.args&&(r=r.concat(t.args)),new o.FlutterWebRun(e?n.RunMode.Attach:n.RunMode.Run,t.pubPath,t.cwd,r,t.env,t.webDaemonLogFile,s,this.maxLogLineLength)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(29);t.FlutterWebRun=class extends r.FlutterRunBase{constructor(e,t,s,r,i,n,o,a){super(e,()=>n,o,a,!0,!0),this.createProcess(s,t,["global","run","webdev","daemon"].concat(r),i)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(44);t.FlutterWebTestDebugSession=class extends r.DartTestDebugSession{spawnProcess(e){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r="webdev",i="webdev";t.WebDev=class{constructor(e){this.pubGlobal=e}promptToInstallIfRequired(){return this.pubGlobal.promptToInstallIfRequired(r,i,void 0,"2.0.7")}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(12),o=s(1),a=s(0),c=s(0),u=s(5),l=s(7),h=s(11),d=s(9),p=s(69),g=s(35),f=s(8),m=s(20),v="devtools",b="Dart DevTools";let y;t.DevToolsManager=class{constructor(e,t,s,r,i){this.logger=e,this.sdks=t,this.debugCommands=s,this.analytics=r,this.pubGlobal=i,this.disposables=[],this.devToolsStatusBarItem=a.window.createStatusBarItem(a.StatusBarAlignment.Right,100),this.disposables.push(this.devToolsStatusBarItem)}spawnForSession(e){return r(this,void 0,void 0,function*(){if(this.analytics.logDebuggerOpenDevTools(),yield this.pubGlobal.promptToInstallIfRequired(b,v,void 0,"0.1.0",!0)){this.devtoolsUrl||(this.devtoolsUrl=a.window.withProgress({location:a.ProgressLocation.Notification,title:"Starting Dart DevTools..."},e=>r(this,void 0,void 0,function*(){return this.startServer()})));try{const t=yield this.devtoolsUrl;if(!(yield a.window.withProgress({location:a.ProgressLocation.Notification,title:"Opening Dart DevTools..."},t=>r(this,void 0,void 0,function*(){if(!(yield p.waitFor(()=>this.debugCommands.flutterExtensions.serviceIsRegistered(l.FlutterService.LaunchDevTools),500)))return this.logger.error("DevTools failed to register launchDevTools service"),a.window.showErrorMessage(`The DevTools service failed to register. ${u.pleaseReportBug}`),!1;try{return yield e.session.customRequest("service",{params:{queryParams:{hide:"debugger",ide:"VSCode",theme:f.config.useDevToolsDarkTheme?"dark":null}},type:this.debugCommands.flutterExtensions.getServiceMethodName(l.FlutterService.LaunchDevTools)}),!0}catch(e){return this.logger.error(`DevTools failed to launch browser ${e.message}`),a.window.showErrorMessage(`The DevTools service failed to launch the browser. ${u.pleaseReportBug}`,"Show Full Error").then(t=>{if(t){const t=`bug-${d.getRandomInt(4096,65536).toString(16)}.txt`,s=o.join(n.tmpdir(),t);i.writeFileSync(s,e.message),c.workspace.openTextDocument(s).then(e=>{c.window.showTextDocument(e)})}}),!1}}))))return;return this.devToolsStatusBarItem.text="Dart DevTools",this.devToolsStatusBarItem.tooltip=`Dart DevTools is running at ${t}`,this.devToolsStatusBarItem.command="dart.openDevTools",this.devToolsStatusBarItem.show(),{url:t,dispose:()=>this.dispose()}}catch(e){this.devToolsStatusBarItem.hide(),this.logger.error(e),a.window.showErrorMessage(`${e}`)}}})}startServer(){return new Promise((e,t)=>{const s=new w(this.logger,this.sdks);this.disposables.push(s),s.registerForServerStarted(t=>{this.disposables.push(this.debugCommands.onDebugSessionVmServiceAvailable(e=>s.vmRegister({uri:e.vmServiceUri}))),g.debugSessions.forEach(e=>s.vmRegister({uri:e.vmServiceUri})),y=t.port,e(`http://${t.host}:${t.port}/`)}),s.process.on("close",e=>{if(this.devtoolsUrl=void 0,this.devToolsStatusBarItem.hide(),e&&0!==e){y=0;const s=`${b} exited with code ${e}`;this.logger.error(s),t(s)}})})}dispose(){this.disposables.forEach(e=>e.dispose())}};class w extends m.StdIOService{constructor(e,t){super(()=>f.config.devToolsLogFile,new h.CategoryLogger(e,l.LogCategory.CommandProcesses),f.config.maxLogLineLength),this.serverStartedSubscriptions=[];const s=o.join(t.dart,u.pubPath),r=["global","run","devtools","--machine","--port",(y=f.config.devToolsPort||y||(u.isChromeOS&&f.config.useKnownChromeOSPorts?u.CHROME_OS_DEVTOOLS_PORT:0)).toString()];this.registerForServerStarted(e=>this.additionalPidsToTerminate.push(e.pid)),this.createProcess(void 0,s,r)}shouldHandleMessage(e){return e.startsWith("{")&&e.endsWith("}")}isNotification(e){return e.event||"server.started"===e.method}handleNotification(e){switch(e.method||e.event){case"server.started":this.notify(this.serverStartedSubscriptions,e.params)}}registerForServerStarted(e){return this.subscribe(this.serverStartedSubscriptions,e)}vmRegister(e){return this.sendRequest("vm.register",e)}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(45),a=s(2),c=s(46),u=s(71);t.GoToSuperCommand=class{constructor(e){this.analyzer=e,this.disposables=[],this.disposables.push(i.commands.registerCommand("dart.goToSuper",this.goToSuper,this))}goToSuper(){return r(this,void 0,void 0,function*(){const e=o.getActiveDartEditor();if(!e)return void i.window.showWarningMessage("No active Dart editor.");const t=e.document,s=e.selection.start,r=u.findNearestOutlineNode(t,s),l=r&&r.element&&r.element.location?r.element.location.offset:t.offsetAt(s),h=yield this.analyzer.searchGetTypeHierarchy({file:n.fsPath(t.uri),offset:l,superOnly:!0});if(!h||!h.hierarchyItems||!h.hierarchyItems.length||1===h.hierarchyItems.length)return;const d=!h.hierarchyItems[0].memberElement,p=h.hierarchyItems.slice(1).find(e=>d?!!e.classElement:!!e.memberElement),g=d?p&&p.classElement:p&&p.memberElement;if(!g||!g.location)return;const f=yield i.workspace.openTextDocument(g.location.file),m=yield i.window.showTextDocument(f),v=a.toRangeOnLine(g.location);c.showCode(m,v,v,v)})}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(0),a=s(5),c=s(3),u=s(10);t.OpenInOtherEditorCommands=class{constructor(e,t){this.logger=e,this.sdks=t,this.disposables=[],this.disposables.push(o.commands.registerCommand("flutter.openInAndroidStudio",this.openInAndroidStudio,this),o.commands.registerCommand("flutter.openInXcode",this.openInXcode,this))}openInAndroidStudio(e){return r(this,void 0,void 0,function*(){const t=c.fsPath(e);let s=yield this.getAndroidStudioDir(t);s?a.isMac&&s.endsWith("/Contents")?(s=s.substr(0,s.length-"/Contents".length),u.safeSpawn(t,"open",["-a",s,t])):u.safeSpawn(t,n.join(s,a.androidStudioPath),[t]):o.window.showErrorMessage("Unable to find Android Studio")})}openInXcode(e){return r(this,void 0,void 0,function*(){const t=c.fsPath(e),s=i.readdirSync(t).filter(e=>i.statSync(n.join(t,e)).isDirectory()).filter(e=>e.endsWith(".xcworkspace")||e.endsWith(".xcodeproj")).sort((e,t)=>e.endsWith(".xcworkspace")?0:1);if(!s||!s.length)return void o.window.showErrorMessage("Unable to find an Xcode project in your 'ios' folder");const r=n.join(t,s[0]);u.safeSpawn(t,"open",["-a","Xcode",r])})}getAndroidStudioDir(e){return new Promise((t,s)=>{if(!this.sdks.flutter)return void s("Cannot find Android Studio without a Flutter SDK");const r=n.join(this.sdks.flutter,a.flutterPath),i=u.safeSpawn(e,r,["config","--machine"]),o=[];i.stdout.on("data",e=>{o.push(e.toString())}),i.on("exit",()=>{try{if(o.length){const e=JSON.parse(o.join(""));return void t(e["android-studio-dir"])}}catch(e){this.logger.error(e)}s()})})}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(5),o=s(3),a=s(2),c={EXTRACT_LOCAL_VARIABLE:function(e){return r(this,void 0,void 0,function*(){const t=e,s=t&&t.names&&t.names.length?t.names[0]:"x";return{name:s,extractAll:!1}})},EXTRACT_METHOD:function(e){return r(this,void 0,void 0,function*(){const t=e,s=t&&t.names&&t.names.length?t.names[0]:void 0,r=yield i.window.showInputBox({prompt:"Enter a name for the method",value:s});if(r)return{createGetter:!1,extractAll:!1,name:r,parameters:t&&t.parameters,returnType:t&&t.returnType}})},EXTRACT_WIDGET:function(e){return r(this,void 0,void 0,function*(){const e=yield i.window.showInputBox({prompt:"Enter a name for the widget"});return e?{name:e}:void 0})}};t.RefactorCommands=class{constructor(e,t,s){this.logger=e,this.context=t,this.analyzer=s,this.commands=[],this.commands.push(i.commands.registerCommand("_dart.performRefactor",this.performRefactor,this))}performRefactor(e,t,s){return r(this,void 0,void 0,function*(){if(!e||e.isClosed)return;const r=e.version,n=yield this.getRefactor(e,s,t,!0);if(this.shouldAbortRefactor(n))return;let o;if(c[s]&&!(o=yield c[s](n.feedback)))return;const a=yield this.getRefactor(e,s,t,!1,o);(yield this.shouldApplyEdits(a,e,r))&&(yield i.commands.executeCommand("_dart.applySourceChange",e,a.change))})}getRefactor(e,t,s,i,n){return r(this,void 0,void 0,function*(){let r=3;for(;;)try{return r--,yield this.analyzer.editGetRefactoring({file:o.fsPath(e.uri),kind:t,length:e.offsetAt(s.end)-e.offsetAt(s.start),offset:e.offsetAt(s.start),options:n,validateOnly:i})}catch(e){if(this.logger.error(e),r<=0||"REFACTORING_REQUEST_CANCELLED"!==e.code)throw e;this.logger.info(`getRefactor failed, will try ${r} more times...`)}})}shouldAbortRefactor(e){const t=e.initialProblems.concat(e.optionsProblems).concat(e.finalProblems).filter(e=>"FATAL"===e.severity);return!!t.length&&(i.window.showErrorMessage(t[0].message),!0)}shouldApplyEdits(e,t,s){return r(this,void 0,void 0,function*(){const r=e.initialProblems.concat(e.optionsProblems).concat(e.finalProblems),o=r.filter(e=>"FATAL"===e.severity),c=r.filter(e=>"ERROR"===e.severity||"WARNING"===e.severity),u=!!r.find(e=>"ERROR"===e.severity);if(o.length)return i.window.showErrorMessage(a.unique(o.map(e=>e.message)).join("\n\n")+"\n\nYour refactor was not applied."),!1;if(!e.change)return!1;let l=!0;if(c.length){const e=u?i.window.showErrorMessage:i.window.showWarningMessage;l=n.REFACTOR_ANYWAY===(yield e(a.unique(c.map(e=>e.message)).join("\n\n"),n.REFACTOR_ANYWAY))}return l&&t.version!==s?(i.window.showErrorMessage(n.REFACTOR_FAILED_DOC_MODIFIED),!1):l})}dispose(){for(const e of this.commands)e.dispose()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(1),n=s(0),o=s(3);t.isPubGetProbablyRequired=function(e){const t=o.fsPath(e),s=i.join(t,"pubspec.yaml"),n=i.join(t,".packages");return!(!t||!r.existsSync(s)||!new RegExp("dependencies\\s*:","i").test(r.readFileSync(s).toString())||r.existsSync(n)&&!(r.statSync(s).mtime>r.statSync(n).mtime))},t.promptToRunPubGet=function(e){n.window.showInformationMessage("Some packages are missing or out of date, would you like to get them now?","Get packages").then(t=>{"Get packages"===t&&function(e){let t=n.commands.executeCommand("dart.getPackages",e[0]);for(let s=1;s<e.length;s++)t=t.then(t=>{if(0===t)return n.commands.executeCommand("dart.getPackages",e[s])})}(e)})}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(5),a=s(7),c=s(11),u=s(10),l="Stagehand",h="stagehand";t.Stagehand=class{constructor(e,t,s){this.logger=e,this.sdks=t,this.pubGlobal=s}promptToInstallIfRequired(){return this.pubGlobal.promptToInstallIfRequired(l,h,o.stagehandInstallationInstructionsUrl,"3.3.0")}getTemplates(){return r(this,void 0,void 0,function*(){const e=yield this.getTemplateJson();return JSON.parse(e)})}getTemplateJson(){return r(this,void 0,void 0,function*(){return this.runCommandWithProgress("Fetching Stagehand templates...",["global","run","stagehand","--machine"])})}runCommandWithProgress(e,t){return n.window.withProgress({location:n.ProgressLocation.Notification,title:e},e=>this.runCommand(t))}runCommand(e){return new Promise((t,s)=>{const r=i.join(this.sdks.dart,o.pubPath),n=u.safeSpawn(void 0,r,e);c.logProcess(this.logger,a.LogCategory.CommandProcesses,n);const l=[],h=[];n.stdout.on("data",e=>l.push(e.toString())),n.stderr.on("data",e=>h.push(e.toString())),n.on("close",e=>{e?s(`Stagehand exited with code ${e}.\n\n${l.join("")}\n\n${h.join("")}`):t(l.join(""))})})}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(18),o=s(12),a=s(1),c=s(5),u=s(9),l=s(10);t.getFlutterSnippets=function(e,t,s){return s.supportsFlutterCreateListSamples?function(e,t){return r(this,void 0,void 0,function*(){if(!t.flutter)throw new Error("Flutter SDK not available");const s=a.join(t.flutter,c.flutterPath),r=`flutter-samples-${u.getRandomInt(4096,65536).toString(16)}.txt`,n=a.join(o.tmpdir(),r);try{const t=yield l.runProcess(e,void 0,s,["create","--list-samples",n]);if(0!==t.exitCode)throw new Error(`Failed to get Flutter samples from SDK (${t.exitCode})\n\n${t.stderr}\n\n${t.stdout}`);const r=i.readFileSync(n,{encoding:"utf8"});return JSON.parse(r)}finally{u.tryDeleteFile(n)}})}(e,t):new Promise((e,t)=>{const s=n.request({hostname:"api.flutter.dev",method:"GET",path:"/snippets/index.json",port:443},s=>{if(!s||!s.statusCode||s.statusCode<200||s.statusCode>300)t({message:`Failed to get Flutter samples ${s&&s.statusCode}: ${s&&s.statusMessage}`});else{const t=[];s.on("data",e=>t.push(e.toString())),s.on("end",()=>{const s=t.join("");e(JSON.parse(s))})}});s.end()})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(1),n=s(0),o=s(5),a=s(4),c=s(9),u=s(8),l=s(2);class h{constructor(e,t){this.logger=e,this.sdks=t}changeSdk(){this.sdkPaths?this.searchForSdks(this.sdkPaths):n.window.showWarningMessage("Set `${configName}` to enable fast SDK switching.")}searchForSdks(e){let t=[];e.filter(r.existsSync).forEach(e=>{t.push(e),t=t.concat(c.getChildFolders(e))}),this.currentSdk&&-1===t.indexOf(this.currentSdk)&&t.push(this.currentSdk);const s=t.filter(e=>r.statSync(e).isDirectory()).filter(e=>r.existsSync(i.join(e,this.executablePath))).map(e=>{const t=r.realpathSync(i.join(e,this.executablePath)),s=i.dirname(i.dirname(t)),n=l.getSdkVersion(this.logger,s);return{description:e===this.currentSdk&&this.configuredSdk?"Current setting":"",detail:e,folder:e,label:n?this.getLabel(n):"Unknown version",version:n}}).sort((e,t)=>a.versionIsAtLeast(e.version||"0.0.0",t.version||"0.0.0")?1:-1);if(0===s.length)return;const o=[{description:this.configuredSdk?"":"Current setting",detail:this.configuredSdk?void 0:`Found at ${this.currentSdk}`,folder:void 0,label:"Auto-detect SDK location",version:void 0}].concat(s);n.window.showQuickPick(o,{placeHolder:"Select an SDK to use"}).then(e=>{e&&e.folder&&this.setSdk(e.folder)})}}t.DartSdkManager=class extends h{get sdkPaths(){return u.config.sdkPaths}get currentSdk(){return this.sdks.dart}get configuredSdk(){return u.config.sdkPath}get configName(){return"dart.sdkPaths"}get executablePath(){return o.dartVMPath}getLabel(e){return`Dart SDK ${e}`}setSdk(e){u.config.setSdkPath(e)}};t.FlutterSdkManager=class extends h{get sdkPaths(){return u.config.flutterSdkPaths}get currentSdk(){return this.sdks.flutter}get configuredSdk(){return u.config.flutterSdkPath}get configName(){return"dart.flutterSdkPaths"}get executablePath(){return o.flutterPath}getLabel(e){return`Flutter SDK ${e}`}setSdk(e){u.config.setFlutterSdkPath(e)}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(56),o=s(13);t.CURSOR_IS_IN_TEST="dart-code:cursorIsInTest",t.cursorIsInTest=!1;t.TestCommands=class{constructor(e){this.logger=e,this.disposables=[],this.disposables.push(i.commands.registerCommand("dart.runTestAtCursor",()=>this.runTestAtCursor(!1),this),i.commands.registerCommand("dart.debugTestAtCursor",()=>this.runTestAtCursor(!0),this),i.window.onDidChangeTextEditorSelection(e=>this.updateContext(e)))}runTestAtCursor(e){return r(this,void 0,void 0,function*(){const t=i.window.activeTextEditor,s=t&&t.selection&&this.testForCursor(t);if(s){const t=e?"_dart.startDebuggingTestFromOutline":"_dart.startWithoutDebuggingTestFromOutline";i.commands.executeCommand(t,s)}else i.window.showWarningMessage("There is no test at the current location.")})}updateContext(e){const s=!!(e.textEditor&&e.selections&&1===e.selections.length&&this.testForCursor(e.textEditor));i.commands.executeCommand("setContext",t.CURSOR_IS_IN_TEST,s),t.cursorIsInTest=s}testForCursor(e){const t=e.document,s=o.openFileTracker.getOutlineFor(t.uri);if(!s||!s.children||!s.children.length)return;if(!o.openFileTracker.supportsPubRunTest(t.uri))return;const r=new n.TestOutlineVisitor(this.logger);return r.visit(s),r.tests.reverse().find(s=>{const r=t.positionAt(s.offset),n=t.positionAt(s.offset+s.length);return new i.Range(r,n).contains(e.selection)})}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(45),a=s(2),c=s(46);function u(e,t){return e[t].classElement.name}t.TypeHierarchyCommand=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.disposables.push(i.commands.registerCommand("dart.showTypeHierarchy",this.showTypeHierarchy,this))}showTypeHierarchy(){return r(this,void 0,void 0,function*(){const e=o.getActiveDartEditor();if(!e)return void i.window.showWarningMessage("No active Dart editor.");const t=e.document,s=e.selection,r=(yield this.analyzer.searchGetTypeHierarchy({file:n.fsPath(t.uri),offset:t.offsetAt(e.selection.active)})).hierarchyItems;if(!r)return void i.window.showInformationMessage("Type hierarchy not available.");const a={onDidSelectItem:e=>this.openLocation(e,!0),placeHolder:u(r,0)},c=[],l=r[0];c.push(l),function e(t,s,r){if(r.superclass){const i=t[r.superclass];"Object"!==i.classElement.name&&(s.unshift(i),e(t,s,i))}}(r,c,l),function e(t,s,r){for(const e of r.subclasses){const r=t[e];s.push(r)}for(const i of r.subclasses){const r=t[i];r.subclasses.length>0&&e(t,s,r)}}(r,c,l);const h=yield i.window.showQuickPick(c.map(e=>(function(e,t){let s="";return void 0!==e.superclass&&"Object"!==u(t,e.superclass)&&(s+=`extends ${u(t,e.superclass)}`),e.interfaces.length>0&&(s.length>0&&(s+=", "),s+=`implements ${e.interfaces.map(e=>u(t,e)).join(", ")}`),e.mixins.length>0&&(s.length>0&&(s+=", "),s+=`with ${e.mixins.map(e=>u(t,e)).join(", ")}`),{description:s,label:e.classElement.name,location:e.classElement.location}})(e,r)),a);if(h&&h.location)yield this.openLocation(h);else{const r=yield i.window.showTextDocument(t);r.revealRange(e.selection,i.TextEditorRevealType.InCenterIfOutsideViewport),r.selection=s}})}openLocation(e,t=!1){return r(this,void 0,void 0,function*(){if(!e.location)return void this.logger.warn("Unable to open item with no location");const s=e.location,r=yield i.workspace.openTextDocument(s.file),n=yield i.window.showTextDocument(r,{preserveFocus:t,preview:t}),o=a.toRangeOnLine(s);c.showCode(n,o,o,o)})}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(3),n=s(2);t.ClosingLabelsDecorations=class{constructor(e){this.analyzer=e,this.subscriptions=[],this.decorationType=r.window.createTextEditorDecorationType({after:{color:new r.ThemeColor("dart.closingLabels"),margin:"2px"},rangeBehavior:r.DecorationRangeBehavior.ClosedOpen}),this.subscriptions.push(this.analyzer.registerForAnalysisClosingLabels(e=>{this.activeEditor&&e.file===i.fsPath(this.activeEditor.document.uri)&&(this.closingLabels=e,this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>this.update(),500))})),this.subscriptions.push(r.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),r.window.activeTextEditor&&this.setTrackingFile(r.window.activeTextEditor)}update(){if(!this.closingLabels||!this.activeEditor||this.closingLabels.file!==i.fsPath(this.activeEditor.document.uri))return;const e=[];for(const t of this.closingLabels.labels){const s=this.activeEditor.document.positionAt(t.offset+t.length),i=s.character>0?new r.Range(s.translate({characterDelta:-1}),s):new r.Range(s,s.translate({characterDelta:1})),n=this.activeEditor.document.getText(i),o=this.activeEditor.document.lineAt(s).range.end;if("]"!==n&&")"!==n)return;const a=e[o.line];if(a)a.renderOptions.after.contentText=" // "+t.label+" "+a.renderOptions.after.contentText;else{const s={range:new r.Range(this.activeEditor.document.positionAt(t.offset),o),renderOptions:{after:{contentText:" // "+t.label}}};e[o.line]=s}}this.activeEditor.setDecorations(this.decorationType,Object.keys(e).map(e=>parseInt(e,10)).map(t=>e[t]))}setTrackingFile(e){e&&n.isAnalyzable(e.document)?(this.activeEditor=e,this.closingLabels=void 0,this.analyzer.forceNotificationsFor(i.fsPath(e.document.uri))):this.activeEditor=void 0}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(4),n=s(135),o=s(3),a=s(13),c=s(8),u=" ",l="│",h="─",d="└",p="├";t.FlutterUiGuideDecorations=class{constructor(e){this.analyzer=e,this.disposables=[],this.borderDecoration=r.window.createTextEditorDecorationType({rangeBehavior:r.DecorationRangeBehavior.OpenOpen}),this.disposables.push(r.window.onDidChangeActiveTextEditor(e=>this.buildForTextEditor(e))),c.config.previewFlutterUiGuidesCustomTracking&&(this.tracker=new f,this.disposables.push(this.tracker),this.tracker.onGuidesChanged(([e,t])=>this.buildFromUpdatedGuides(e,t))),r.window.activeTextEditor&&this.buildForTextEditor(r.window.activeTextEditor),this.disposables.push(this.analyzer.registerForFlutterOutline(e=>{const t=r.window.activeTextEditor;t&&t.document&&o.fsPath(t.document.uri)===e.file&&this.buildFromOutline(t,e.outline)}))}buildForTextEditor(e){e&&e.document&&this.buildFromOutline(e,a.openFileTracker.getFlutterOutlineFor(e.document.uri))}buildFromOutline(e,t){if(this.tracker&&this.tracker.clear(),!e||!e.document||!t)return;if(e.document.getText().length!==t.length)return;const s=this.extractGuides(e.document,t);this.tracker&&this.tracker.trackDoc(e.document,s),this.renderGuides(e,s,"#A3A3A3")}buildFromUpdatedGuides(e,t){r.window.activeTextEditor&&r.window.activeTextEditor.document===e&&this.renderGuides(r.window.activeTextEditor,t,"#A3A3A3")}renderGuides(e,t,s){const r={};for(const e of t)for(let t=e.start.line;t<=e.end.line;t++)r[t]=r[t]||[],r[t].push(e);const i=this.buildDecorations(e.document,e.options.tabSize,r,s);e.setDecorations(this.borderDecoration,i)}buildDecorations(e,t,s,i){const n=[];for(const o of Object.keys(s).map(e=>parseInt(e,10))){const a=e.lineAt(o),c=Math.min(...s[o].map(e=>Math.min(e.start.character,e.end.character))),g=Math.max(...s[o].map(e=>Math.max(e.start.character,e.end.character))),f=a.range.end.character,m=Math.max(f<c?0:c,0),v=new Array(g).fill(u);for(const e of s[o])if(o!==e.end.line)v[e.start.character]===u?v[e.start.character]=l:v[e.start.character]===d&&(v[e.start.character]=p);else for(let t=e.start.character;t<=e.end.character;t++)t===e.start.character?v[t]=d:t===e.start.character?v[t]=l:v[t]=h;v.fill(u,a.firstNonWhitespaceCharacterIndex,a.range.end.character),v.splice(0,m);const b=[];for(let e=0;e<v.length;e++)if(b.push(v[e]),"\t"===a.text[m+e]){const s=v[e]===h||v[e]===d||v[e]===p?h:u;for(let e=0;e<t-1;e++)b.push(s)}n.push({range:new r.Range(new r.Position(o,m),new r.Position(o,m)),renderOptions:{before:{color:i,contentText:b.join(""),margin:"0 3px 0 -3px",width:"0"}}})}return n}firstNonWhitespace(e,t){return new r.Position(t,e.lineAt(t).firstNonWhitespaceCharacterIndex)}extractGuides(e,t){let s=[];if("NEW_INSTANCE"===t.kind){const r=e.positionAt(t.offset).line,i=t.children&&t.children.map(t=>e.positionAt(t.offset).line).filter(e=>e>r);if(i){const t=this.firstNonWhitespace(e,r);i.forEach((r,i)=>{const n=this.firstNonWhitespace(e,r);s.push(new g(t,n))})}}return t.children&&(s=s.concat(i.flatMap(t.children,t=>this.extractGuides(e,t)))),s}dispose(){this.disposables.forEach(e=>e.dispose())}};class g{constructor(e,t){this.start=e,this.end=t}}t.WidgetGuide=g;class f{constructor(){this.disposables=[],this.tracker=new n.DocumentPositionTracker,this.guideMap=new Map,this.onGuidesChangedEmitter=new r.EventEmitter,this.onGuidesChanged=this.onGuidesChangedEmitter.event,this.disposables.push(this.tracker),this.tracker.onPositionsChanged(([e,t])=>{const s=[];for(const e of this.guideMap.keys()){const r=this.guideMap.get(e),i=r[0],n=r[1],o=t.get(i),a=t.get(n);o&&a&&s.push(new g(o,a))}this.onGuidesChangedEmitter.fire([e,s])})}clear(){this.guideMap.clear(),this.tracker.clear()}trackDoc(e,t){this.guideMap.clear();for(const e of t)this.guideMap.set(e,[e.start,e.end]);const s=i.flatMap([...this.guideMap.values()],e=>[e[0],e[1]]);this.tracker.trackDoc(e,s)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.DocumentPositionTracker=class{constructor(){this.disposables=[],this.tracker=new i,this.positionMap=new Map,this.onPositionsChangedEmitter=new r.EventEmitter,this.onPositionsChanged=this.onPositionsChangedEmitter.event,this.disposables.push(this.tracker),this.tracker.onOffsetsChanged(([e,t])=>{const s=new Map;for(const r of this.positionMap.keys()){const i=this.positionMap.get(r),n=t.get(i);n&&s.set(r,e.positionAt(n))}this.onPositionsChangedEmitter.fire([e,s])})}clear(){this.positionMap.clear(),this.tracker.clear()}trackDoc(e,t){this.positionMap.clear();for(const s of t)this.positionMap.set(s,e.offsetAt(s));this.tracker.trackDoc(e,[...this.positionMap.values()])}dispose(){this.disposables.forEach(e=>e.dispose())}};class i{constructor(){this.disposables=[],this.offsetMap=new Map,this.onOffsetsChangedEmitter=new r.EventEmitter,this.onOffsetsChanged=this.onOffsetsChangedEmitter.event,this.disposables.push(r.workspace.onDidChangeTextDocument(e=>this.handleUpdate(e)))}trackDoc(e,t){this.document=e,this.offsetMap.clear();for(const e of t)this.offsetMap.set(e,e)}clear(){this.document=void 0,this.offsetMap.clear()}handleUpdate(e){if(e.document===this.document){for(const t of[...this.offsetMap.keys()]){const s=this.offsetMap.get(t),r=this.updateOffset(s,e);this.offsetMap.set(t,r)}this.onOffsetsChangedEmitter.fire([e.document,this.offsetMap])}}updateOffset(e,t){if(t.contentChanges.find(t=>t.rangeOffset<e&&t.rangeOffset+t.rangeLength>e))return;const s=t.contentChanges.filter(t=>t.rangeOffset+t.rangeLength<=e).map(e=>e.text.length-e.rangeLength).reduce((e,t)=>e+t,0);return e+s}dispose(){this.disposables.forEach(e=>e.dispose())}}t.DocumentOffsetTracker=i},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(4),a=s(3),c=s(2);t.HotReloadCoverageDecorations=class{constructor(e,t){this.logger=e,this.subscriptions=[],this.fileState={},this.isDebugging=!1,this.modifiedDecorationType=n.window.createTextEditorDecorationType({gutterIconPath:n.Uri.file(i.join(c.extensionPath,"media/icons/reload_coverage/modified.svg")),isWholeLine:!0,rangeBehavior:n.DecorationRangeBehavior.OpenOpen}),this.notRunDecorationType=n.window.createTextEditorDecorationType({gutterIconPath:n.Uri.file(i.join(c.extensionPath,"media/icons/reload_coverage/not_run.svg")),isWholeLine:!0,rangeBehavior:n.DecorationRangeBehavior.OpenOpen}),this.subscriptions.push(n.workspace.onDidChangeTextDocument(e=>this.onDidChangeTextDocument(e))),this.subscriptions.push(t.onFirstFrame(()=>this.onFirstFrame())),this.subscriptions.push(n.window.onDidChangeVisibleTextEditors(e=>this.onDidChangeVisibleTextEditors(e))),this.subscriptions.push(t.onWillHotReload(()=>this.onWillHotReload())),this.subscriptions.push(t.onWillHotRestart(()=>this.onWillFullRestart())),this.subscriptions.push(n.debug.onDidStartDebugSession(e=>this.onDidStartDebugSession())),this.subscriptions.push(n.debug.onDidTerminateDebugSession(e=>this.onDidTerminateDebugSession())),this.subscriptions.push(t.onReceiveCoverage(e=>this.onReceiveCoverage(e)))}onFirstFrame(){return r(this,void 0,void 0,function*(){yield this.coverageFilesUpdate()})}onDidChangeVisibleTextEditors(e){return r(this,void 0,void 0,function*(){this.redrawDecorations(e),yield this.coverageFilesUpdate(),yield this.requestCoverageUpdate()})}onDidChangeTextDocument(e){if(!this.isDebugging)return;const t=n.window.visibleTextEditors.find(t=>a.fsPath(t.document.uri)===a.fsPath(e.document.uri));if(!t)return;let s=this.fileState[a.fsPath(e.document.uri)];s||(s=this.fileState[a.fsPath(e.document.uri)]={modified:[],notRun:[]}),s.modified=s.modified.concat(s.notRun),s.notRun=[];for(const t of e.contentChanges){const e=t.range.start.line,r=t.range.end.line,i=r-e,n=t.text.split("\n").length-1-i;0!==n&&(s.modified=this.translateChanges(s.modified,e,r,n))}for(const r of e.contentChanges){const e=t.document.getText(r.range),i=r.text;if(i===e)continue;if(""===e.trim()&&!i)continue;if(!e&&""===i.trim())continue;const n=r.text.split("\n").length-1;for(let e=r.range.start.line;e<=r.range.start.line+n;e++)s.modified.push(e)}s.modified=o.uniq(s.modified),s.modified=s.modified.filter(e=>{try{const s=t.document.lineAt(e).text.trim();return""!==s&&"{"!==s&&"}"!==s&&"/"!==s&&!s.startsWith("//")&&!s.startsWith("@")}catch(e){return this.logger.error(e),!1}}),this.redrawDecorations([t])}translateChanges(e,t,s,r){return e.map(e=>t>=e?e:t<=e&&s>=e?void 0:e+r).filter(e=>e)}onWillHotReload(){return r(this,void 0,void 0,function*(){for(const e of Object.keys(this.fileState)){const t=this.fileState[e];t.modified.forEach(e=>t.notRun.push(e)),t.modified.length=0}yield this.coverageFilesUpdate(),this.redrawDecorations(n.window.visibleTextEditors)})}onWillFullRestart(){this.clearAllMarkers()}onDidStartDebugSession(){this.isDebugging=!0}onDidTerminateDebugSession(){this.isDebugging=!1,this.clearAllMarkers()}clearAllMarkers(){for(const e of Object.keys(this.fileState))delete this.fileState[e];this.redrawDecorations(n.window.visibleTextEditors)}redrawDecorations(e){if(e)for(const t of e){const e=this.fileState[a.fsPath(t.document.uri)];t.setDecorations(this.modifiedDecorationType,e?this.toRanges(t,e.modified):[]),t.setDecorations(this.notRunDecorationType,e?this.toRanges(t,e.notRun):[])}}toRanges(e,t){return t.map(t=>e.document.lineAt(t).range)}coverageFilesUpdate(){return r(this,void 0,void 0,function*(){if(!this.isDebugging)return;const e=n.window.visibleTextEditors.map(e=>a.fsPath(e.document.uri)).filter(e=>this.fileState[e]&&0!==this.fileState[e].notRun.length);yield n.commands.executeCommand("_dart.coverageFilesUpdate",e)})}requestCoverageUpdate(){return r(this,void 0,void 0,function*(){this.isDebugging&&Object.keys(this.fileState).find(e=>0!==this.fileState[e].notRun.length)&&(yield n.commands.executeCommand("_dart.requestCoverageUpdate"))})}onReceiveCoverage(e){for(const t of e){const e=this.fileState[a.fsPath(t.scriptPath)];if(!e)continue;const s=n.window.visibleTextEditors.find(e=>a.fsPath(e.document.uri)===t.scriptPath);for(const s of t.hitLines)e.notRun=e.notRun.filter(e=>e!==s-1);this.redrawDecorations([s])}}dispose(){this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(30);t.setUpDaemonMessageHandler=function(e,t,s){t.subscriptions.push(s.registerForDaemonLog(e=>{i.getChannel("Flutter Daemon").appendLine(`${e.error?"[ERR] ":""}${e.log}`)})),t.subscriptions.push(s.registerForDaemonShowMessage(t=>{const s=`${t.title.trim().endsWith(".")?t.title.trim():`${t.title.trim()}.`} ${t.message}`.trim();switch(t.level){case"info":r.window.showInformationMessage(s);break;case"warning":r.window.showWarningMessage(s);break;case"error":r.window.showErrorMessage(s);break;default:e.warn(`Unexpected daemon.showMessage type: ${t.level}`)}}))}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(0),o=s(5),a=s(7),c=s(11),u=s(4),l=s(8),h=s(32),d=s(20),p=s(2),g=s(10),f=s(139);class m{static get empty(){return new m("0.0.0")}constructor(e){this.version=e}get canCreateEmulators(){return u.versionIsAtLeast(this.version,"0.4.0")}get canFlutterAttach(){return u.versionIsAtLeast(this.version,"0.4.1")}get providesPlatformTypes(){return u.versionIsAtLeast(this.version,"0.5.2")}}t.DaemonCapabilities=m;class v extends d.StdIOService{constructor(e,t,s){if(super(()=>l.config.flutterDaemonLogFile,new c.CategoryLogger(e,a.LogCategory.FlutterDaemon),l.config.maxLogLineLength,!0),this.hasStarted=!1,this.daemonStartedCompleter=new u.PromiseCompleter,this.capabilities=m.empty,this.daemonConnectedSubscriptions=[],this.deviceAddedSubscriptions=[],this.deviceRemovedSubscriptions=[],this.daemonLogMessageSubscriptions=[],this.daemonLogSubscriptions=[],this.daemonShowMessageSubscriptions=[],this.registerForDaemonConnected(e=>{this.additionalPidsToTerminate.push(e.pid),this.capabilities.version=e.version,i.commands.executeCommand("setContext",h.FLUTTER_SUPPORTS_ATTACH,this.capabilities.canFlutterAttach),this.deviceEnable().then(()=>this.deviceManager.updateStatusBar())}),this.createProcess(s,t,["daemon"]),this.deviceManager=new f.FlutterDeviceManager(e,this),o.isChromeOS&&l.config.flutterAdbConnectOnChromeOs){e.info("Running ADB Connect on Chrome OS");const t=g.safeSpawn(void 0,"adb",["connect","100.115.92.2:5555"]);c.logProcess(e,a.LogCategory.General,t)}}get isReady(){return this.hasStarted}dispose(){this.deviceManager.dispose(),super.dispose()}sendMessage(e){try{super.sendMessage(e)}catch(e){throw p.reloadExtension("The Flutter Daemon has terminated.",void 0,!0),e}}shouldHandleMessage(e){return!(!e.startsWith("[{")||!e.endsWith("}]"))&&(this.hasStarted||(this.hasStarted=!0,this.daemonStartedCompleter.resolve()),!0)}processUnhandledMessage(e){return r(this,void 0,void 0,function*(){let t;const s=v.outOfDateWarning.exec(e);s&&2===s.length?t=`Your installation of Flutter is ${s[1]} days old.`:-1!==e.indexOf(v.newVersionMessage)&&(t="A new version of Flutter is available"),t?(yield i.window.showWarningMessage(t,"Upgrade Flutter"))&&i.commands.executeCommand("flutter.upgrade"):(e.startsWith("Building ")||e.startsWith("Downloading ")||e.startsWith("Starting "))&&!e.startsWith("Starting device daemon")&&(this.hasStarted||(this.startupReporter?this.startupReporter.report({message:e}):i.window.withProgress({location:n.ProgressLocation.Notification,title:"Flutter Setup"},t=>(this.startupReporter=t,this.startupReporter.report({message:e}),this.daemonStartedCompleter.promise))))})}handleNotification(e){switch(e.event){case"daemon.connected":this.notify(this.daemonConnectedSubscriptions,e.params);break;case"device.added":this.notify(this.deviceAddedSubscriptions,e.params);break;case"device.removed":this.notify(this.deviceRemovedSubscriptions,e.params);break;case"daemon.logMessage":this.notify(this.daemonLogMessageSubscriptions,e.params);break;case"daemon.log":this.notify(this.daemonLogSubscriptions,e.params);break;case"daemon.showMessage":this.notify(this.daemonShowMessageSubscriptions,e.params)}}deviceEnable(){return this.sendRequest("device.enable")}getEmulators(){return this.sendRequest("emulator.getEmulators")}launchEmulator(e){return this.sendRequest("emulator.launch",{emulatorId:e})}createEmulator(e){return this.sendRequest("emulator.create",{name:e})}getSupportedPlatforms(e){return this.sendRequest("daemon.getSupportedPlatforms",{projectRoot:e})}registerForDaemonConnected(e){return this.subscribe(this.daemonConnectedSubscriptions,e)}registerForDeviceAdded(e){return this.subscribe(this.deviceAddedSubscriptions,e)}registerForDeviceRemoved(e){return this.subscribe(this.deviceRemovedSubscriptions,e)}registerForDaemonLogMessage(e){return this.subscribe(this.daemonLogMessageSubscriptions,e)}registerForDaemonLog(e){return this.subscribe(this.daemonLogSubscriptions,e)}registerForDaemonShowMessage(e){return this.subscribe(this.daemonShowMessageSubscriptions,e)}}v.outOfDateWarning=new RegExp("WARNING: .* Flutter is (\\d+) days old"),v.newVersionMessage="A new version of Flutter is available",t.FlutterDaemon=v},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(8);t.FlutterDeviceManager=class{constructor(e,t){this.logger=e,this.daemon=t,this.subscriptions=[],this.devices=[],this.statusBarItem=i.window.createStatusBarItem(i.StatusBarAlignment.Right,1),this.statusBarItem.tooltip="Flutter",this.statusBarItem.show(),this.updateStatusBar(),this.subscriptions.push(this.statusBarItem),this.subscriptions.push(i.commands.registerCommand("flutter.selectDevice",this.showDevicePicker,this)),this.subscriptions.push(i.commands.registerCommand("flutter.launchEmulator",this.promptForAndLaunchEmulator,this)),t.registerForDeviceAdded(this.deviceAdded.bind(this)),t.registerForDeviceRemoved(this.deviceRemoved.bind(this))}dispose(){this.subscriptions.forEach(e=>e.dispose())}deviceAdded(e){e=Object.assign({},e,{type:"device"}),this.devices.push(e);const t=!1!==e.ephemeral;(!this.currentDevice||n.config.flutterSelectDeviceWhenConnected&&t)&&(this.currentDevice=e,this.updateStatusBar())}deviceRemoved(e){this.devices=this.devices.filter(t=>t.id!==e.id),this.currentDevice&&this.currentDevice.id===e.id&&(this.currentDevice=0===this.devices.length?void 0:this.devices[this.devices.length-1],this.updateStatusBar())}showDevicePicker(){return r(this,void 0,void 0,function*(){const e=this.devices.sort(this.deviceSortComparer.bind(this)).map(e=>({description:e.platform,detail:e===this.currentDevice?"Current Device":e.emulator?"Emulator":"Physical Device",device:e,label:e.name})),t=yield i.window.showQuickPick(e,{placeHolder:"Select a device to use"});t&&(this.currentDevice=t.device,this.updateStatusBar())})}deviceSortComparer(e,t){return e===this.currentDevice?-1:t===this.currentDevice?1:e.name.localeCompare(t.name)}updateStatusBar(){this.currentDevice?this.statusBarItem.text=`${this.currentDevice.name} (${this.currentDevice.platform}${this.currentDevice.emulator?" Emulator":""})`:this.statusBarItem.text="No Devices",this.daemon.isReady?this.statusBarItem.show():this.statusBarItem.hide(),this.devices.length>1?(this.statusBarItem.tooltip=`${this.devices.length} Devices Connected`,this.statusBarItem.command="flutter.selectDevice"):1===this.devices.length?(this.statusBarItem.tooltip=void 0,this.statusBarItem.command=void 0):(this.statusBarItem.tooltip=void 0,this.statusBarItem.command="flutter.launchEmulator")}getEmulators(){return r(this,void 0,void 0,function*(){try{return(yield this.daemon.getEmulators()).map(e=>({category:e.category,id:e.id,name:e.name||e.id,platformType:e.platformType,type:"emulator"}))}catch(e){return this.logger.error({message:e}),[]}})}promptForAndLaunchEmulator(e=!1){return r(this,void 0,void 0,function*(){const t=(yield this.getEmulators()).map(e=>({alwaysShow:!1,description:e.id,emulator:e,isCreateEntry:!1,label:e.name}));if(e&&this.currentDevice)return!0;if(this.daemon.capabilities.canCreateEmulators&&t.push({alwaysShow:!0,description:"Creates and launches a new Android emulator",emulator:void 0,isCreateEntry:!0,label:"Create New"}),0===t.length)return!1;const s=new i.CancellationTokenSource,r=this.daemon.registerForDeviceAdded(()=>{s.cancel(),r.dispose()}),n=yield i.window.showQuickPick(t,{matchOnDescription:!0,placeHolder:"Connect a device or select an emulator to launch"},s.token);if(r.dispose(),!n||!n.isCreateEntry)return n?this.launchEmulator(n.emulator):!!this.currentDevice;{const e=void 0,t=this.daemon.createEmulator(e);i.window.withProgress({location:i.ProgressLocation.Notification,title:`${`Creating emulator ${e||""}`.trim()}...`},e=>t);const s=yield t;if(s.success)return this.launchEmulator({id:s.emulatorName,name:s.emulatorName});i.window.showErrorMessage(s.error)}})}launchEmulator(e){return r(this,void 0,void 0,function*(){try{yield i.window.withProgress({location:i.ProgressLocation.Notification},t=>r(this,void 0,void 0,function*(){t.report({message:`Launching ${e.name}...`}),yield this.daemon.launchEmulator(e.id),t.report({message:`Waiting for ${e.name} to connect...`});for(let e=0;e<120;e++)if(yield new Promise(e=>setTimeout(e,500)),this.currentDevice)return;throw new Error("Emulator didn't connect within 60 seconds")}))}catch(e){return i.window.showErrorMessage(`Failed to launch emulator: ${e}`),!1}return yield new Promise(e=>setTimeout(e,1e3)),!0})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(5),o=s(7),a=s(3),c=s(8),u=s(2);t.setUpHotReloadOnSave=function(e,t,s){let l;e.subscriptions.push(i.workspace.onDidSaveTextDocument(e=>{if(!i.debug.activeDebugSession)return;const h=s.flutterExtensions.serviceIsRegistered(o.FlutterService.HotReload)&&c.config.flutterHotReloadOnSave,d=!s.flutterExtensions.serviceIsRegistered(o.FlutterService.HotReload)&&s.flutterExtensions.serviceIsRegistered(o.FlutterService.HotRestart)&&c.config.flutterHotRestartOnSave;if(!h&&!d)return;const p=h?"flutter.hotReload":"flutter.hotRestart";if(!u.isAnalyzableAndInWorkspace(e)||".dart"!==r.extname(a.fsPath(e.uri)))return;const g=t.get(e.uri);g&&g.find(e=>e.severity===i.DiagnosticSeverity.Error)||(l&&clearTimeout(l),l=setTimeout(()=>{l=void 0,i.commands.executeCommand(p,{reason:n.restartReasonSave})},200))}))}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(2);t.AssistCodeActionProvider=class{constructor(e,t,s){this.logger=e,this.selector=t,this.analyzer=s,this.rank=10,this.metadata={providedCodeActionKinds:[i.CodeActionKind.Refactor]}}provideCodeActions(e,t,s,a){return r(this,void 0,void 0,function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!s||!s.only||s.only.contains(i.CodeActionKind.Refactor)))try{return(yield this.analyzer.editGetAssists({file:n.fsPath(e.uri),length:t.end.character-t.start.character,offset:e.offsetAt(t.start)})).assists.map(t=>this.convertResult(e,t))}catch(e){this.logger.error(e)}})}convertResult(e,t){const s=t.message,r=t.id?i.CodeActionKind.Refactor.append(t.id.replace("dart.assist.","")):i.CodeActionKind.Refactor,n=new i.CodeAction(s,r);return n.command={arguments:[e,t],command:"_dart.applySourceChange",title:s},n}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(0),a=s(4),c=s(31),u=s(3),l=s(70),h=s(8),d=s(2);t.DartCompletionItemProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.cachedCompletions={},this.existingImports={},this.disposables.push(t.registerForCompletionAvailableSuggestions(e=>this.storeCompletionSuggestions(e))),this.disposables.push(t.registerForCompletionExistingImports(e=>this.storeExistingImports(e)))}provideCompletionItems(e,t,s,i){return r(this,void 0,void 0,function*(){const r=e.lineAt(t.line).text.slice(0,t.character),n=e.getText(new o.Range(t,t.translate({characterDelta:200}))).trim().substr(0,1),a=h.config.for(e.uri),c=a.enableCompletionCommitCharacters,l=!c&&a.insertArgumentPlaceholders&&this.shouldAllowArgPlaceholders(r);if(!this.shouldAllowCompletion(r,i))return;const p=yield this.analyzer.completionGetSuggestionsResults({file:u.fsPath(e.uri),offset:e.offsetAt(t)});if(s&&s.isCancellationRequested)return;const g=p.results.map(t=>this.convertResult(e,n,c,l,p,t)),f=yield this.getCachedResults(e,s,n,c,l,e.offsetAt(t),p);if(yield d.resolvedPromise,s&&s.isCancellationRequested)return;const m=[...g,...f];return new o.CompletionList(m)})}shouldAllowCompletion(e,t){if(e=e.trim(),t.triggerKind===o.CompletionTriggerKind.TriggerCharacter)switch(t.triggerCharacter){case"{":return e.endsWith("${");case"'":return e.endsWith("import '")||e.endsWith("export '");case'"':return e.endsWith('import "')||e.endsWith('export "');case"/":case"\\":return e.startsWith('import "')||e.startsWith('export "')||e.startsWith("import '")||e.startsWith("export '")}return!0}shouldAllowArgPlaceholders(e){return!((e=e.trim()).startsWith('import "')||e.startsWith('export "')||e.startsWith("import '")||e.startsWith("export '"))}storeCompletionSuggestions(e){if(e.changedLibraries)for(const t of e.changedLibraries)this.cachedCompletions[t.id]=t;if(e.removedLibraries)for(const t of e.removedLibraries)delete this.cachedCompletions[t]}storeExistingImports(e){const t=e.imports,s={};for(const e of t.imports)for(const r of e.elements){const i=t.elements.strings[t.elements.names[r]],n=t.elements.strings[t.elements.uris[r]],o=t.elements.strings[e.uri],a=`${i}/${n}`;s[a]||(s[a]={}),s[a][o]=!0}this.existingImports[e.file]=s}resolveCompletionItem(e,t){return r(this,void 0,void 0,function*(){if(!e.suggestion)return!e.documentation&&e._documentation&&(e.documentation=e._documentation),e;const s=yield this.analyzer.completionGetSuggestionDetails({file:e.filePath,id:e.suggestionSetID,label:e.suggestion.label,offset:e.offset});return t&&t.isCancellationRequested?void 0:this.createCompletionItemFromSuggestion(e.document,e.nextCharacter,e.enableCommitCharacters,e.insertArgumentPlaceholders,e.replacementOffset,e.replacementLength,e.autoImportUri,e.relevance,e.suggestion,s)})}createCompletionItemFromSuggestion(e,t,s,r,i,n,o,a,c,u){const l=this.makeCompletion(e,t,s,r,{autoImportUri:o,completionText:u&&u.completion||c.label,displayText:c.label,docSummary:c.docSummary,elementKind:c.element?c.element.kind:void 0,isDeprecated:!1,kind:void 0,parameterNames:c.parameterNames,parameterType:void 0,parameters:c.element?c.element.parameters:void 0,relevance:a,replacementLength:n,replacementOffset:i,requiredParameterCount:c.requiredParameterCount,returnType:c.element?c.element.returnType:void 0,selectionLength:u&&u.change&&u.change.selection?0:void 0,selectionOffset:u&&u.change&&u.change.selection?u.change.selection.offset:void 0});return u&&u.change&&u.change.edits&&u.change.edits.length&&(this.appendAdditionalEdits(l,e,u.change),o&&(l.detail=`Auto import from '${o}'`+(l.detail?`\n\n${l.detail}`:""))),u&&!l.documentation&&l._documentation&&(l.documentation=l._documentation),l}getCachedResults(e,t,s,i,n,o,a){return r(this,void 0,void 0,function*(){if(!a.includedSuggestionSets||!a.includedElementKinds)return[];const r=a.libraryFile?this.existingImports[a.libraryFile]:void 0,c={};a.includedElementKinds.forEach(e=>c[e]=!0);const l={};a.includedSuggestionRelevanceTags.forEach(e=>l[e.tag]=e.relevanceBoost);const h=u.fsPath(e.uri),p=[],g={};for(const u of a.includedSuggestionSets){if(g[u.id])continue;if(g[u.id]=!0,yield d.resolvedPromise,t&&t.isCancellationRequested)return;const f=this.cachedCompletions[u.id];if(!f)return this.logger.warn(`Suggestion set ${u.id} was not available and therefore not included in the completion results`),[];const m=f.items.filter(e=>c[e.element.kind]).filter(e=>{const t=`${e.label}/${e.declaringLibraryUri}`,s=r&&r[t];return!s||s[f.uri]}).map(t=>{let r=0;t.relevanceTags&&t.relevanceTags.forEach(e=>r=Math.max(r,l[e]||0));const c=this.createCompletionItemFromSuggestion(e,s,i,n,a.replacementOffset,a.replacementLength,void 0,u.relevance+r,t,void 0);return Object.assign({autoImportUri:u.displayUri||f.uri,document:e,enableCommitCharacters:i,filePath:h,insertArgumentPlaceholders:n,nextCharacter:s,offset:o,relevance:u.relevance+r,replacementLength:a.replacementLength,replacementOffset:a.replacementOffset,suggestion:t,suggestionSetID:u.id},c)});p.push(m)}return[].concat(...p)})}convertResult(e,t,s,r,i,n){return this.makeCompletion(e,t,s,r,{completionText:n.completion,displayText:n.displayText,docSummary:n.docSummary,elementKind:n.element?n.element.kind:void 0,isDeprecated:n.isDeprecated,kind:n.kind,parameterNames:n.parameterNames,parameterType:n.parameterType,parameters:n.element?n.element.parameters:void 0,relevance:n.relevance,replacementLength:i.replacementLength,replacementOffset:i.replacementOffset,requiredParameterCount:n.requiredParameterCount,returnType:n.returnType||(n.element?n.element.returnType:void 0),selectionLength:n.selectionLength,selectionOffset:n.selectionOffset})}makeCompletion(e,t,s,r,i){const n=i.elementKind?this.getElementKind(i.elementKind):void 0;let a=i.displayText||i.completionText,u="";const l=new o.SnippetString;let h=!1;const d="("===t;if(i.parameters&&n!==o.CompletionItemKind.Property&&"OVERRIDE"!==i.kind&&-1===a.indexOf("(")){a+=2===i.parameters.length?"()":"(…)",u=i.parameters;const e=i.parameterNames&&i.parameterNames.length>0;if(r&&e&&!d){l.appendText(i.completionText);const e=i.parameterNames.slice(0,i.requiredParameterCount);if(l.appendText("("),e.length){l.appendPlaceholder(e[0]);for(const t of e.slice(1))l.appendText(", "),l.appendPlaceholder(t)}else l.appendTabstop(0);l.appendText(")")}else r&&!d?(l.appendText(i.completionText),l.appendText("("),e&&l.appendTabstop(0),l.appendText(")")):l.appendText(i.completionText)}else if(i.selectionOffset>0){const e=i.completionText.slice(0,i.selectionOffset),t=i.completionText.slice(i.selectionOffset,i.selectionOffset+i.selectionLength);t||" "!==i.completionText.slice(i.selectionOffset-1,i.selectionOffset)||(h=!0);const s=i.completionText.slice(i.selectionOffset+i.selectionLength);l.appendText(e),t?l.appendPlaceholder(t):l.appendTabstop(0),l.appendText(s)}else l.appendText(i.completionText);n===o.CompletionItemKind.Property?u="GETTER"===i.elementKind?i.returnType:i.parameters?i.parameters.substring(1,i.parameters.lastIndexOf(" ")):"":i.returnType?u=""===u?i.returnType:u+" → "+i.returnType:i.parameterType&&(u=i.parameterType),a.endsWith(",")&&(a=a.substr(0,a.length-1).trim());const p=n||(i.kind?this.getSuggestionKind(i.kind,a):void 0),g=c.cleanDartdoc(i.docSummary),f=new o.CompletionItem(a,p);return f.filterText=a.split("(")[0],f.detail=i.isDeprecated||u?(i.isDeprecated?"(deprecated) ":"")+(u||""):void 0,f._documentation=g?new o.MarkdownString(g):void 0,f.insertText=l,f.keepWhitespace=!0,f.range=new o.Range(e.positionAt(i.replacementOffset),e.positionAt(i.replacementOffset+i.replacementLength)),s&&(f.commitCharacters=this.getCommitCharacters(i.kind)),-1!==["import '';"].indexOf(a)&&(h=!0),"IMPORT"===i.kind&&a.endsWith("/")&&(h=!0),h&&(f.command={command:"editor.action.triggerSuggest",title:"Suggest"}),f.sortText=(1e6-i.relevance).toString()+a.trim(),f}getSuggestionKind(e,t){switch(e){case"ARGUMENT_LIST":return o.CompletionItemKind.Variable;case"IMPORT":return t.startsWith("dart:")?o.CompletionItemKind.Module:".dart"===i.extname(t.toLowerCase())?o.CompletionItemKind.File:o.CompletionItemKind.Folder;case"IDENTIFIER":return o.CompletionItemKind.Variable;case"INVOCATION":return o.CompletionItemKind.Method;case"KEYWORD":return o.CompletionItemKind.Keyword;case"NAMED_ARGUMENT":case"OPTIONAL_ARGUMENT":return o.CompletionItemKind.Variable;case"PARAMETER":return o.CompletionItemKind.Value}}getElementKind(e){switch(e){case"CLASS":case"CLASS_TYPE_ALIAS":return o.CompletionItemKind.Class;case"COMPILATION_UNIT":return o.CompletionItemKind.Module;case"CONSTRUCTOR":case"CONSTRUCTOR_INVOCATION":return o.CompletionItemKind.Constructor;case"ENUM":return o.CompletionItemKind.Enum;case"ENUM_CONSTANT":return o.CompletionItemKind.EnumMember;case"FIELD":return o.CompletionItemKind.Field;case"FILE":return o.CompletionItemKind.File;case"FUNCTION":case"FUNCTION_TYPE_ALIAS":return o.CompletionItemKind.Function;case"GETTER":return o.CompletionItemKind.Property;case"LABEL":case"LIBRARY":return o.CompletionItemKind.Module;case"LOCAL_VARIABLE":return o.CompletionItemKind.Variable;case"METHOD":return o.CompletionItemKind.Method;case"PARAMETER":case"PREFIX":return o.CompletionItemKind.Variable;case"SETTER":return o.CompletionItemKind.Property;case"TOP_LEVEL_VARIABLE":case"TYPE_PARAMETER":return o.CompletionItemKind.Variable;case"UNIT_TEST_GROUP":return o.CompletionItemKind.Module;case"UNIT_TEST_TEST":return o.CompletionItemKind.Method;case"UNKNOWN":return o.CompletionItemKind.Value}}getCommitCharacters(e){switch(e){case"IDENTIFIER":case"INVOCATION":return[".",",","(","["]}}appendAdditionalEdits(e,t,s){if(!s)return;if(l.hasOverlappingEdits(s))return this.logger.error("Unable to insert imports because of overlapping edits from the server."),void n.window.showErrorMessage("Unable to insert imports because of overlapping edits from the server");const r=u.fsPath(t.uri),i=s.edits.filter(e=>e.file===r),o=s.edits.filter(e=>e.file!==r);if(i.length&&(e.additionalTextEdits=a.flatMap(i,e=>e.edits.map(e=>{const s=new n.Range(t.positionAt(e.offset),t.positionAt(e.offset+e.length));return new n.TextEdit(s,e.replacement)}))),o.length){const r={edits:o,id:s.id,linkedEditGroups:void 0,message:s.message,selection:s.selection};e.command={arguments:[t,r],command:"_dart.applySourceChange",title:"Automatically add imports"}}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(69),o=s(23),a=s(13),c=s(2);t.DartDocumentSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t}provideDocumentSymbols(e,t){return r(this,void 0,void 0,function*(){const s=yield n.waitFor(()=>a.openFileTracker.getOutlineFor(e.uri),500,6e4,t);if(!t.isCancellationRequested&&s&&s.children&&s.children.length)return s.children.map(t=>this.convertResult(e,t))})}convertResult(e,t){const s=new i.DocumentSymbol(t.element.name||"<unnamed>",t.element.parameters,o.getSymbolKindForElementKind(this.logger,t.element.kind),this.getCodeOffset(e,t),c.toRange(e,t.element.location.offset,t.element.location.length));return t.children&&t.children.length&&(s.children=t.children.filter(this.shouldShow).map(t=>this.convertResult(e,t))),s}shouldShow(e){return"CONSTRUCTOR_INVOCATION"!==e.element.kind&&"FUNCTION_INVOCATION"!==e.element.kind}getCodeOffset(e,t){return c.toRange(e,t.codeOffset||t.offset,t.codeLength||t.length)}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(13);t.DartFoldingProvider=class{constructor(e){this.analyzer=e}provideFoldingRanges(e,t,s){return r(this,void 0,void 0,function*(){if(yield this.analyzer.currentAnalysis,s&&s.isCancellationRequested)return;let t;for(let r=0;r<5&&!(t=n.openFileTracker.getFoldingRegionsFor(e.uri));r++)if(yield new Promise(e=>setTimeout(e,1e3*r)),s&&s.isCancellationRequested)return;return!s.isCancellationRequested&&t?t.map(t=>new i.FoldingRange(e.positionAt(t.offset).line,e.positionAt(t.offset+t.length).line,this.getKind(t.kind))):void 0})}getKind(e){switch(e){case"FILE_HEADER":case"DOCUMENTATION_COMMENT":return i.FoldingRangeKind.Comment;case"DIRECTIVES":return i.FoldingRangeKind.Imports}}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(22),n=s(0),o=s(3),a=s(8);t.DartFormattingEditProvider=class{constructor(e,t,s){this.logger=e,this.analyzer=t,this.context=s,this.registeredFormatters=[],this.formatterRegisterFuncs=[],n.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("dart.enableSdkFormatter")&&(a.config.enableSdkFormatter?this.registerAllFormatters():this.unregisterAllFormatters())})}registerDocumentFormatter(e){this.registerFormatter(()=>n.languages.registerDocumentFormattingEditProvider(e,this))}registerTypingFormatter(e,t,...s){this.registerFormatter(()=>n.languages.registerOnTypeFormattingEditProvider(e,this,t,...s))}registerFormatter(e){const t=()=>this.registeredFormatters.push(e());a.config.enableSdkFormatter&&t(),this.formatterRegisterFuncs.push(t)}registerAllFormatters(){for(const e of this.formatterRegisterFuncs)e()}unregisterAllFormatters(){this.registeredFormatters.forEach(e=>e.dispose()),this.registeredFormatters.length=0}provideDocumentFormattingEdits(e,t,s){return r(this,void 0,void 0,function*(){try{return yield this.doFormat(e,!0)}catch(e){return void(this.context.hasWarnedAboutFormatterSyntaxLimitation||(this.context.hasWarnedAboutFormatterSyntaxLimitation=!0,n.window.showInformationMessage("The Dart formatter will not run if the file has syntax errors")))}})}provideOnTypeFormattingEdits(e,t,s,i,n){return r(this,void 0,void 0,function*(){try{return yield this.doFormat(e,!1)}catch(e){return}})}doFormat(e,t=!0){return r(this,void 0,void 0,function*(){if(this.shouldFormat(e))try{const s=yield this.analyzer.editFormat({file:o.fsPath(e.uri),lineLength:a.config.for(e.uri).lineLength,selectionLength:0,selectionOffset:0});return 0===s.edits.length?void 0:s.edits.map(t=>this.convertData(e,t))}catch(e){throw t&&this.logger.error(e),e}})}shouldFormat(e){if(!e||!e.uri||"file"!==e.uri.scheme)return;const t=a.config.for(e.uri),s=o.fsPath(e.uri);return void 0===t.doNotFormat.find(e=>i(s,e,{dot:!0}))}convertData(e,t){return new n.TextEdit(new n.Range(e.positionAt(t.offset),e.positionAt(t.offset+t.length)),t.replacement)}dispose(){this.unregisterAllFormatters()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(13);t.DartDocumentHighlightProvider=class{constructor(e){this.analyzer=e}provideDocumentHighlights(e,t,s){const n=e.offsetAt(t),o=i.openFileTracker.getOccurrencesFor(e.uri);if(o)for(const t of o)if(t.offsets.find(e=>e<=n&&e+t.length>=n))return t.offsets.map(s=>new r.DocumentHighlight(new r.Range(e.positionAt(s),e.positionAt(s+t.length))))}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(4),o=s(3),a=s(2),c=s(71);t.DartImplementationProvider=class{constructor(e){this.analyzer=e}provideImplementation(e,t,s){return r(this,void 0,void 0,function*(){const r=c.findNearestOutlineNode(e,t,!0),u=r?r.element.location.offset:e.offsetAt(t),l=yield this.analyzer.searchGetTypeHierarchy({file:o.fsPath(e.uri),offset:u});if(s.isCancellationRequested||!l||!l.hierarchyItems||!l.hierarchyItems.length||1===l.hierarchyItems.length)return;const h=l.hierarchyItems.find(e=>{const t=e.memberElement||e.classElement;return t.location.offset<=u&&t.location.offset+t.location.length>=u})||l.hierarchyItems[0],d=!h.memberElement,p=function e(t){return[...t.subclasses.map(e=>l.hierarchyItems[e]),...n.flatMap(t.subclasses,t=>e(l.hierarchyItems[t]))]}(h).map(e=>d?e.classElement:e.memberElement).filter(e=>e),g=[];for(const e of p){const t=a.toRange(yield i.workspace.openTextDocument(e.location.file),e.location.offset,e.location.length);g.push(new i.Location(i.Uri.file(e.location.file),t))}return g})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.DartLanguageConfiguration=class{constructor(){this.onEnterRules=[{action:{indentAction:r.IndentAction.None,appendText:"/// "},beforeText:/^\s*\/\/\/ /},{action:{indentAction:r.IndentAction.None,appendText:"///"},beforeText:/^\s*\/\/\//},{action:{indentAction:r.IndentAction.IndentOutdent,appendText:" * "},afterText:/^\s*\*\/$/,beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/},{action:{indentAction:r.IndentAction.None,appendText:" * "},beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/},{action:{indentAction:r.IndentAction.None,appendText:"* "},beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/},{action:{indentAction:r.IndentAction.None,removeText:1},beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/}]}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(4),o=s(3),a=s(2);t.DartReferenceProvider=class{constructor(e){this.analyzer=e}provideReferences(e,t,s,n){return r(this,void 0,void 0,function*(){const r=s.includeDeclaration?yield this.provideDefinition(e,t,n):void 0,c=yield this.analyzer.searchFindElementReferencesResults({file:o.fsPath(e.uri),includePotential:!0,offset:e.offsetAt(t)});if(n&&n.isCancellationRequested)return;const u=c.results.map(e=>new i.Location(i.Uri.file(e.location.file),a.toRangeOnLine(e.location)));return r?u.concat(r.map(e=>new i.Location(e.targetUri,e.targetRange))):u})}provideDefinition(e,t,s){return r(this,void 0,void 0,function*(){const r=yield this.analyzer.analysisGetNavigation({file:o.fsPath(e.uri),length:0,offset:e.offsetAt(t)});if(!s||!s.isCancellationRequested)return n.flatMap(r.regions,t=>t.targets.map(s=>{const n=r.targets[s];return 0===n.startColumn&&(n.startColumn=1),{originSelectionRange:a.toRange(e,t.offset,t.length),targetRange:a.toRangeOnLine(n),targetUri:i.Uri.file(r.files[n.fileIndex])}}))})}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(30),a=s(2);t.DartRenameProvider=class{constructor(e){this.analyzer=e}provideRenameEdits(e,t,s,r){return this.doRename(e,t,s,r)}prepareRename(e,t,s){return this.getLocation(e,t,s)}doRename(e,t,s,a){return r(this,void 0,void 0,function*(){const r=o.getChannel("Refactorings");r.appendLine("");const c=yield this.analyzer.editGetRefactoring({file:n.fsPath(e.uri),kind:"RENAME",length:1,offset:e.offsetAt(t),options:{newName:s},validateOnly:!1});if(a&&a.isCancellationRequested)return void r.appendLine("[INFO] Rename cancelled.");const u=new i.WorkspaceEdit;c.change&&c.change.message&&r.appendLine(`[INFO] ${c.change.message}…`),this.handleProblem(c.initialProblems.concat(c.optionsProblems).concat(c.finalProblems),r);const l=[];if(c.change.edits.forEach(e=>{e.edits.forEach(t=>{const s=i.Uri.file(e.file),r=i.workspace.openTextDocument(s);l.push(r.then(e=>u.replace(s,new i.Range(e.positionAt(t.offset),e.positionAt(t.offset+t.length)),t.replacement)))})}),yield Promise.all(l),!a||!a.isCancellationRequested)return r.appendLine("[INFO] Rename successful."),u;r.appendLine("[INFO] Rename cancelled.")})}handleProblem(e,t){e.forEach(e=>t.appendLine(`[${e.severity}] ${e.message}`));const s=e.filter(e=>"INFO"!==e.severity&&"WARNING"!==e.severity).sort((e,t)=>t.severity.localeCompare(e.severity));if(0!==s.length)throw t.appendLine("[INFO] Rename aborted."),s[0].message}getLocation(e,t,s){return r(this,void 0,void 0,function*(){const r=yield this.analyzer.editGetRefactoring({file:n.fsPath(e.uri),kind:"RENAME",length:0,offset:e.offsetAt(t),validateOnly:!0});if(s&&s.isCancellationRequested)return;if(!r.feedback)throw new Error("You cannot rename this element.");const o=r.feedback,c=-1===o.offset?new i.Range(t,t):a.toRange(e,o.offset,o.length);if(o)return{placeholder:o.oldName,range:c};{const e=r.initialProblems.concat(r.optionsProblems).concat(r.finalProblems).filter(e=>"FATAL"===e.severity);throw e&&e.length?new Error(e[0].message):new Error("This rename is not supported.")}})}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(31),o=s(3);t.DartSignatureHelpProvider=class{constructor(e){this.analyzer=e}provideSignatureHelp(e,t,s){return r(this,void 0,void 0,function*(){try{const r=yield this.analyzer.analysisGetSignature({file:o.fsPath(e.uri),offset:e.offsetAt(t)});if(s&&s.isCancellationRequested)return;const a=new i.SignatureInformation(this.getSignatureLabel(r),new i.MarkdownString(n.cleanDartdoc(r.dartdoc)));a.parameters=r.parameters.map(e=>new i.ParameterInformation(this.getLabel(e)));const c=new i.SignatureHelp;return c.signatures=[a],c.activeSignature=0,c.activeParameter=-1,c}catch(e){return}})}getSignatureLabel(e){const t=e.parameters.filter(e=>"REQUIRED"===e.kind),s=e.parameters.filter(e=>"OPTIONAL"===e.kind),r=e.parameters.filter(e=>"NAMED"===e.kind),i=[];return t.length&&i.push(t.map(this.getLabel).join(", ")),s.length&&i.push("["+s.map(this.getLabel).join(", ")+"]"),r.length&&i.push("{"+r.map(this.getLabel).join(", ")+"}"),`${e.name}(${i.join(", ")})`}getLabel(e){const t=e.defaultValue?` = ${e.defaultValue}`:"";return`${e.type} ${e.name}${t}`}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(4),a=s(3),c=s(23),u=s(2);t.DartWorkspaceSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.badChars=new RegExp("[^0-9a-z-]","gi")}provideWorkspaceSymbols(e,t){return r(this,void 0,void 0,function*(){if(0===e.length)return;const s=".*"+e.replace(this.badChars,"").split("").map(e=>`[${e.toUpperCase()}${e.toLowerCase()}]`).join(".*")+".*",r=yield this.analyzer.searchGetElementDeclarations({pattern:s,maxResults:500});return t&&t.isCancellationRequested?void 0:r.declarations.map(e=>this.convertWorkspaceResult(e,r.files[e.fileIndex]))})}resolveWorkspaceSymbol(e,t){return r(this,void 0,void 0,function*(){if(!(e instanceof l))return;const t=yield n.workspace.openTextDocument(n.Uri.file(e.locationData.file));return e.location=new n.Location(t.uri,u.toRange(t,e.locationData.offset,e.locationData.length)),e})}convertWorkspaceResult(e,t){const s=this.getNames(e,!0,t),r=new l(s.name,c.getSymbolKindForElementKind(this.logger,e.kind),s.containerName,new n.Location(n.Uri.file(t),void 0));return r.locationData={file:t,length:e.codeLength,offset:e.codeOffset},r}getNames(e,t,s){let r,i=e.name,n=!1;return"CONSTRUCTOR"===e.kind&&e.className&&(i?(n=!0,i=`${e.className}.${i}`):i=e.className),e.parameters&&"SETTER"!==e.kind&&(i+=e.parameters),t?(r=this.createDisplayPath(s),e.className&&!n&&(i=`${e.className}.${i}`)):r=e.className,{name:i,containerName:r}}createDisplayPath(e){const t=n.workspace.getWorkspaceFolder(n.Uri.file(e));if(t)e=t&&i.relative(a.fsPath(t.uri),e);else{const t=o.escapeRegExp(i.sep),s=`[^${t}]+`,r=new RegExp(`.*${t}(?:hosted${t}${s}|git)${t}(${s})${t}(.*)`).exec(e);if(!r||3!==r.length)return;{const t=r[1].split("-")[0],s=`lib${i.sep}`,n=r[2].indexOf(s);e=`package:${t}/${(-1!==n?r[2].substr(n+s.length):r[2]).replace(/\\/g,"/")}`}}return e}};class l extends n.SymbolInformation{}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(2),a=s(47);t.FixCodeActionProvider=class{constructor(e,t,s){this.logger=e,this.selector=t,this.analyzer=s,this.rank=1,this.metadata={providedCodeActionKinds:[i.CodeActionKind.QuickFix]}}provideCodeActions(e,t,s,a){return r(this,void 0,void 0,function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!s||!s.only||s.only.contains(i.CodeActionKind.QuickFix)))try{const s=yield this.analyzer.editGetFixes({file:n.fsPath(e.uri),offset:e.offsetAt(t.start)});if(a&&a.isCancellationRequested)return;const r={};for(const t of s.fixes)for(const s of t.fixes)r[JSON.stringify(s.edits)]=this.convertResult(e,s,t.error);return Object.keys(r).map(e=>r[e])}catch(e){throw this.logger.error(e),e}})}convertResult(e,t,s){const r=t.message,n=s?[a.DartDiagnosticProvider.createDiagnostic(s)]:void 0,o=new i.CodeAction(r,i.CodeActionKind.QuickFix);return o.command={arguments:[e,t],command:"_dart.applySourceChange",title:r},o.diagnostics=n,o}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(8),n=s(2),o=s(47);t.IgnoreLintCodeActionProvider=class{constructor(e){this.selector=e,this.rank=100,this.metadata={providedCodeActionKinds:[r.CodeActionKind.QuickFix]}}provideCodeActions(e,t,s,a){if(!n.isAnalyzableAndInWorkspace(e))return;if(s&&s.only&&!s.only.contains(r.CodeActionKind.QuickFix))return;if(!(i.config.showIgnoreQuickFixes&&s&&s.diagnostics&&s.diagnostics.length))return;const c=s.diagnostics.filter(e=>e instanceof o.DartDiagnostic&&("LINT"===e.type||"HINT"===e.type)||"dart"===e.source&&e.severity===r.DiagnosticSeverity.Information);return c.length?c.map(t=>this.convertResult(e,t)):void 0}convertResult(e,t){const s=new r.WorkspaceEdit,i=e.lineAt(t.range.start.line);s.insert(e.uri,i.range.start,`${" ".repeat(i.firstNonWhitespaceCharacterIndex)}// ignore: ${t.code}\n`);const n=`Ignore ${t instanceof o.DartDiagnostic?`${t.type.toLowerCase()} `:""}'${t.code}' for this line`,a=new r.CodeAction(n,r.CodeActionKind.QuickFix);return a.edit=s,a}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(3),a=s(23),c=s(2);t.LegacyDartWorkspaceSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t}provideWorkspaceSymbols(e,t){return r(this,void 0,void 0,function*(){if(0===e.length)return;e=this.sanitizeUserQuery(e);const t=this.makeCaseInsensitiveFuzzyRegex(e),s=yield Promise.all([this.analyzer.searchFindTopLevelDeclarationsResults({pattern:t}),this.analyzer.searchFindMemberDeclarationsResults({name:t})]);return this.combineResults(s)})}combineResults(e){return e[0].results.concat(e[1].results).filter(e=>this.shouldIncludeResult(e)).map(e=>this.convertResult(e))}searchTopLevelSymbols(e){return r(this,void 0,void 0,function*(){const t=this.makeCaseInsensitiveFuzzyRegex(e);return(yield this.analyzer.searchFindTopLevelDeclarationsResults({pattern:t})).results})}searchMemberDeclarations(e){return r(this,void 0,void 0,function*(){const t=this.makeCaseInsensitiveFuzzyRegex(e);return(yield this.analyzer.searchFindMemberDeclarationsResults({name:t})).results})}sanitizeUserQuery(e){let t=Array.from(e);return(t=t.filter(e=>-1==="[](){}\\|./<>?+".indexOf(e))).join("")}makeCaseInsensitiveFuzzyRegex(e){let t=Array.from(e);return`.*${(t=t.map(e=>e.toUpperCase()===e.toLowerCase()?e:`[${e.toUpperCase()}${e.toLowerCase()}]`)).join(".*")}.*`}shouldIncludeResult(e){const t=e.path[0].name.startsWith("_")||e.path[1].name.startsWith("_");return c.isWithinWorkspace(e.location.file)||!t}convertResult(e){const t=this.createDisplayPath(e.location.file);let s=e.path.slice(0,e.path.length-2).reverse().map(e=>e.name).join(".");"SETTER"===e.path[0].kind&&(s+=" set"),"GETTER"===e.path[0].kind&&(s+=" get");const r=e.path[0].parameters&&"SETTER"!==e.path[0].kind?e.path[0].parameters:"";return new n.SymbolInformation(s+r,a.getSymbolKindForElementKind(this.logger,e.path[0].kind),t,new n.Location(n.Uri.file(e.location.file),c.toRangeOnLine(e.location)))}createDisplayPath(e){const t="hosted"+i.sep+"pub.dartlang.org",s=e.indexOf(t);if(s>-1){const r=e.substring(s+t.length+1).split(i.sep);r[0]=r[0].split("-")[0],"lib"===r[1]&&r.splice(1,1),e=`package:${r[0]}/${r.slice(1).join("/")}`}else{const t=n.workspace.getWorkspaceFolder(n.Uri.file(e));e=t&&i.relative(o.fsPath(t.uri),e)}return e}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(4),o=s(17);t.RankingCodeActionProvider=class{constructor(){this.codeActionProviders=[]}registerProvider(e){this.codeActionProviders.push(e),o.sortBy(this.codeActionProviders,e=>e.rank)}get metadata(){const e=n.flatMap(this.codeActionProviders,e=>e.metadata.providedCodeActionKinds);return{providedCodeActionKinds:n.uniq(e)}}provideCodeActions(e,t,s,o){return r(this,void 0,void 0,function*(){const r=this.codeActionProviders.filter(t=>i.languages.match(t.selector,e)).map(r=>r.provideCodeActions(e,t,s,o)),a=yield Promise.all(r);return n.flatMap(a,e=>e)})}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(3),o=s(2),a={CONVERT_METHOD_TO_GETTER:"Convert Method to Getter",EXTRACT_LOCAL_VARIABLE:"Extract Local Variable",EXTRACT_METHOD:"Extract Method",EXTRACT_WIDGET:"Extract Widget"};t.RefactorCodeActionProvider=class{constructor(e,t){this.selector=e,this.analyzer=t,this.rank=50,this.metadata={providedCodeActionKinds:[i.CodeActionKind.Refactor]}}provideCodeActions(e,t,s,a){return r(this,void 0,void 0,function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!s||!s.only||s.only.contains(i.CodeActionKind.Refactor)))try{const s=yield this.analyzer.editGetAvailableRefactorings({file:n.fsPath(e.uri),length:e.offsetAt(t.end)-e.offsetAt(t.start),offset:e.offsetAt(t.start)});if(a&&a.isCancellationRequested)return;return s.kinds.map(s=>this.getRefactorForKind(e,t,s)).filter(e=>e)}catch(e){return[]}})}getRefactorForKind(e,t,s){if(!a[s])return;const r=a[s],n=new i.CodeAction(r,i.CodeActionKind.Refactor);return n.command={arguments:[e,t,s],command:"_dart.performRefactor",title:r},n}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(15),n=s(0),o=s(2);t.SnippetCompletionItemProvider=class{constructor(e,t){this.completions=new n.CompletionList,this.shouldRender=t;const s=o.readJson(r.join(o.extensionPath,e));for(const e of Object.keys(s))for(const t of Object.keys(s[e])){const r=s[e][t],o=new n.CompletionItem(t,n.CompletionItemKind.Snippet);o.filterText=r.prefix,o.insertText=new n.SnippetString(i.isArray(r.body)?r.body.join("\n"):r.body),o.detail=r.description,o.documentation=(new n.MarkdownString).appendCodeblock(o.insertText.value),o.sortText="zzzzzzzzzzzzzzzzzzzzzz",this.completions.items.push(o)}}provideCompletionItems(e,t,s,r){const i=e.lineAt(t.line).text.slice(0,t.character);if(this.shouldAllowCompletion(i,r)&&this.shouldRender(e.uri))return this.completions}shouldAllowCompletion(e,t){return-1===(e=e.trim()).indexOf("//")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(2),n=r.CodeActionKind.Source.append("sortMembers");t.SourceCodeActionProvider=class{constructor(){this.metadata={providedCodeActionKinds:[r.CodeActionKind.Source,r.CodeActionKind.SourceOrganizeImports,n]}}provideCodeActions(e,t,s,o){if(!i.isAnalyzableAndInWorkspace(e))return;const a=[];return s&&s.only&&!s.only.contains(r.CodeActionKind.Source)&&!s.only.contains(r.CodeActionKind.SourceOrganizeImports)||a.push({command:{arguments:[e],command:"_dart.organizeImports",title:"Organize Imports"},kind:r.CodeActionKind.SourceOrganizeImports,title:"Organize Imports"}),s&&s.only&&!s.only.contains(r.CodeActionKind.Source)&&!s.only.contains(n)||a.push({command:{arguments:[e],command:"dart.sortMembers",title:"Sort Members"},kind:n,title:"Sort Members"}),a}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(5),o=s(3),a=s(8),c=s(34),u=s(2),l=s(10);t.PubBuildRunnerTaskProvider=class{constructor(e){this.sdks=e}provideTasks(e){const t=u.getDartWorkspaceFolders(),s=[];return t.forEach(e=>{c.referencesBuildRunner(o.fsPath(e.uri))&&(s.push(this.createBuildRunnerCommandBackgroundTask(e,"watch",i.TaskGroup.Build)),s.push(this.createBuildRunnerCommandBackgroundTask(e,"build",i.TaskGroup.Build)),s.push(this.createBuildRunnerCommandBackgroundTask(e,"serve",i.TaskGroup.Build)),s.push(this.createBuildRunnerCommandBackgroundTask(e,"test",i.TaskGroup.Test)))}),s}createBuildRunnerCommandBackgroundTask(e,t,s){const c=u.isFlutterWorkspaceFolder(e)&&this.sdks.flutter,h=c?"flutter":"pub",d=c?r.join(this.sdks.flutter,n.flutterPath):r.join(this.sdks.dart,n.pubPath),p=c?["packages","pub","run","build_runner",t]:["run","build_runner",t];a.config.buildRunnerAdditionalArgs&&p.push(...a.config.buildRunnerAdditionalArgs);const g=new i.Task({command:t,type:h},e,`build_runner ${t}`,h,new i.ProcessExecution(d,p,{cwd:o.fsPath(e.uri),env:l.toolEnv}),"$dart-pub-build_runner");return g.group=s,g.isBackground=!0,g.name=`build_runner ${t}`,g}resolveTask(e,t){}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(0),o=s(5),a=s(7),c=s(162),u=s(4),l=s(3),h=s(10);t.PubGlobal=class{constructor(e,t,s){this.logger=e,this.context=t,this.sdks=s}promptToInstallIfRequired(e,t,s=o.pubGlobalDocsUrl,i,c=!1){return r(this,void 0,void 0,function*(){const r=yield this.getInstalledStatus(e,t,i);if(r===a.VersionStatus.Valid)return!0;const o=r===a.VersionStatus.NotInstalled?`Activate ${e}`:`Update ${e}`,u=r===a.VersionStatus.NotInstalled?`${e} needs to be installed with 'pub global activate ${t}' to use this feature.`:r===a.VersionStatus.UpdateRequired?`${e} needs to be updated with 'pub global activate ${t}' to use this feature.`:`A new version of ${e} is available and can be installed with 'pub global activate ${t}'.`;let h=r!==a.VersionStatus.UpdateRequired&&r!==a.VersionStatus.UpdateAvailable||!c?yield n.window.showWarningMessage(u,o,"More Info"):o;if("More Info"===h)return l.openInBrowser(s),!1;if(h===o){const i=r===a.VersionStatus.NotInstalled?`Activating ${e}`:`Updating ${e}`,o=["global","activate",t];return yield this.runCommandWithProgress(e,`${i}...`,o),(yield this.getInstalledStatus(e,t))===a.VersionStatus.Valid||("More Info"===(h=yield n.window.showErrorMessage(`${i} failed. Please try running 'pub global activate ${t}' manually.`,"More Info"))&&l.openInBrowser(s),!1)}return!1})}uninstall(e){return r(this,void 0,void 0,function*(){const t=["global","deactivate",e];yield this.runCommand(e,t)})}getInstalledStatus(e,t,s){return r(this,void 0,void 0,function*(){const r=yield this.runCommand(e,["global","list"]),i=new RegExp(`^${t} (\\d+\\.\\d+\\.\\d+)(?: at| from|$|\\-|\\+)`,"m").exec(r);if(!i)return a.VersionStatus.NotInstalled;if(s&&!u.versionIsAtLeast(i[1],s))return a.VersionStatus.UpdateRequired;const n=this.context.getPackageLastCheckedForUpdates(t);if(!n||n<=Date.now()-o.noRepeatPromptThreshold){this.context.setPackageLastCheckedForUpdates(t,Date.now());try{const e=JSON.parse(yield c.fetch(`https://pub.dartlang.org/api/packages/${t}`));if(!u.versionIsAtLeast(i[1],e.latest.version))return a.VersionStatus.UpdateAvailable}catch(e){return this.logger.warn(`Failed to check for new version of ${t}: ${e}`,a.LogCategory.CommandProcesses),a.VersionStatus.Valid}}return a.VersionStatus.Valid})}runCommandWithProgress(e,t,s){return n.window.withProgress({location:n.ProgressLocation.Notification,title:t},t=>this.runCommand(e,s))}runCommand(e,t){return new Promise((s,r)=>{const n=i.join(this.sdks.dart,o.pubPath),a=h.safeSpawn(void 0,n,t),c=[],u=[];a.stdout.on("data",e=>c.push(e.toString())),a.stderr.on("data",e=>u.push(e.toString())),a.on("close",t=>{t?r(`${e} exited with code ${t}.\n\n${c.join("")}\n\n${u.join("")}`):s(c.join(""))})})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(42),i=s(18),n=s(41);t.fetch=function(e){const t=n.parse(e);if("https:"===t.protocol)return s=t.hostname,o=t.port,a=t.path,new Promise((e,t)=>{const r={hostname:s,method:"GET",path:a,port:o},n=i.request(r,s=>{if(!s||!s.statusCode||s.statusCode<200||s.statusCode>300)t({message:`Failed to get ${a}: ${s&&s.statusCode}: ${s&&s.statusMessage}`});else{const t=[];s.on("data",e=>t.push(e.toString())),s.on("end",()=>{const s=t.join("");e(s)})}});n.end()});if("http:"===t.protocol)return function(e,t,s){return new Promise((i,n)=>{const o={hostname:e,method:"GET",path:s,port:t},a=r.request(o,e=>{if(!e||!e.statusCode||e.statusCode<200||e.statusCode>300)n({message:`Failed to get ${s}: ${e&&e.statusCode}: ${e&&e.statusMessage}`});else{const t=[];e.on("data",e=>t.push(e.toString())),e.on("end",()=>{const e=t.join("");i(e)})}});a.end()})}(t.hostname,t.port,t.path);throw new Error(`Cannot fetch URL ${e}`);var s,o,a}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);class i{static get empty(){return new i("0.0.0")}constructor(e){this.version=e}get supportsDevTools(){return r.versionIsAtLeast(this.version,"2.1.0")}get includesSourceForSdkLibs(){return r.versionIsAtLeast(this.version,"2.2.1")}get handlesBreakpointsInPartFiles(){return r.versionIsAtLeast(this.version,"2.2.1-edge")}get supportsDisableServiceTokens(){return r.versionIsAtLeast(this.version,"2.2.1-dev.4.2")}}t.DartCapabilities=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(8),n=s(2);t.StatusBarVersionTracker=class{constructor(e){this.subscriptions=[];const t=e.sdks.dartSdkIsFromFlutter,s=e.hasAnyFlutterProjects?i.config.flutterSdkPaths&&i.config.flutterSdkPaths.length>0?"dart.changeFlutterSdk":void 0:i.config.sdkPaths&&i.config.sdkPaths.length>0?"dart.changeSdk":void 0,r=e.hasAnyFlutterProjects?"Flutter":t?"Dart from Flutter":"Dart",n=e.hasAnyFlutterProjects||t?e.sdks.flutterVersion:e.sdks.dartVersion;n&&this.addStatusBarItem(`${r}: `+(n.length>20?n.substr(0,17)+"…":n),`${r} SDK: ${n}`,s)}addStatusBarItem(e,t,s){const i=r.window.createStatusBarItem(r.StatusBarAlignment.Right,2);i.text=e,i.tooltip=t,i.command=s,this.subscriptions.push(i),this.subscriptions.push(r.window.onDidChangeActiveTextEditor(e=>{e&&e.document&&n.isAnalyzable(e.document)?i.show():i.hide()})),r.window.activeTextEditor&&r.window.activeTextEditor.document&&n.isAnalyzable(r.window.activeTextEditor.document)&&i.show()}dispose(){this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(5),o=s(4),a=s(3),c=s(8),u=s(2);t.checkForStandardDartSdkUpdates=function(e,t){return r(this,void 0,void 0,function*(){if(!c.config.checkForSdkUpdates||!t.hasOnlyDartProjects)return;if(t.sdks.dartSdkIsFromFlutter)return;const s=t.sdks.dartVersion;try{const t=yield u.getLatestSdkVersion();if(!s||o.versionIsAtLeast(s,t))return;const r="Go to Dart Downloads",l="Disable Update Checks",h=`Version ${t} of the Dart SDK is available (you have ${s}). Some features of Dart Code may not work correctly with an old SDK.`,d=yield i.window.showWarningMessage(h,r,l);d===r?a.openInBrowser(n.DART_DOWNLOAD_URL):d===l&&c.config.setCheckForSdkUpdates(!1)}catch(t){e.error(t)}})}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const i=s(6),n=s(1),o=s(0),a=s(5),c=s(7),u=s(58),l=s(3),h=s(72),d=s(2);function p(){return r(this,void 0,void 0,function*(){return"Install Flutter Extension"===(yield o.window.showInformationMessage("The Flutter extension is required to work with Flutter projects.","Install Flutter Extension"))&&(yield o.window.withProgress({location:o.ProgressLocation.Notification},e=>(e.report({message:"Installing Flutter extension"}),new Promise(e=>{o.extensions.onDidChange(t=>e()),o.commands.executeCommand("workbench.extensions.installExtension",a.flutterExtensionIdentifier)}))),d.reloadExtension()),!1})}function g(e){o.window.showErrorMessage(e.message)}function f(e,t,s){return r(this,void 0,void 0,function*(){const a=n.join(l.fsPath(t.uri),s);if(i.existsSync(a)){const s=i.readFileSync(a).toString().trim();let u;try{u=JSON.parse(s)}catch(e){return void o.window.showErrorMessage("Failed to run Stagehand to create project")}i.unlinkSync(a),e.info(`Creating Dart project for ${l.fsPath(t.uri)}`,c.LogCategory.CommandProcesses);try{h.markProjectCreationStarted(),(yield function(e,t){return r(this,void 0,void 0,function*(){const s=yield o.commands.executeCommand("_dart.create",e,t);return 0===s})}(l.fsPath(t.uri),u.name))?(e.info("Fetching packages for newly-created project",c.LogCategory.CommandProcesses),yield o.commands.executeCommand("dart.getPackages",t.uri),function(e,t){const s=l.fsPath(e.uri),r=n.basename(s);m(n.join(s,t.entrypoint.replace("__projectName__",r))),o.window.showInformationMessage(`${t.label} project ready!`)}(t,u),e.info("Finished creating new project!",c.LogCategory.CommandProcesses)):e.info("Failed to create new project",c.LogCategory.CommandProcesses)}finally{h.markProjectCreationEnded()}}})}function m(e){i.existsSync(e)&&setTimeout(()=>{o.commands.executeCommand("vscode.open",o.Uri.file(e))},100)}t.showUserPrompts=function(e,t,s){return r(this,void 0,void 0,function*(){if(function(e,t){r(this,void 0,void 0,function*(){process.env.DART_CODE_IS_TEST_RUN&&(yield new Promise(e=>setTimeout(e,5e3))),d.getDartWorkspaceFolders().forEach(t=>{f(e,t,a.DART_STAGEHAND_PROJECT_TRIGGER_FILE),f(e,t,a.FLUTTER_STAGEHAND_PROJECT_TRIGGER_FILE),function(e){r(this,void 0,void 0,function*(){const t=n.join(l.fsPath(e.uri),a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE);if(i.existsSync(t)){let s=i.readFileSync(t).toString().trim();s=s||void 0,i.unlinkSync(t);try{h.markProjectCreationStarted();const t=yield function(e,t){return r(this,void 0,void 0,function*(){const s=t?"sample":void 0,r=yield o.commands.executeCommand("_flutter.create",e,s,t);return 0===r})}(l.fsPath(e.uri),s);t&&function(e,t){m(n.join(l.fsPath(e.uri),"lib/main.dart")),t?o.window.showInformationMessage(`${t} sample ready! Connect a device and press F5 to run.`):o.window.showInformationMessage("Your Flutter project is ready! Connect a device and press F5 to start running.")}(e,s)}finally{h.markProjectCreationEnded()}}})}(t)})})}(e),s.hasAnyFlutterProjects&&!d.hasFlutterExtension&&!function(e){const s=`${a.userPromptContextPrefix}${e}`;return!0===t.get(s)}(a.installFlutterExtensionPromptKey)&&(yield new Promise(e=>setTimeout(e,2e4)),!d.checkHasFlutterExtension()))return function(e,s){const r=`${a.userPromptContextPrefix}${e}`;s().then(e=>t.update(r,e),g)}(a.installFlutterExtensionPromptKey,p);const c=t.lastSeenVersion;if(c){if(!d.isDevExtension&&c!==d.extensionVersion){const e=d.extensionVersion.split(".").slice(0,2).join(".").replace(".","-");return void function(e,t){return r(this,void 0,void 0,function*(){const s=yield o.window.showInformationMessage(`Dart Code has been updated to v${e}`,"Show Release Notes");return s&&l.openInBrowser(`https://dartcode.org/releases/v${t}/`),!0})}(d.extensionVersion,e).then(()=>t.lastSeenVersion=d.extensionVersion)}}else t.lastSeenVersion=d.extensionVersion;!s.hasAnyFlutterProjects||u.showFlutter2019Q2SurveyNotificationIfAppropriate(t,Date.now(),e)})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(1),n=s(0),o=s(5),a=s(17),c=s(9),u=s(3),l=s(25),h=s(2);t.DartPackagesProvider=class{constructor(e){this.logger=e,this.onDidChangeTreeDataEmitter=new n.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.watcher=n.workspace.createFileSystemWatcher("**/.packages"),this.watcher.onDidChange(this.refresh,this),this.watcher.onDidCreate(this.refresh,this),this.watcher.onDidDelete(this.refresh,this)}refresh(){this.onDidChangeTreeDataEmitter.fire()}getTreeItem(e){return e}getChildren(e){if(e)return e instanceof f?this.getPackages(e):e instanceof m?this.getFilesAndFolders(e):e instanceof g?this.getFilesAndFolders(e):e instanceof p?[]:(this.logger.warn(`Don't know how to show children of ${e.label}/${e.resourceUri}`),[]);{const e=h.getDartWorkspaceFolders().map(e=>u.fsPath(e.uri)),t=c.findProjectFolders(e,{requirePubspec:!0}).map(e=>new f(n.Uri.file(e)));return 1===t.length?this.getChildren(t[0]):t}}getPackages(e){const t=new l.PackageMap(i.join(u.fsPath(e.resourceUri),".packages")),s=t.packages;return a.sortBy(Object.keys(s),e=>e.toLowerCase()).filter(e=>e!==t.localPackageName).map(e=>{const t=s[e];return new m(`${e}`,n.Uri.file(t))})}getFilesAndFolders(e){const t=a.sortBy(r.readdirSync(u.fsPath(e.resourceUri)),e=>e.toLowerCase()),s=[],o=[];return t.forEach(t=>{const a=i.join(u.fsPath(e.resourceUri),t),c=r.statSync(a);c.isFile()?o.push(new p(n.Uri.file(a))):c.isDirectory()&&s.push(new g(n.Uri.file(a)))}),[...s,...o]}dispose(){this.watcher.dispose()}};class d extends n.TreeItem{constructor(e,t,s){super(e,s),this.resourceUri=t}}t.PackageDep=d;class p extends d{constructor(e){super(void 0,e,n.TreeItemCollapsibleState.None),this.contextValue=o.DART_DEP_FILE_NODE_CONTEXT,this.command={arguments:[e],command:"dart.package.openFile",title:"Open File"}}}t.PackageDepFile=p;class g extends d{constructor(e){super(void 0,e,n.TreeItemCollapsibleState.Collapsed),this.contextValue=o.DART_DEP_FOLDER_NODE_CONTEXT}}t.PackageDepFolder=g;class f extends d{constructor(e){const t=u.fsPath(e);super(i.basename(t),e,n.TreeItemCollapsibleState.Collapsed),this.contextValue=o.DART_DEP_PROJECT_NODE_CONTEXT;const s=n.workspace.getWorkspaceFolder(e),r=u.fsPath(s.uri);this.description=i.relative(i.dirname(r),i.dirname(t))}}t.PackageDepProject=f;class m extends d{constructor(e,t){super(e,t,n.TreeItemCollapsibleState.Collapsed),this.contextValue=o.DART_DEP_PACKAGE_NODE_CONTEXT}}t.PackageDepPackage=m}]);
//# sourceMappingURL=extension.js.map